{"version":3,"file":"cmp.js","mappings":"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","sources":["webpack:///../../libraries/cmp/cmpClient.js","webpack:///../../libraries/cmp/cmpEventUtils.ts"],"sourcesContent":["import {PbPromise} from '../../src/utils/promise.js';\n\n/**\n * @typedef {function} CMPClient\n *\n * @param {{}} params CMP parameters. Currently this is a subset of {command, callback, parameter, version}.\n * @param {boolean} once if true, discard cross-frame event listeners once a reply message is received.\n * @returns {Promise<*>} a promise to the API's \"result\" - see the `mode` argument to `cmpClient` on how that's determined.\n * @property {boolean} isDirect true if the CMP is directly accessible (no postMessage required)\n * @property {() => void} close close the client; currently, this just stops listening for cross-frame messages.\n */\n\nexport const MODE_MIXED = 0;\nexport const MODE_RETURN = 1;\nexport const MODE_CALLBACK = 2;\n\n/**\n * Returns a client function that can interface with a CMP regardless of where it's located.\n *\n * @param {object} obj\n * @param obj.apiName name of the CMP api, e.g. \"__gpp\"\n * @param [obj.apiVersion] CMP API version\n * @param [obj.apiArgs] names of the arguments taken by the api function, in order.\n * @param [obj.callbackArgs] names of the cross-frame response payload properties that should be passed as callback arguments, in order\n * @param [obj.mode] controls the callbacks passed to the underlying API, and how the promises returned by the client are resolved.\n *\n * The client behaves differently when it's provided a `callback` argument vs when it's not - for short, let's name these\n * cases \"subscriptions\" and \"one-shot calls\" respectively:\n *\n * With `mode: MODE_MIXED` (the default), promises returned on subscriptions are resolved to undefined when the callback\n * is first run (that is, the promise resolves when the CMP replies, but what it replies with is discarded and\n * left for the callback to deal with). For one-shot calls, the returned promise is resolved to the API's\n * return value when it's directly accessible, or with the result from the first (and, presumably, the only)\n * cross-frame reply when it's not;\n *\n * With `mode: MODE_RETURN`, the returned promise always resolves to the API's return value - which is taken to be undefined\n * when cross-frame;\n *\n * With `mode: MODE_CALLBACK`, the underlying API is expected to never directly return anything significant; instead,\n * it should always accept a callback and - for one-shot calls - invoke it only once with the result. The client will\n * automatically generate an appropriate callback for one-shot calls and use the result it's given to resolve\n * the returned promise. Subscriptions are treated in the same way as MODE_MIXED.\n *\n * @param win\n * @returns {CMPClient} CMP invocation function (or null if no CMP was found).\n */\nexport function cmpClient(\n  {\n    apiName,\n    apiVersion,\n    apiArgs = ['command', 'callback', 'parameter', 'version'],\n    callbackArgs = ['returnValue', 'success'],\n    mode = MODE_MIXED,\n  },\n  win = window\n) {\n  const cmpCallbacks = {};\n  const callName = `${apiName}Call`;\n  const cmpDataPkgName = `${apiName}Return`;\n\n  function handleMessage(event) {\n    const json = (typeof event.data === 'string' && event.data.includes(cmpDataPkgName)) ? JSON.parse(event.data) : event.data;\n    if (json?.[cmpDataPkgName]?.callId) {\n      const payload = json[cmpDataPkgName];\n\n      if (cmpCallbacks.hasOwnProperty(payload.callId)) {\n        cmpCallbacks[payload.callId](...callbackArgs.map(name => payload[name]));\n      }\n    }\n  }\n\n  function findCMP() {\n    let f = win;\n    let cmpFrame;\n    let isDirect = false;\n    while (f != null) {\n      try {\n        if (typeof f[apiName] === 'function') {\n          cmpFrame = f;\n          isDirect = true;\n          break;\n        }\n      } catch (e) {\n      }\n\n      // need separate try/catch blocks due to the exception errors thrown when trying to check for a frame that doesn't exist in 3rd party env\n      try {\n        if (f.frames[`${apiName}Locator`]) {\n          cmpFrame = f;\n          break;\n        }\n      } catch (e) {\n      }\n\n      if (f === win.top) break;\n      f = f.parent;\n    }\n\n    return [\n      cmpFrame,\n      isDirect\n    ];\n  }\n\n  const [cmpFrame, isDirect] = findCMP();\n\n  if (!cmpFrame) {\n    return;\n  }\n\n  function resolveParams(params) {\n    params = Object.assign({version: apiVersion}, params);\n    return apiArgs.map(arg => [arg, params[arg]])\n  }\n\n  function wrapCallback(callback, resolve, reject, preamble) {\n    const haveCb = typeof callback === 'function';\n\n    return function (result, success) {\n      preamble && preamble();\n      if (mode !== MODE_RETURN) {\n        const resolver = success == null || success ? resolve : reject;\n        resolver(haveCb ? undefined : result);\n      }\n      haveCb && callback.apply(this, arguments);\n    }\n  }\n\n  let client;\n\n  if (isDirect) {\n    client = function invokeCMPDirect(params = {}) {\n      return new PbPromise((resolve, reject) => {\n        const ret = cmpFrame[apiName](...resolveParams({\n          ...params,\n          callback: (params.callback || mode === MODE_CALLBACK) ? wrapCallback(params.callback, resolve, reject) : undefined,\n        }).map(([_, val]) => val));\n        if (mode === MODE_RETURN || (params.callback == null && mode === MODE_MIXED)) {\n          resolve(ret);\n        }\n      });\n    };\n  } else {\n    win.addEventListener('message', handleMessage, false);\n\n    client = function invokeCMPFrame(params, once = false) {\n      return new PbPromise((resolve, reject) => {\n        // call CMP via postMessage\n        const callId = Math.random().toString();\n        const msg = {\n          [callName]: {\n            ...Object.fromEntries(resolveParams(params).filter(([param]) => param !== 'callback')),\n            callId: callId\n          }\n        };\n\n        cmpCallbacks[callId] = wrapCallback(params?.callback, resolve, reject, (once || params?.callback == null) && (() => { delete cmpCallbacks[callId] }));\n        cmpFrame.postMessage(msg, '*');\n        if (mode === MODE_RETURN) resolve();\n      });\n    };\n  }\n  return Object.assign(client, {\n    isDirect,\n    close() {\n      !isDirect && win.removeEventListener('message', handleMessage);\n    }\n  })\n}\n","/**\n * Shared utilities for CMP event listener management\n * Used by TCF and GPP consent management modules\n */\n\nimport { logError, logInfo } from \"../../src/utils.js\";\n\nexport interface CmpEventManager {\n  cmpApi: any;\n  listenerId: number | undefined;\n  setCmpApi(cmpApi: any): void;\n  getCmpApi(): any;\n  setCmpListenerId(listenerId: number | undefined): void;\n  getCmpListenerId(): number | undefined;\n  removeCmpEventListener(): void;\n  resetCmpApis(): void;\n}\n\n/**\n * Base CMP event manager implementation\n */\nexport abstract class BaseCmpEventManager implements CmpEventManager {\n  cmpApi: any = null;\n  listenerId: number | undefined = undefined;\n\n  setCmpApi(cmpApi: any): void {\n    this.cmpApi = cmpApi;\n  }\n\n  getCmpApi(): any {\n    return this.cmpApi;\n  }\n\n  setCmpListenerId(listenerId: number | undefined): void {\n    this.listenerId = listenerId;\n  }\n\n  getCmpListenerId(): number | undefined {\n    return this.listenerId;\n  }\n\n  resetCmpApis(): void {\n    this.cmpApi = null;\n    this.listenerId = undefined;\n  }\n\n  /**\n   * Helper method to get base removal parameters\n   * Can be used by subclasses that need to remove event listeners\n   */\n  protected getRemoveListenerParams(): Record<string, any> | null {\n    const cmpApi = this.getCmpApi();\n    const listenerId = this.getCmpListenerId();\n\n    // Comprehensive validation for all possible failure scenarios\n    if (cmpApi && typeof cmpApi === 'function' && listenerId !== undefined && listenerId !== null) {\n      return {\n        command: \"removeEventListener\",\n        callback: () => this.resetCmpApis(),\n        parameter: listenerId\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Abstract method - each subclass implements its own removal logic\n   */\n  abstract removeCmpEventListener(): void;\n}\n\n/**\n * TCF-specific CMP event manager\n */\nexport class TcfCmpEventManager extends BaseCmpEventManager {\n  private getConsentData: () => any;\n\n  constructor(getConsentData?: () => any) {\n    super();\n    this.getConsentData = getConsentData || (() => null);\n  }\n\n  removeCmpEventListener(): void {\n    const params = this.getRemoveListenerParams();\n    if (params) {\n      const consentData = this.getConsentData();\n      params.apiVersion = consentData?.apiVersion || 2;\n      logInfo('Removing TCF CMP event listener');\n      this.getCmpApi()(params);\n    }\n  }\n}\n\n/**\n * GPP-specific CMP event manager\n * GPP doesn't require event listener removal, so this is empty\n */\nexport class GppCmpEventManager extends BaseCmpEventManager {\n  removeCmpEventListener(): void {\n    const params = this.getRemoveListenerParams();\n    if (params) {\n      logInfo('Removing GPP CMP event listener');\n      this.getCmpApi()(params);\n    }\n  }\n}\n\n/**\n * Factory function to create appropriate CMP event manager\n */\nexport function createCmpEventManager(type: 'tcf' | 'gpp', getConsentData?: () => any): CmpEventManager {\n  switch (type) {\n    case 'tcf':\n      return new TcfCmpEventManager(getConsentData);\n    case 'gpp':\n      return new GppCmpEventManager();\n    default:\n      logError(`Unknown CMP type: ${type}`);\n      return null;\n  }\n}\n"],"names":["PbPromise","MODE_MIXED","MODE_RETURN","MODE_CALLBACK","cmpClient","_ref","apiName","apiVersion","apiArgs","callbackArgs","mode","win","arguments","length","undefined","window","cmpCallbacks","callName","concat","cmpDataPkgName","handleMessage","event","_json$cmpDataPkgName","json","data","includes","JSON","parse","callId","payload","hasOwnProperty","map","name","findCMP","f","cmpFrame","isDirect","e","frames","top","parent","resolveParams","params","Object","assign","version","arg","wrapCallback","callback","resolve","reject","preamble","haveCb","result","success","resolver","apply","client","invokeCMPDirect","ret","_objectSpread","_ref2","_","val","addEventListener","invokeCMPFrame","once","Math","random","toString","msg","fromEntries","filter","_ref3","param","postMessage","close","removeEventListener","logError","logInfo","BaseCmpEventManager","constructor","_defineProperty","setCmpApi","cmpApi","getCmpApi","setCmpListenerId","listenerId","getCmpListenerId","resetCmpApis","getRemoveListenerParams","command","parameter","TcfCmpEventManager","getConsentData","removeCmpEventListener","consentData","GppCmpEventManager","createCmpEventManager","type"],"sourceRoot":""}