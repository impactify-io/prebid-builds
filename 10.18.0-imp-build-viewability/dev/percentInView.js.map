{"version":3,"file":"percentInView.js","mappings":"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","sources":["webpack:///../../libraries/percentInView/percentInView.js"],"sourcesContent":["import { getWinDimensions, inIframe } from '../../src/utils.js';\nimport { getBoundingClientRect } from '../boundingClientRect/boundingClientRect.js';\n\nexport function getBoundingBox(element, {w, h} = {}) {\n  let {width, height, left, top, right, bottom, x, y} = getBoundingClientRect(element);\n\n  if ((width === 0 || height === 0) && w && h) {\n    width = w;\n    height = h;\n    right = left + w;\n    bottom = top + h;\n  }\n\n  return {width, height, left, top, right, bottom, x, y};\n}\n\nfunction getIntersectionOfRects(rects) {\n  const bbox = {\n    left: rects[0].left, right: rects[0].right, top: rects[0].top, bottom: rects[0].bottom\n  };\n\n  for (let i = 1; i < rects.length; ++i) {\n    bbox.left = Math.max(bbox.left, rects[i].left);\n    bbox.right = Math.min(bbox.right, rects[i].right);\n\n    if (bbox.left >= bbox.right) {\n      return null;\n    }\n\n    bbox.top = Math.max(bbox.top, rects[i].top);\n    bbox.bottom = Math.min(bbox.bottom, rects[i].bottom);\n\n    if (bbox.top >= bbox.bottom) {\n      return null;\n    }\n  }\n\n  bbox.width = bbox.right - bbox.left;\n  bbox.height = bbox.bottom - bbox.top;\n\n  return bbox;\n}\n\nexport const percentInView = (element, {w, h} = {}) => {\n  const elementBoundingBox = getBoundingBox(element, {w, h});\n\n  const { innerHeight, innerWidth } = getWinDimensions();\n\n  // Obtain the intersection of the element and the viewport\n  const elementInViewBoundingBox = getIntersectionOfRects([{\n    left: 0,\n    top: 0,\n    right: innerWidth,\n    bottom: innerHeight\n  }, elementBoundingBox]);\n\n  let elementInViewArea, elementTotalArea;\n\n  if (elementInViewBoundingBox !== null) {\n    // Some or all of the element is in view\n    elementInViewArea = elementInViewBoundingBox.width * elementInViewBoundingBox.height;\n    elementTotalArea = elementBoundingBox.width * elementBoundingBox.height;\n\n    return ((elementInViewArea / elementTotalArea) * 100);\n  }\n\n  // No overlap between element and the viewport; therefore, the element\n  // lies completely out of view\n  return 0;\n}\n\n/**\n * Checks if viewability can be measured for an element\n * @param {HTMLElement} element - DOM element to check\n * @returns {boolean} True if viewability is measurable\n */\nexport function isViewabilityMeasurable(element) {\n  return !inIframe() && element !== null;\n}\n\n/**\n * Gets the viewability percentage of an element\n * @param {HTMLElement} element - DOM element to measure\n * @param {Window} topWin - Top window object\n * @param {Object} size - Size object with width and height\n * @returns {number|string} Viewability percentage or 0 if not visible\n */\nexport function getViewability(element, topWin, size) {\n  return topWin.document.visibilityState === 'visible'\n    ? percentInView(element, size)\n    : 0;\n}\n"],"names":["getWinDimensions","inIframe","getBoundingClientRect","getBoundingBox","element","w","h","arguments","length","undefined","width","height","left","top","right","bottom","x","y","getIntersectionOfRects","rects","bbox","i","Math","max","min","percentInView","elementBoundingBox","innerHeight","innerWidth","elementInViewBoundingBox","elementInViewArea","elementTotalArea","isViewabilityMeasurable","getViewability","topWin","size","document","visibilityState"],"sourceRoot":""}