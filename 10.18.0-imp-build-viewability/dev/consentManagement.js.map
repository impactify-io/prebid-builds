{"version":3,"file":"consentManagement.js","mappings":";;;;;;;;;;;;;;;;;;;AAAgE;AAC8B;AAEzC;AACc;AACzB;AAEnC,SAASU,qBAAqBA,CAACC,IAAI,EAAEC,eAAe,EAAE;EAC3D,MAAMC,IAAI,GAAG,IAAIC,OAAO,CAAC,CAAC;EAC1B,OAAOd,2EAAgB,CAACW,IAAI,EAAE,SAASI,eAAeA,CAACC,EAAE,EAAEC,gBAAgB,EAAE;IAC3E,OAAOL,eAAe,CAAC,CAAC,CAACM,IAAI,CAACC,IAAA,IAA0B;MAAA,IAAzB;QAACC,WAAW;QAAEC;MAAK,CAAC,GAAAF,IAAA;MACjD,IAAIE,KAAK,KAAK,CAACD,WAAW,IAAI,CAACP,IAAI,CAACS,GAAG,CAACD,KAAK,CAAC,CAAC,EAAE;QAC/CR,IAAI,CAACU,GAAG,CAACF,KAAK,CAAC;QACff,sDAAO,CAACe,KAAK,CAACG,OAAO,EAAE,IAAIH,KAAK,CAACI,IAAI,IAAI,EAAE,CAAC,CAAC;MAC/C;MACAT,EAAE,CAACU,IAAI,CAAC,IAAI,EAAET,gBAAgB,CAAC;IACjC,CAAC,CAAC,CAACU,KAAK,CAAEN,KAAK,IAAK;MAClBjB,uDAAQ,IAAAwB,MAAA,CAAIP,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEG,OAAO,0DAAuD,IAAI,CAAAH,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEI,IAAI,KAAI,EAAE,CAAC,CAAC;MACxGT,EAAE,CAACa,UAAU,CAAC,CAAC;MACf,IAAI,OAAOZ,gBAAgB,CAACa,eAAe,KAAK,UAAU,EAAE;QAC1Db,gBAAgB,CAACa,eAAe,CAAC,CAAC;MACpC,CAAC,MAAM;QACL1B,uDAAQ,CAAC,iCAAiC,CAAC;MAC7C;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAAS2B,iBAAiBA,CAAAC,KAAA,EAS/B;EAAA,IARA;IACErB,IAAI;IACJsB,kBAAkB;IAClBC,QAAQ;IACRC,UAAU;IACVC,aAAa;IACbC;EACF,CAAC,GAAAL,KAAA;EAEDC,kBAAkB,CAACK,MAAM,CAAC,CAAC;EAC3B,IAAIC,aAAa;EAEjB,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtC,IAAIC,kBAAkB;IACtB,IAAIC,SAAS,GAAG,KAAK;IAErB,SAASC,qBAAqBA,CAACzB,WAAW,EAAE;MAC1CuB,kBAAkB,GAAGvB,WAAW;MAChC,IAAI,CAACwB,SAAS,EAAE;QACdA,SAAS,GAAG,IAAI;QAChBR,aAAa,IAAI,IAAI,IAAIU,YAAY,CAACV,aAAa,CAAC;MACtD;IACF;IAEA,SAASU,YAAYA,CAACC,OAAO,EAAE;MAC7B,IAAIR,aAAa,IAAI,IAAI,EAAES,YAAY,CAACT,aAAa,CAAC;MACtD,IAAIQ,OAAO,IAAI,IAAI,EAAE;QACnBR,aAAa,GAAGU,UAAU,CAAC,MAAM;UAAA,IAAAC,qBAAA;UAC/B,MAAM9B,WAAW,IAAA8B,qBAAA,GAAGjB,kBAAkB,CAACkB,cAAc,CAAC,CAAC,cAAAD,qBAAA,cAAAA,qBAAA,GAAKN,SAAS,GAAGD,kBAAkB,GAAGN,cAAc,CAAC,CAAE;UAC9G,MAAMb,OAAO,0BAAAI,MAAA,CAA0BgB,SAAS,GAAG,oBAAoB,GAAG,aAAa,CAAE;UACzFX,kBAAkB,CAACmB,cAAc,CAAChC,WAAW,CAAC;UAC9CqB,OAAO,CAAC;YAACrB,WAAW;YAAEC,KAAK,EAAE,IAAIgC,KAAK,IAAAzB,MAAA,CAAIjB,IAAI,OAAAiB,MAAA,CAAIJ,OAAO,CAAE;UAAC,CAAC,CAAC;QAChE,CAAC,EAAEuB,OAAO,CAAC;MACb,CAAC,MAAM;QACLR,aAAa,GAAG,IAAI;MACtB;IACF;IACAL,QAAQ,CAACW,qBAAqB,CAAC,CAC5B3B,IAAI,CAAC,MAAMuB,OAAO,CAAC;MAACrB,WAAW,EAAEa,kBAAkB,CAACkB,cAAc,CAAC;IAAC,CAAC,CAAC,EAAET,MAAM,CAAC;IAClFP,UAAU,IAAI,IAAI,IAAIW,YAAY,CAACX,UAAU,CAAC;EAChD,CAAC,CAAC,CAACmB,OAAO,CAAC,MAAM;IACff,aAAa,IAAIS,YAAY,CAACT,aAAa,CAAC;EAC9C,CAAC,CAAC,CAACZ,KAAK,CAAE4B,CAAC,IAAK;IACdtB,kBAAkB,CAACmB,cAAc,CAAC,IAAI,CAAC;IACvC,MAAMG,CAAC;EACT,CAAC,CAAC;AACJ;AAoCO,SAASC,YAAYA,CAAA,EAY1B;EAAA,IAXA;IACEC,SAAS;IACTC,WAAW;IACXzB,kBAAkB;IAClB0B,gBAAgB;IAChBtB,cAAc;IACduB,WAAW;IACXC,eAAe;IACfC,WAAW,GAAG,KAAK;IACnBC,uBAAuB,GAAG;EAC5B,CAAC,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,CAAC,CAAC;EAEN,SAASG,GAAGA,CAAC3C,OAAO,EAAE;IACpB,4BAAAI,MAAA,CAA4B6B,SAAS,OAAA7B,MAAA,CAAIJ,OAAO;EAClD;EACA,IAAIT,eAAe,EAAEqD,QAAQ,EAAEC,iBAAiB;EAEhD,SAASC,oBAAoBA,CAACC,IAAI,EAAEC,MAAM,EAAE;IAC1C,OAAOD,IAAI,CAACE,MAAM,CAACC,MAAM,CAAC;MAAC,IAAA9C,MAAA,CAAI6B,SAAS,eAAYxB,kBAAkB,CAACkB,cAAc,CAAC;IAAC,CAAC,EAAEqB,MAAM,CAAC,CAAC;EACpG;EAEA,SAAS5D,eAAeA,CAAA,EAAG;IACzB,OAAOwD,QAAQ,CAAC,CAAC,CAAClD,IAAI,CAACyD,KAAA;MAAA,IAAC;QAACtD;MAAK,CAAC,GAAAsD,KAAA;MAAA,OAAM;QAACtD,KAAK;QAAED,WAAW,EAAEa,kBAAkB,CAACkB,cAAc,CAAC;MAAC,CAAC;IAAA,CAAC,CAAC;EAClG;EAEA,SAASyB,QAAQA,CAAA,EAAG;IAClB,IAAI7D,eAAe,IAAI,IAAI,EAAE;MAC3BA,eAAe,GAAGL,qBAAqB,CAAC+C,SAAS,EAAE,MAAMW,QAAQ,CAAC,CAAC,CAAC;MACpE3D,qDAAO,CAAC,aAAa,CAAC,CAACoE,MAAM,CAAC9D,eAAe,EAAE,EAAE,CAAC;MAClDP,0EAAmB,CAACqE,MAAM,CAACP,oBAAoB,CAAC;MAChDjE,sDAAO,IAAAuB,MAAA,CAAI8B,WAAW,oDAAiD,CAAC;IAC1E;EACF;EAEA,SAASoB,KAAKA,CAAA,EAAG;IACf,IAAI/D,eAAe,IAAI,IAAI,EAAE;MAC3BN,qDAAO,CAAC,aAAa,CAAC,CAACsE,QAAQ,CAAC;QAACC,IAAI,EAAEjE;MAAe,CAAC,CAAC,CAACkE,MAAM,CAAC,CAAC;MACjEzE,0EAAmB,CAACuE,QAAQ,CAAC;QAACC,IAAI,EAAEV;MAAoB,CAAC,CAAC,CAACW,MAAM,CAAC,CAAC;MACnElE,eAAe,GAAG,IAAI;MACtBV,sDAAO,IAAAuB,MAAA,CAAI8B,WAAW,sDAAmD,CAAC;IAC5E;EACF;EAEA,SAASwB,uBAAuBA,CAAA,EAAG;IACjCJ,KAAK,CAAC,CAAC;IACP;IACA,IAAI,OAAOjB,eAAe,KAAK,UAAU,EAAE;MACzC,IAAI;QACFA,eAAe,CAAC,CAAC;MACnB,CAAC,CAAC,OAAON,CAAC,EAAE;QACVnD,uDAAQ,uCAAAwB,MAAA,CAAuC8B,WAAW,QAAKH,CAAC,CAAC;MACnE;IACF;EACF;EAEA,OAAO,SAAS4B,gBAAgBA,CAACC,MAAwC,EAAE;IACzE,MAAMC,QAAQ,GAAGD,MAAM,aAANA,MAAM,uBAANA,MAAM,CAAG3B,SAAS,CAAC;IACpC,IAAI,CAAC4B,QAAQ,IAAI,OAAOA,QAAQ,KAAK,QAAQ,EAAE;MAC7C/E,sDAAO,CAAC6D,GAAG,qDAAqD,CAAC,CAAC;MAClEW,KAAK,CAAC,CAAC;MACP,OAAO,CAAC,CAAC;IACX;;IAEA;IACA,IAAI,CAAAO,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEC,OAAO,MAAK,KAAK,EAAE;MAC/BhF,sDAAO,CAAC6D,GAAG,mEAAmE,CAAC,CAAC;MAChFe,uBAAuB,CAAC,CAAC;MACzB,OAAO,CAAC,CAAC;IACX;IAEA,IAAIK,UAAU;IACd,IAAIpF,oDAAK,CAACkF,QAAQ,CAACG,MAAM,CAAC,EAAE;MAC1BD,UAAU,GAAGF,QAAQ,CAACG,MAAM;IAC9B,CAAC,MAAM;MACLD,UAAU,GAAGzB,WAAW;MACxBzD,sDAAO,CAAC8D,GAAG,+DAAAvC,MAAA,CAA+DkC,WAAW,OAAI,CAAC,CAAC;IAC7F;IACA,IAAI3B,UAAU;IACd,IAAIlC,uDAAQ,CAACoF,QAAQ,CAACtC,OAAO,CAAC,EAAE;MAC9BZ,UAAU,GAAGkD,QAAQ,CAACtC,OAAO;IAC/B,CAAC,MAAM;MACLZ,UAAU,GAAG4B,uBAAuB;MACpC1D,sDAAO,CAAC8D,GAAG,mEAAAvC,MAAA,CAAmEmC,uBAAuB,OAAI,CAAC,CAAC;IAC7G;IACA,MAAM3B,aAAa,GAAGnC,uDAAQ,CAACoF,QAAQ,CAACjD,aAAa,CAAC,GAAGiD,QAAQ,CAACjD,aAAa,GAAG,IAAI;IACtF,IAAIF,QAAQ;IACZ,IAAIqD,UAAU,KAAK,QAAQ,EAAE;MAC3B,IAAIrF,4DAAa,CAACmF,QAAQ,CAACjE,WAAW,CAAC,EAAE;QACvCiD,iBAAiB,GAAGgB,QAAQ,CAACjE,WAAW;QACxCe,UAAU,GAAG,IAAI;QACjBD,QAAQ,GAAGA,CAAA,KAAM,IAAI3B,4DAAS,CAACkC,OAAO,IAAIA,OAAO,CAACR,kBAAkB,CAACmB,cAAc,CAACO,gBAAgB,CAACU,iBAAiB,CAAC,CAAC,CAAC,CAAC;MAC5H,CAAC,MAAM;QACLjE,uDAAQ,CAAC+D,GAAG,uGAAuG,CAAC,CAAC;MACvH;IACF,CAAC,MAAM,IAAI,CAACP,WAAW,CAAC6B,cAAc,CAACF,UAAU,CAAC,EAAE;MAClDtD,kBAAkB,CAACmB,cAAc,CAAC,IAAI,CAAC;MACvC9C,sDAAO,IAAAsB,MAAA,CAAI8B,WAAW,sBAAA9B,MAAA,CAAmB2D,UAAU,6FAA0F,CAAC;MAC9IrD,QAAQ,GAAGA,CAAA,KAAM3B,4DAAS,CAACkC,OAAO,CAAC,CAAC;IACtC,CAAC,MAAM;MACLP,QAAQ,GAAG0B,WAAW,CAAC2B,UAAU,CAAC;IACpC;IAEA,MAAMG,MAAM,GAAGA,CAAA,KAAM3D,iBAAiB,CAAC;MACrCpB,IAAI,EAAE+C,WAAW;MACjBzB,kBAAkB;MAClBC,QAAQ;MACRC,UAAU;MACVC,aAAa;MACbC;IACF,CAAC,CAAC;IAEF+B,QAAQ,GAAG,CAAC,MAAM;MAChB,IAAIuB,EAAE;MACN,OAAO,YAAY;QACjB,IAAIA,EAAE,IAAI,IAAI,EAAE;UACdA,EAAE,GAAGD,MAAM,CAAC,CAAC,CAAC/D,KAAK,CAACiE,GAAG,IAAI;YACzBD,EAAE,GAAG,IAAI;YACT,MAAMC,GAAG;UACX,CAAC,CAAC;QACJ;QACA,OAAOD,EAAE;MACX,CAAC;IACH,CAAC,EAAE,CAAC;IAEJf,QAAQ,CAAC,CAAC;IACV,OAAO;MACLW,UAAU;MACVpD,UAAU;MACVC,aAAa;MACbiC,iBAAiB;MACjBzD,eAAe;MACfG;IACF,CAAC;EACH,CAAC;AACH","sources":["webpack:///../../libraries/consentManagement/cmUtils.ts"],"sourcesContent":["import {timedAuctionHook} from '../../src/utils/perfMetrics.js';\nimport {isNumber, isPlainObject, isStr, logError, logInfo, logWarn} from '../../src/utils.js';\nimport {ConsentHandler} from '../../src/consentHandler.js';\nimport {PbPromise} from '../../src/utils/promise.js';\nimport {buildActivityParams} from '../../src/activities/params.js';\nimport {getHook} from '../../src/hook.js';\n\nexport function consentManagementHook(name, loadConsentData) {\n  const SEEN = new WeakSet();\n  return timedAuctionHook(name, function requestBidsHook(fn, reqBidsConfigObj) {\n    return loadConsentData().then(({consentData, error}) => {\n      if (error && (!consentData || !SEEN.has(error))) {\n        SEEN.add(error);\n        logWarn(error.message, ...(error.args || []));\n      }\n      fn.call(this, reqBidsConfigObj);\n    }).catch((error) => {\n      logError(`${error?.message} Canceling auction as per consentManagement config.`, ...(error?.args || []));\n      fn.stopTiming();\n      if (typeof reqBidsConfigObj.bidsBackHandler === 'function') {\n        reqBidsConfigObj.bidsBackHandler();\n      } else {\n        logError('Error executing bidsBackHandler');\n      }\n    });\n  });\n}\n\n/**\n *\n * @typedef {Function} CmpLookupFn CMP lookup function. Should set up communication and keep consent data updated\n *   through consent data handlers' `setConsentData`.\n * @param {SetProvisionalConsent} setProvisionalConsent optionally, the function can call this with provisional consent\n *   data, which will be used if the lookup times out before \"proper\" consent data can be retrieved.\n * @returns {Promise<{void}>} a promise that resolves when the auction should be continued, or rejects if it should be canceled.\n *\n * @typedef {Function} SetProvisionalConsent\n * @param {*} provisionalConsent\n * @returns {void}\n */\n\n/**\n * Look up consent data from CMP or config.\n *\n * @param {Object} options\n * @param {String} options.name e.g. 'GPP'. Used only for log messages.\n * @param {ConsentHandler} options.consentDataHandler consent data handler object (from src/consentHandler)\n * @param {CmpLookupFn} options.setupCmp\n * @param {Number?} options.cmpTimeout timeout (in ms) after which the auction should continue without consent data.\n * @param {Number?} options.actionTimeout timeout (in ms) from when provisional consent is available to when the auction should continue with it\n * @param {() => {}} options.getNullConsent consent data to use on timeout\n * @returns {Promise<{error: Error, consentData: {}}>}\n */\nexport function lookupConsentData(\n  {\n    name,\n    consentDataHandler,\n    setupCmp,\n    cmpTimeout,\n    actionTimeout,\n    getNullConsent\n  }\n) {\n  consentDataHandler.enable();\n  let timeoutHandle;\n\n  return new Promise((resolve, reject) => {\n    let provisionalConsent;\n    let cmpLoaded = false;\n\n    function setProvisionalConsent(consentData) {\n      provisionalConsent = consentData;\n      if (!cmpLoaded) {\n        cmpLoaded = true;\n        actionTimeout != null && resetTimeout(actionTimeout);\n      }\n    }\n\n    function resetTimeout(timeout) {\n      if (timeoutHandle != null) clearTimeout(timeoutHandle);\n      if (timeout != null) {\n        timeoutHandle = setTimeout(() => {\n          const consentData = consentDataHandler.getConsentData() ?? (cmpLoaded ? provisionalConsent : getNullConsent());\n          const message = `timeout waiting for ${cmpLoaded ? 'user action on CMP' : 'CMP to load'}`;\n          consentDataHandler.setConsentData(consentData);\n          resolve({consentData, error: new Error(`${name} ${message}`)});\n        }, timeout);\n      } else {\n        timeoutHandle = null;\n      }\n    }\n    setupCmp(setProvisionalConsent)\n      .then(() => resolve({consentData: consentDataHandler.getConsentData()}), reject);\n    cmpTimeout != null && resetTimeout(cmpTimeout);\n  }).finally(() => {\n    timeoutHandle && clearTimeout(timeoutHandle);\n  }).catch((e) => {\n    consentDataHandler.setConsentData(null);\n    throw e;\n  });\n}\n\nexport interface BaseCMConfig {\n  /**\n   * Length of time (in milliseconds) to delay auctions while waiting for consent data from the CMP.\n   * Default is 10,000.\n   */\n  timeout?: number;\n  /**\n   * Length of time (in milliseconds) to delay auctions while waiting for the user to interact with the CMP.\n   * When set, auctions will wait up to `timeout` for the CMP to load, and once loaded up to `actionTimeout`\n   * for the user to interact with the CMP.\n   */\n  actionTimeout?: number;\n  /**\n   * Flag to enable or disable the consent management module.\n   * When set to false, the module will be reset and disabled.\n   * Defaults to true when not specified.\n   */\n  enabled?: boolean;\n}\n\nexport interface IABCMConfig {\n  cmpApi?: 'iab';\n  consentData?: undefined;\n}\nexport interface StaticCMConfig<T> {\n  cmpApi: 'static';\n  /**\n   * Consent data as would be returned by a CMP.\n   */\n  consentData: T;\n}\n\nexport type CMConfig<T> = BaseCMConfig & (IABCMConfig | StaticCMConfig<T>);\n\nexport function configParser(\n  {\n    namespace,\n    displayName,\n    consentDataHandler,\n    parseConsentData,\n    getNullConsent,\n    cmpHandlers,\n    cmpEventCleanup,\n    DEFAULT_CMP = 'iab',\n    DEFAULT_CONSENT_TIMEOUT = 10000\n  } = {} as any\n) {\n  function msg(message) {\n    return `consentManagement.${namespace} ${message}`;\n  }\n  let requestBidsHook, cdLoader, staticConsentData;\n\n  function attachActivityParams(next, params) {\n    return next(Object.assign({[`${namespace}Consent`]: consentDataHandler.getConsentData()}, params));\n  }\n\n  function loadConsentData() {\n    return cdLoader().then(({error}) => ({error, consentData: consentDataHandler.getConsentData()}))\n  }\n\n  function activate() {\n    if (requestBidsHook == null) {\n      requestBidsHook = consentManagementHook(namespace, () => cdLoader());\n      getHook('requestBids').before(requestBidsHook, 50);\n      buildActivityParams.before(attachActivityParams);\n      logInfo(`${displayName} consentManagement module has been activated...`)\n    }\n  }\n\n  function reset() {\n    if (requestBidsHook != null) {\n      getHook('requestBids').getHooks({hook: requestBidsHook}).remove();\n      buildActivityParams.getHooks({hook: attachActivityParams}).remove();\n      requestBidsHook = null;\n      logInfo(`${displayName} consentManagement module has been deactivated...`);\n    }\n  }\n\n  function resetConsentDataHandler() {\n    reset();\n    // Call module-specific CMP event cleanup if provided\n    if (typeof cmpEventCleanup === 'function') {\n      try {\n        cmpEventCleanup();\n      } catch (e) {\n        logError(`Error during CMP event cleanup for ${displayName}:`, e);\n      }\n    }\n  }\n\n  return function getConsentConfig(config: { [key: string]: CMConfig<any> }) {\n    const cmConfig = config?.[namespace];\n    if (!cmConfig || typeof cmConfig !== 'object') {\n      logWarn(msg(`config not defined, exiting consent manager module`));\n      reset();\n      return {};\n    }\n\n    // Check if module is explicitly disabled\n    if (cmConfig?.enabled === false) {\n      logWarn(msg(`config enabled is set to false, disabling consent manager module`));\n      resetConsentDataHandler();\n      return {};\n    }\n\n    let cmpHandler;\n    if (isStr(cmConfig.cmpApi)) {\n      cmpHandler = cmConfig.cmpApi;\n    } else {\n      cmpHandler = DEFAULT_CMP;\n      logInfo(msg(`config did not specify cmp.  Using system default setting (${DEFAULT_CMP}).`));\n    }\n    let cmpTimeout;\n    if (isNumber(cmConfig.timeout)) {\n      cmpTimeout = cmConfig.timeout;\n    } else {\n      cmpTimeout = DEFAULT_CONSENT_TIMEOUT;\n      logInfo(msg(`config did not specify timeout.  Using system default setting (${DEFAULT_CONSENT_TIMEOUT}).`));\n    }\n    const actionTimeout = isNumber(cmConfig.actionTimeout) ? cmConfig.actionTimeout : null;\n    let setupCmp;\n    if (cmpHandler === 'static') {\n      if (isPlainObject(cmConfig.consentData)) {\n        staticConsentData = cmConfig.consentData;\n        cmpTimeout = null;\n        setupCmp = () => new PbPromise(resolve => resolve(consentDataHandler.setConsentData(parseConsentData(staticConsentData))))\n      } else {\n        logError(msg(`config with cmpApi: 'static' did not specify consentData. No consents will be available to adapters.`));\n      }\n    } else if (!cmpHandlers.hasOwnProperty(cmpHandler)) {\n      consentDataHandler.setConsentData(null);\n      logWarn(`${displayName} CMP framework (${cmpHandler}) is not a supported framework.  Aborting consentManagement module and resuming auction.`);\n      setupCmp = () => PbPromise.resolve();\n    } else {\n      setupCmp = cmpHandlers[cmpHandler];\n    }\n\n    const lookup = () => lookupConsentData({\n      name: displayName,\n      consentDataHandler,\n      setupCmp,\n      cmpTimeout,\n      actionTimeout,\n      getNullConsent,\n    });\n\n    cdLoader = (() => {\n      let cd;\n      return function () {\n        if (cd == null) {\n          cd = lookup().catch(err => {\n            cd = null;\n            throw err;\n          })\n        }\n        return cd;\n      }\n    })();\n\n    activate();\n    return {\n      cmpHandler,\n      cmpTimeout,\n      actionTimeout,\n      staticConsentData,\n      loadConsentData,\n      requestBidsHook\n    }\n  }\n}\n"],"names":["timedAuctionHook","isNumber","isPlainObject","isStr","logError","logInfo","logWarn","PbPromise","buildActivityParams","getHook","consentManagementHook","name","loadConsentData","SEEN","WeakSet","requestBidsHook","fn","reqBidsConfigObj","then","_ref","consentData","error","has","add","message","args","call","catch","concat","stopTiming","bidsBackHandler","lookupConsentData","_ref2","consentDataHandler","setupCmp","cmpTimeout","actionTimeout","getNullConsent","enable","timeoutHandle","Promise","resolve","reject","provisionalConsent","cmpLoaded","setProvisionalConsent","resetTimeout","timeout","clearTimeout","setTimeout","_consentDataHandler$g","getConsentData","setConsentData","Error","finally","e","configParser","namespace","displayName","parseConsentData","cmpHandlers","cmpEventCleanup","DEFAULT_CMP","DEFAULT_CONSENT_TIMEOUT","arguments","length","undefined","msg","cdLoader","staticConsentData","attachActivityParams","next","params","Object","assign","_ref3","activate","before","reset","getHooks","hook","remove","resetConsentDataHandler","getConsentConfig","config","cmConfig","enabled","cmpHandler","cmpApi","hasOwnProperty","lookup","cd","err"],"sourceRoot":""}