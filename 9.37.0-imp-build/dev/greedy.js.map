{"version":3,"file":"greedy.js","mappings":"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","sources":["webpack://prebid.js/./libraries/greedy/greedyPromise.js"],"sourcesContent":["const SUCCESS = 0;\nconst FAIL = 1;\n\n/**\n * A version of Promise that runs callbacks synchronously when it can (i.e. after it's been fulfilled or rejected).\n */\nexport class GreedyPromise {\n  #result;\n  #callbacks;\n\n  constructor(resolver) {\n    if (typeof resolver !== 'function') {\n      throw new Error('resolver not a function');\n    }\n    const result = [];\n    const callbacks = [];\n    let [resolve, reject] = [SUCCESS, FAIL].map((type) => {\n      return function (value) {\n        if (type === SUCCESS && typeof value?.then === 'function') {\n          value.then(resolve, reject);\n        } else if (!result.length) {\n          result.push(type, value);\n          while (callbacks.length) callbacks.shift()();\n        }\n      }\n    });\n    try {\n      resolver(resolve, reject);\n    } catch (e) {\n      reject(e);\n    }\n    this.#result = result;\n    this.#callbacks = callbacks;\n  }\n\n  then(onSuccess, onError) {\n    const result = this.#result;\n    return new this.constructor((resolve, reject) => {\n      const continuation = () => {\n        let value = result[1];\n        let [handler, resolveFn] = result[0] === SUCCESS ? [onSuccess, resolve] : [onError, reject];\n        if (typeof handler === 'function') {\n          try {\n            value = handler(value);\n          } catch (e) {\n            reject(e);\n            return;\n          }\n          resolveFn = resolve;\n        }\n        resolveFn(value);\n      }\n      result.length ? continuation() : this.#callbacks.push(continuation);\n    });\n  }\n\n  catch(onError) {\n    return this.then(null, onError);\n  }\n\n  finally(onFinally) {\n    let val;\n    return this.then(\n      (v) => { val = v; return onFinally(); },\n      (e) => { val = this.constructor.reject(e); return onFinally() }\n    ).then(() => val);\n  }\n\n  static #collect(promises, collector, done) {\n    let cnt = promises.length;\n    function clt() {\n      collector.apply(this, arguments);\n      if (--cnt <= 0 && done) done();\n    }\n    promises.length === 0 && done ? done() : promises.forEach((p, i) => this.resolve(p).then(\n      (val) => clt(true, val, i),\n      (err) => clt(false, err, i)\n    ));\n  }\n\n  static race(promises) {\n    return new this((resolve, reject) => {\n      this.#collect(promises, (success, result) => success ? resolve(result) : reject(result));\n    })\n  }\n\n  static all(promises) {\n    return new this((resolve, reject) => {\n      let res = [];\n      this.#collect(promises, (success, val, i) => success ? res[i] = val : reject(val), () => resolve(res));\n    })\n  }\n\n  static allSettled(promises) {\n    return new this((resolve) => {\n      let res = [];\n      this.#collect(promises, (success, val, i) => res[i] = success ? {status: 'fulfilled', value: val} : {status: 'rejected', reason: val}, () => resolve(res))\n    })\n  }\n\n  static resolve(value) {\n    return new this(resolve => resolve(value))\n  }\n\n  static reject(error) {\n    return new this((resolve, reject) => reject(error))\n  }\n}\n\nexport function greedySetTimeout(fn, delayMs = 0) {\n  if (delayMs > 0) {\n    return setTimeout(fn, delayMs)\n  } else {\n    fn()\n  }\n}\n"],"names":["SUCCESS","FAIL","GreedyPromise","result","callbacks","constructor","resolver","Error","resolve","reject","map","type","value","then","length","push","shift","e","onSuccess","onError","continuation","handler","resolveFn","catch","finally","onFinally","val","v","collect","#collect","promises","collector","done","cnt","clt","apply","arguments","forEach","p","i","err","race","success","all","res","allSettled","status","reason","error","greedySetTimeout","fn","delayMs","undefined","setTimeout"],"sourceRoot":""}