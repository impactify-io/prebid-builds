{"version":3,"file":"debugging-standalone.js","mappings":"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AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,oBAAoB;;AAEpB;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA,aAAa,0BAA0B;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,+BAA+B;AAC/B,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,WAAW;AACX,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;AClYO;AACP;AACA;AACA;AACA;AACA;AACA,4HAA4H;AAC5H;AACA;;;;;;;;;;;;;;;;ACRO;AACP;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;UC3BA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;ACNuC;AAEvChtE,MAAM,CAAC2kD,YAAY,CAAC//C,OAAO,CAAEiW,IAAI,IAAK;EACpC,IAAI7a,MAAM,CAAC6a,IAAI,CAAC,IAAI7a,MAAM,CAAC6a,IAAI,CAAC,CAACwyD,iBAAiB,KAAK,IAAI,EAAE;IAC3DrtE,MAAM,CAAC6a,IAAI,CAAC,CAACwyD,iBAAiB,GAAGp+D,kDAAO;EAC1C;AACF,CAAC,CAAC,C","sources":["webpack://prebid.js/./libraries/creative-renderer-display/renderer.js","webpack://prebid.js/./libraries/gptUtils/gptUtils.js","webpack://prebid.js/./libraries/greedy/greedyPromise.js","webpack://prebid.js/./modules/debugging/bidInterceptor.js","webpack://prebid.js/./modules/debugging/debugging.js","webpack://prebid.js/./modules/debugging/legacy.js","webpack://prebid.js/./modules/debugging/pbsInterceptor.js","webpack://prebid.js/./modules/debugging/responses.js","webpack://prebid.js/./src/Renderer.js","webpack://prebid.js/./src/activities/activities.js","webpack://prebid.js/./src/activities/activityParams.js","webpack://prebid.js/./src/activities/modules.js","webpack://prebid.js/./src/activities/params.js","webpack://prebid.js/./src/activities/redactor.js","webpack://prebid.js/./src/activities/rules.js","webpack://prebid.js/./src/adRendering.js","webpack://prebid.js/./src/adUnits.js","webpack://prebid.js/./src/adapter.js","webpack://prebid.js/./src/adapterManager.js","webpack://prebid.js/./src/adapters/bidderFactory.js","webpack://prebid.js/./src/adloader.js","webpack://prebid.js/./src/ajax.js","webpack://prebid.js/./src/auction.js","webpack://prebid.js/./src/auctionIndex.js","webpack://prebid.js/./src/auctionManager.js","webpack://prebid.js/./src/bidTTL.js","webpack://prebid.js/./src/bidderSettings.js","webpack://prebid.js/./src/bidfactory.js","webpack://prebid.js/./src/config.js","webpack://prebid.js/./src/consentHandler.js","webpack://prebid.js/./src/constants.js","webpack://prebid.js/./src/cpmBucketManager.js","webpack://prebid.js/./src/creativeRenderers.js","webpack://prebid.js/./src/eventTrackers.js","webpack://prebid.js/./src/events.js","webpack://prebid.js/./src/fpd/oneClient.js","webpack://prebid.js/./src/hook.js","webpack://prebid.js/./src/mediaTypes.js","webpack://prebid.js/./src/native.js","webpack://prebid.js/./src/polyfill.js","webpack://prebid.js/./src/prebidGlobal.js","webpack://prebid.js/./src/refererDetection.js","webpack://prebid.js/./src/storageManager.js","webpack://prebid.js/./src/targeting.js","webpack://prebid.js/./src/userSync.js","webpack://prebid.js/./src/utils.js","webpack://prebid.js/./src/utils/cpm.js","webpack://prebid.js/./src/utils/focusTimeout.js","webpack://prebid.js/./src/utils/ipUtils.js","webpack://prebid.js/./src/utils/perfMetrics.js","webpack://prebid.js/./src/utils/promise.js","webpack://prebid.js/./src/utils/reducers.js","webpack://prebid.js/./src/utils/ttlCollection.js","webpack://prebid.js/./src/video.js","webpack://prebid.js/./src/videoCache.js","webpack://prebid.js/./node_modules/dlv/index.js","webpack://prebid.js/./node_modules/fun-hooks/no-eval/index.js","webpack://prebid.js/./node_modules/dset/dist/index.mjs","webpack://prebid.js/./node_modules/klona/json/index.mjs","webpack://prebid.js/webpack/bootstrap","webpack://prebid.js/webpack/runtime/compat get default export","webpack://prebid.js/webpack/runtime/define property getters","webpack://prebid.js/webpack/runtime/hasOwnProperty shorthand","webpack://prebid.js/webpack/runtime/make namespace object","webpack://prebid.js/./modules/debugging/standalone.js"],"sourcesContent":["// this file is autogenerated, see creative/README.md\nexport const RENDERER = \"(()=>{\\\"use strict\\\";window.render=function({ad:e,adUrl:t,width:n,height:i,instl:d},{mkFrame:r},s){if(!e&&!t)throw{reason:\\\"noAd\\\",message:\\\"Missing ad markup or URL\\\"};{if(null==i){const e=s.document?.body;[e,e?.parentElement].filter((e=>null!=e?.style)).forEach((e=>e.style.height=\\\"100%\\\"))}const h=s.document,o={width:n??\\\"100%\\\",height:i??\\\"100%\\\"};if(t&&!e?o.src=t:o.srcdoc=e,h.body.appendChild(r(h,o)),d&&s.frameElement){const e=s.frameElement.style;e.width=n?`${n}px`:\\\"100vw\\\",e.height=i?`${i}px`:\\\"100vh\\\"}}}})();\"","import { CLIENT_SECTIONS } from '../../src/fpd/oneClient.js';\nimport {find} from '../../src/polyfill.js';\nimport {compareCodeAndSlot, deepAccess, isGptPubadsDefined, uniques} from '../../src/utils.js';\n\n/**\n * Returns filter function to match adUnitCode in slot\n * @param {string} adUnitCode AdUnit code\n * @return {function} filter function\n */\nexport function isSlotMatchingAdUnitCode(adUnitCode) {\n  return (slot) => compareCodeAndSlot(slot, adUnitCode);\n}\n\n/**\n * @summary Export a k-v pair to GAM\n */\nexport function setKeyValue(key, value) {\n  if (!key || typeof key !== 'string') return false;\n  window.googletag = window.googletag || {cmd: []};\n  window.googletag.cmd = window.googletag.cmd || [];\n  window.googletag.cmd.push(() => {\n    window.googletag.pubads().setTargeting(key, value);\n  });\n}\n\n/**\n * @summary Uses the adUnit's code in order to find a matching gpt slot object on the page\n */\nexport function getGptSlotForAdUnitCode(adUnitCode) {\n  let matchingSlot;\n  if (isGptPubadsDefined()) {\n    // find the first matching gpt slot on the page\n    matchingSlot = find(window.googletag.pubads().getSlots(), isSlotMatchingAdUnitCode(adUnitCode));\n  }\n  return matchingSlot;\n}\n\n/**\n * @summary Uses the adUnit's code in order to find a matching gptSlot on the page\n */\nexport function getGptSlotInfoForAdUnitCode(adUnitCode) {\n  const matchingSlot = getGptSlotForAdUnitCode(adUnitCode);\n  if (matchingSlot) {\n    return {\n      gptSlot: matchingSlot.getAdUnitPath(),\n      divId: matchingSlot.getSlotElementId()\n    };\n  }\n  return {};\n}\n\nexport const taxonomies = ['IAB_AUDIENCE_1_1', 'IAB_CONTENT_2_2'];\n\nexport function getSignals(fpd) {\n  const signals = Object.entries({\n    [taxonomies[0]]: getSegments(fpd, ['user.data'], 4),\n    [taxonomies[1]]: getSegments(fpd, CLIENT_SECTIONS.map(section => `${section}.content.data`), 6)\n  }).map(([taxonomy, values]) => values.length ? {taxonomy, values} : null)\n    .filter(ob => ob);\n\n  return signals;\n}\n\nexport function getSegments(fpd, sections, segtax) {\n  return sections\n    .flatMap(section => deepAccess(fpd, section) || [])\n    .filter(datum => datum.ext?.segtax === segtax)\n    .flatMap(datum => datum.segment?.map(seg => seg.id))\n    .filter(ob => ob)\n    .filter(uniques)\n}\n\n/**\n * Add an event listener on the given GAM event.\n * If GPT Pubads isn't defined, window.googletag is set to a new object.\n * @param {String} event\n * @param {Function} callback\n */\nexport function subscribeToGamEvent(event, callback) {\n  const register = () => window.googletag.pubads().addEventListener(event, callback);\n  if (isGptPubadsDefined()) {\n    register();\n    return;\n  }\n  window.googletag = window.googletag || {};\n  window.googletag.cmd = window.googletag.cmd || [];\n  window.googletag.cmd.push(register);\n}\n\n/**\n * @typedef {Object} Slot\n * @property {function(String): (String|null)} get\n * @property {function(): String} getAdUnitPath\n * @property {function(): String[]} getAttributeKeys\n * @property {function(): String[]} getCategoryExclusions\n * @property {function(String): String} getSlotElementId\n * @property {function(): String[]} getTargeting\n * @property {function(): String[]} getTargetingKeys\n * @see {@link https://developers.google.com/publisher-tag/reference#googletag.Slot GPT official docs}\n */\n\n/**\n * @typedef {Object} SlotRenderEndedEvent\n * @property {(String|null)} advertiserId\n * @property {(String|null)} campaignId\n * @property {(String[]|null)} companyIds\n * @property {(Number|null)} creativeId\n * @property {(Number|null)} creativeTemplateId\n * @property {(Boolean)} isBackfill\n * @property {(Boolean)} isEmpty\n * @property {(Number[]|null)} labelIds\n * @property {(Number|null)} lineItemId\n * @property {(String)} serviceName\n * @property {(string|Number[]|null)} size\n * @property {(Slot)} slot\n * @property {(Boolean)} slotContentChanged\n * @property {(Number|null)} sourceAgnosticCreativeId\n * @property {(Number|null)} sourceAgnosticLineItemId\n * @property {(Number[]|null)} yieldGroupIds\n * @see {@link https://developers.google.com/publisher-tag/reference#googletag.events.SlotRenderEndedEvent GPT official docs}\n */\n\n/**\n * @callback SlotRenderEndedEventCallback\n * @param {SlotRenderEndedEvent} event\n * @returns {void}\n */\n\n/**\n * Add an event listener on the GAM event 'slotRenderEnded'.\n * @param {SlotRenderEndedEventCallback} callback\n */\nexport function subscribeToGamSlotRenderEndedEvent(callback) {\n  subscribeToGamEvent('slotRenderEnded', callback)\n}\n","const SUCCESS = 0;\nconst FAIL = 1;\n\n/**\n * A version of Promise that runs callbacks synchronously when it can (i.e. after it's been fulfilled or rejected).\n */\nexport class GreedyPromise {\n  #result;\n  #callbacks;\n\n  constructor(resolver) {\n    if (typeof resolver !== 'function') {\n      throw new Error('resolver not a function');\n    }\n    const result = [];\n    const callbacks = [];\n    let [resolve, reject] = [SUCCESS, FAIL].map((type) => {\n      return function (value) {\n        if (type === SUCCESS && typeof value?.then === 'function') {\n          value.then(resolve, reject);\n        } else if (!result.length) {\n          result.push(type, value);\n          while (callbacks.length) callbacks.shift()();\n        }\n      }\n    });\n    try {\n      resolver(resolve, reject);\n    } catch (e) {\n      reject(e);\n    }\n    this.#result = result;\n    this.#callbacks = callbacks;\n  }\n\n  then(onSuccess, onError) {\n    const result = this.#result;\n    return new this.constructor((resolve, reject) => {\n      const continuation = () => {\n        let value = result[1];\n        let [handler, resolveFn] = result[0] === SUCCESS ? [onSuccess, resolve] : [onError, reject];\n        if (typeof handler === 'function') {\n          try {\n            value = handler(value);\n          } catch (e) {\n            reject(e);\n            return;\n          }\n          resolveFn = resolve;\n        }\n        resolveFn(value);\n      }\n      result.length ? continuation() : this.#callbacks.push(continuation);\n    });\n  }\n\n  catch(onError) {\n    return this.then(null, onError);\n  }\n\n  finally(onFinally) {\n    let val;\n    return this.then(\n      (v) => { val = v; return onFinally(); },\n      (e) => { val = this.constructor.reject(e); return onFinally() }\n    ).then(() => val);\n  }\n\n  static #collect(promises, collector, done) {\n    let cnt = promises.length;\n    function clt() {\n      collector.apply(this, arguments);\n      if (--cnt <= 0 && done) done();\n    }\n    promises.length === 0 && done ? done() : promises.forEach((p, i) => this.resolve(p).then(\n      (val) => clt(true, val, i),\n      (err) => clt(false, err, i)\n    ));\n  }\n\n  static race(promises) {\n    return new this((resolve, reject) => {\n      this.#collect(promises, (success, result) => success ? resolve(result) : reject(result));\n    })\n  }\n\n  static all(promises) {\n    return new this((resolve, reject) => {\n      let res = [];\n      this.#collect(promises, (success, val, i) => success ? res[i] = val : reject(val), () => resolve(res));\n    })\n  }\n\n  static allSettled(promises) {\n    return new this((resolve) => {\n      let res = [];\n      this.#collect(promises, (success, val, i) => res[i] = success ? {status: 'fulfilled', value: val} : {status: 'rejected', reason: val}, () => resolve(res))\n    })\n  }\n\n  static resolve(value) {\n    return new this(resolve => resolve(value))\n  }\n\n  static reject(error) {\n    return new this((resolve, reject) => reject(error))\n  }\n}\n\nexport function greedySetTimeout(fn, delayMs = 0) {\n  if (delayMs > 0) {\n    return setTimeout(fn, delayMs)\n  } else {\n    fn()\n  }\n}\n","import {BANNER, VIDEO} from '../../src/mediaTypes.js';\nimport {deepAccess, deepClone, delayExecution, hasNonSerializableProperty, mergeDeep} from '../../src/utils.js';\nimport responseResolvers from './responses.js';\n\n/**\n * @typedef {Number|String|boolean|null|undefined} Scalar\n */\n\nexport function BidInterceptor(opts = {}) {\n  ({setTimeout: this.setTimeout = window.setTimeout.bind(window)} = opts);\n  this.logger = opts.logger;\n  this.rules = [];\n}\n\nObject.assign(BidInterceptor.prototype, {\n  DEFAULT_RULE_OPTIONS: {\n    delay: 0\n  },\n  serializeConfig(ruleDefs) {\n    const isSerializable = (ruleDef, i) => {\n      const serializable = !hasNonSerializableProperty(ruleDef);\n      if (!serializable && !deepAccess(ruleDef, 'options.suppressWarnings')) {\n        this.logger.logWarn(`Bid interceptor rule definition #${i + 1} contains non-serializable properties and will be lost after a refresh. Rule definition: `, ruleDef);\n      }\n      return serializable;\n    }\n    return ruleDefs.filter(isSerializable);\n  },\n  updateConfig(config) {\n    this.rules = (config.intercept || []).map((ruleDef, i) => this.rule(ruleDef, i + 1))\n  },\n  /**\n   * @typedef {Object} RuleOptions\n   * @property {Number} [delay=0] delay between bid interception and mocking of response (to simulate network delay)\n   * @property {boolean} [suppressWarnings=false] if enabled, do not warn about unserializable rules\n   *\n   * @typedef {Object} Rule\n   * @property {Number} no rule number (used only as an identifier for logging)\n   * @property {function({}, {}): boolean} match a predicate function that tests a bid against this rule\n   * @property {ReplacerFn} replacer generator function for mock bid responses\n   * @property {RuleOptions} options\n   */\n\n  /**\n   * @param {{}} ruleDef\n   * @param {Number} ruleNo\n   * @returns {Rule}\n   */\n  rule(ruleDef, ruleNo) {\n    return {\n      no: ruleNo,\n      match: this.matcher(ruleDef.when, ruleNo),\n      replace: this.replacer(ruleDef.then, ruleNo),\n      options: Object.assign({}, this.DEFAULT_RULE_OPTIONS, ruleDef.options),\n      paapi: this.paapiReplacer(ruleDef.paapi || [], ruleNo)\n    }\n  },\n  /**\n   * @typedef {Function} MatchPredicate\n   * @param {*} candidate a bid to match, or a portion of it if used inside an ObjectMather.\n   * e.g. matcher((bid, bidRequest) => ....) or matcher({property: (property, bidRequest) => ...})\n   * @param {BidRequest} bidRequest the request `candidate` belongs to\n   * @returns {boolean}\n   *\n   * @typedef {{[key]: Scalar|RegExp|MatchPredicate|ObjectMatcher}} ObjectMatcher\n   */\n\n  /**\n   * @param {MatchPredicate|ObjectMatcher} matchDef matcher definition\n   * @param {Number} ruleNo\n   * @returns {MatchPredicate} a predicate function that matches a bid against the given `matchDef`\n   */\n  matcher(matchDef, ruleNo) {\n    if (typeof matchDef === 'function') {\n      return matchDef;\n    }\n    if (typeof matchDef !== 'object') {\n      this.logger.logError(`Invalid 'when' definition for debug bid interceptor (in rule #${ruleNo})`);\n      return () => false;\n    }\n    function matches(candidate, {ref = matchDef, args = []}) {\n      return Object.entries(ref).map(([key, val]) => {\n        const cVal = candidate[key];\n        if (val instanceof RegExp) {\n          return val.exec(cVal) != null;\n        }\n        if (typeof val === 'function') {\n          return !!val(cVal, ...args);\n        }\n        if (typeof val === 'object') {\n          return matches(cVal, {ref: val, args});\n        }\n        return cVal === val;\n      }).every((i) => i);\n    }\n    return (candidate, ...args) => matches(candidate, {args});\n  },\n  /**\n   * @typedef {Function} ReplacerFn\n   * @param {*} bid a bid that was intercepted\n   * @param {BidRequest} bidRequest the request `bid` belongs to\n   * @returns {*} the response to mock for `bid`, or a portion of it if used inside an ObjectReplacer.\n   * e.g. replacer((bid, bidRequest) => mockResponse) or replacer({property: (bid, bidRequest) => mockProperty})\n   *\n   * @typedef {{[key]: ReplacerFn|ObjectReplacer|*}} ObjectReplacer\n   */\n\n  /**\n   * @param {ReplacerFn|ObjectReplacer} replDef replacer definition\n   * @param ruleNo\n   * @return {ReplacerFn}\n   */\n  replacer(replDef, ruleNo) {\n    if (replDef === null) {\n      return () => null\n    }\n    replDef = replDef || {};\n    let replFn;\n    if (typeof replDef === 'function') {\n      replFn = ({args}) => replDef(...args);\n    } else if (typeof replDef !== 'object') {\n      this.logger.logError(`Invalid 'then' definition for debug bid interceptor (in rule #${ruleNo})`);\n      replFn = () => ({});\n    } else {\n      replFn = ({args, ref = replDef}) => {\n        const result = Array.isArray(ref) ? [] : {};\n        Object.entries(ref).forEach(([key, val]) => {\n          if (typeof val === 'function') {\n            result[key] = val(...args);\n          } else if (val != null && typeof val === 'object') {\n            result[key] = replFn({args, ref: val})\n          } else {\n            result[key] = val;\n          }\n        });\n        return result;\n      }\n    }\n    return (bid, ...args) => {\n      const response = this.responseDefaults(bid);\n      mergeDeep(response, replFn({args: [bid, ...args]}));\n      const resolver = responseResolvers[response.mediaType];\n      resolver && resolver(bid, response);\n      response.isDebug = true;\n      return response;\n    }\n  },\n\n  paapiReplacer(paapiDef, ruleNo) {\n    function wrap(configs = []) {\n      return configs.map(config => {\n        return Object.keys(config).some(k => !['config', 'igb'].includes(k))\n          ? {config}\n          : config\n      });\n    }\n    if (Array.isArray(paapiDef)) {\n      return () => wrap(paapiDef);\n    } else if (typeof paapiDef === 'function') {\n      return (...args) => wrap(paapiDef(...args))\n    } else {\n      this.logger.logError(`Invalid 'paapi' definition for debug bid interceptor (in rule #${ruleNo})`);\n    }\n  },\n\n  responseDefaults(bid) {\n    const response = {\n      requestId: bid.bidId,\n      cpm: 3.5764,\n      currency: 'EUR',\n      ttl: 360,\n      creativeId: 'mock-creative-id',\n      netRevenue: false,\n      meta: {}\n    };\n\n    if (!bid.mediaType) {\n      response.mediaType = Object.keys(bid.mediaTypes ?? {})[0] ?? BANNER;\n    }\n    let size;\n    if (response.mediaType === BANNER) {\n      size = bid.mediaTypes?.banner?.sizes?.[0] ?? [300, 250];\n    } else if (response.mediaType === VIDEO) {\n      size = bid.mediaTypes?.video?.playerSize?.[0] ?? [600, 500];\n    }\n    if (Array.isArray(size)) {\n      ([response.width, response.height] = size);\n    }\n    return response;\n  },\n  /**\n   * Match a candidate bid against all registered rules.\n   *\n   * @param {{}} candidate\n   * @param args\n   * @returns {Rule|undefined} the first matching rule, or undefined if no match was found.\n   */\n  match(candidate, ...args) {\n    return this.rules.find((rule) => rule.match(candidate, ...args));\n  },\n  /**\n   * Match a set of bids against all registered rules.\n   *\n   * @param bids\n   * @param bidRequest\n   * @returns {[{bid: *, rule: Rule}[], *[]]} a 2-tuple for matching bids (decorated with the matching rule) and\n   * non-matching bids.\n   */\n  matchAll(bids, bidRequest) {\n    const [matches, remainder] = [[], []];\n    bids.forEach((bid) => {\n      const rule = this.match(bid, bidRequest);\n      if (rule != null) {\n        matches.push({rule: rule, bid: bid});\n      } else {\n        remainder.push(bid);\n      }\n    })\n    return [matches, remainder];\n  },\n  /**\n   * Run a set of bids against all registered rules, filter out those that match,\n   * and generate mock responses for them.\n   *\n   * @param {{}[]} bids?\n   * @param {BidRequest} bidRequest\n   * @param {function(*)} addBid called once for each mock response\n   * @param addPaapiConfig called once for each mock PAAPI config\n   * @param {function()} done called once after all mock responses have been run through `addBid`\n   * @returns {{bids: {}[], bidRequest: {}} remaining bids that did not match any rule (this applies also to\n   * bidRequest.bids)\n   */\n  intercept({bids, bidRequest, addBid, addPaapiConfig, done}) {\n    if (bids == null) {\n      bids = bidRequest.bids;\n    }\n    const [matches, remainder] = this.matchAll(bids, bidRequest);\n    if (matches.length > 0) {\n      const callDone = delayExecution(done, matches.length);\n      matches.forEach((match) => {\n        const mockResponse = match.rule.replace(match.bid, bidRequest);\n        const mockPaapi = match.rule.paapi(match.bid, bidRequest);\n        const delay = match.rule.options.delay;\n        this.logger.logMessage(`Intercepted bid request (matching rule #${match.rule.no}), mocking response in ${delay}ms. Request, response, PAAPI configs:`, match.bid, mockResponse, mockPaapi)\n        this.setTimeout(() => {\n          mockResponse && addBid(mockResponse, match.bid);\n          mockPaapi.forEach(cfg => addPaapiConfig(cfg, match.bid, bidRequest));\n          callDone();\n        }, delay)\n      });\n      bidRequest = deepClone(bidRequest);\n      bids = bidRequest.bids = remainder;\n    } else {\n      this.setTimeout(done, 0);\n    }\n    return {bids, bidRequest};\n  }\n});\n","import {deepClone, delayExecution} from '../../src/utils.js';\nimport {BidInterceptor} from './bidInterceptor.js';\nimport {makePbsInterceptor} from './pbsInterceptor.js';\nimport {addHooks, removeHooks} from './legacy.js';\n\nconst interceptorHooks = [];\nlet bidInterceptor;\nlet enabled = false;\n\nfunction enableDebugging(debugConfig, {fromSession = false, config, hook, logger}) {\n  config.setConfig({debug: true});\n  bidInterceptor.updateConfig(debugConfig);\n  resetHooks(true);\n  // also enable \"legacy\" overrides\n  removeHooks({hook});\n  addHooks(debugConfig, {hook, logger});\n  if (!enabled) {\n    enabled = true;\n    logger.logMessage(`Debug overrides enabled${fromSession ? ' from session' : ''}`);\n  }\n}\n\nexport function disableDebugging({hook, logger}) {\n  bidInterceptor.updateConfig(({}));\n  resetHooks(false);\n  // also disable \"legacy\" overrides\n  removeHooks({hook});\n  if (enabled) {\n    enabled = false;\n    logger.logMessage('Debug overrides disabled');\n  }\n}\n\n// eslint-disable-next-line no-restricted-properties\nfunction saveDebuggingConfig(debugConfig, {sessionStorage = window.sessionStorage, DEBUG_KEY} = {}) {\n  if (!debugConfig.enabled) {\n    try {\n      sessionStorage.removeItem(DEBUG_KEY);\n    } catch (e) {\n    }\n  } else {\n    if (debugConfig.intercept) {\n      debugConfig = deepClone(debugConfig);\n      debugConfig.intercept = bidInterceptor.serializeConfig(debugConfig.intercept);\n    }\n    try {\n      sessionStorage.setItem(DEBUG_KEY, JSON.stringify(debugConfig));\n    } catch (e) {\n    }\n  }\n}\n\n// eslint-disable-next-line no-restricted-properties\nexport function getConfig(debugging, {getStorage = () => window.sessionStorage, DEBUG_KEY, config, hook, logger} = {}) {\n  if (debugging == null) return;\n  let sessionStorage;\n  try {\n    sessionStorage = getStorage();\n  } catch (e) {\n    logger.logError(`sessionStorage is not available: debugging configuration will not persist on page reload`, e);\n  }\n  if (sessionStorage != null) {\n    saveDebuggingConfig(debugging, {sessionStorage, DEBUG_KEY});\n  }\n  if (!debugging.enabled) {\n    disableDebugging({hook, logger});\n  } else {\n    enableDebugging(debugging, {config, hook, logger});\n  }\n}\n\nexport function sessionLoader({DEBUG_KEY, storage, config, hook, logger}) {\n  let overrides;\n  try {\n    // eslint-disable-next-line no-restricted-properties\n    storage = storage || window.sessionStorage;\n    overrides = JSON.parse(storage.getItem(DEBUG_KEY));\n  } catch (e) {\n  }\n  if (overrides) {\n    enableDebugging(overrides, {fromSession: true, config, hook, logger});\n  }\n}\n\nfunction resetHooks(enable) {\n  interceptorHooks.forEach(([getHookFn, interceptor]) => {\n    getHookFn().getHooks({hook: interceptor}).remove();\n  });\n  if (enable) {\n    interceptorHooks.forEach(([getHookFn, interceptor]) => {\n      getHookFn().before(interceptor);\n    });\n  }\n}\n\nfunction registerBidInterceptor(getHookFn, interceptor) {\n  const interceptBids = (...args) => bidInterceptor.intercept(...args);\n  interceptorHooks.push([getHookFn, function (next, ...args) {\n    interceptor(next, interceptBids, ...args);\n  }]);\n}\n\nexport function bidderBidInterceptor(next, interceptBids, spec, bids, bidRequest, ajax, wrapCallback, cbs) {\n  const done = delayExecution(cbs.onCompletion, 2);\n  ({bids, bidRequest} = interceptBids({\n    bids,\n    bidRequest,\n    addBid: wrapCallback(cbs.onBid),\n    addPaapiConfig: wrapCallback((config, bidRequest) => cbs.onPaapi({bidId: bidRequest.bidId, ...config})),\n    done\n  }));\n  if (bids.length === 0) {\n    cbs.onResponse?.({}); // trigger onResponse so that the bidder may be marked as \"timely\" if necessary\n    done();\n  } else {\n    next(spec, bids, bidRequest, ajax, wrapCallback, {...cbs, onCompletion: done});\n  }\n}\n\nexport function install({DEBUG_KEY, config, hook, createBid, logger}) {\n  bidInterceptor = new BidInterceptor({logger});\n  const pbsBidInterceptor = makePbsInterceptor({createBid});\n  registerBidInterceptor(() => hook.get('processBidderRequests'), bidderBidInterceptor);\n  registerBidInterceptor(() => hook.get('processPBSRequest'), pbsBidInterceptor);\n  sessionLoader({DEBUG_KEY, config, hook, logger});\n  config.getConfig('debugging', ({debugging}) => getConfig(debugging, {DEBUG_KEY, config, hook, logger}), {init: true});\n}\n","export let addBidResponseBound;\nexport let addBidderRequestsBound;\n\nexport function addHooks(overrides, {hook, logger}) {\n  addBidResponseBound = addBidResponseHook.bind({overrides, logger});\n  hook.get('addBidResponse').before(addBidResponseBound, 5);\n\n  addBidderRequestsBound = addBidderRequestsHook.bind({overrides, logger});\n  hook.get('addBidderRequests').before(addBidderRequestsBound, 5);\n}\n\nexport function removeHooks({hook}) {\n  hook.get('addBidResponse').getHooks({hook: addBidResponseBound}).remove();\n  hook.get('addBidderRequests').getHooks({hook: addBidderRequestsBound}).remove();\n}\n\n/**\n * @param {{bidder:string, adUnitCode:string}} overrideObj\n * @param {string} bidderCode\n * @param {string} adUnitCode\n * @returns {boolean}\n */\nexport function bidExcluded(overrideObj, bidderCode, adUnitCode) {\n  if (overrideObj.bidder && overrideObj.bidder !== bidderCode) {\n    return true;\n  }\n  if (overrideObj.adUnitCode && overrideObj.adUnitCode !== adUnitCode) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * @param {string[]} bidders\n * @param {string} bidderCode\n * @returns {boolean}\n */\nexport function bidderExcluded(bidders, bidderCode) {\n  return (Array.isArray(bidders) && bidders.indexOf(bidderCode) === -1);\n}\n\n/**\n * @param {Object} overrideObj\n * @param {Object} bidObj\n * @param {Object} bidType\n * @returns {Object} bidObj with overridden properties\n */\nexport function applyBidOverrides(overrideObj, bidObj, bidType, logger) {\n  return Object.keys(overrideObj).filter(key => (['adUnitCode', 'bidder'].indexOf(key) === -1)).reduce(function(result, key) {\n    logger.logMessage(`bidder overrides changed '${result.adUnitCode}/${result.bidderCode}' ${bidType}.${key} from '${result[key]}.js' to '${overrideObj[key]}'`);\n    result[key] = overrideObj[key];\n    result.isDebug = true;\n    return result;\n  }, bidObj);\n}\n\nexport function addBidResponseHook(next, adUnitCode, bid, reject) {\n  const {overrides, logger} = this;\n\n  if (bidderExcluded(overrides.bidders, bid.bidderCode)) {\n    logger.logWarn(`bidder '${bid.bidderCode}' excluded from auction by bidder overrides`);\n    return;\n  }\n\n  if (Array.isArray(overrides.bids)) {\n    overrides.bids.forEach(function(overrideBid) {\n      if (!bidExcluded(overrideBid, bid.bidderCode, adUnitCode)) {\n        applyBidOverrides(overrideBid, bid, 'bidder', logger);\n      }\n    });\n  }\n\n  next(adUnitCode, bid, reject);\n}\n\nexport function addBidderRequestsHook(next, bidderRequests) {\n  const {overrides, logger} = this;\n\n  const includedBidderRequests = bidderRequests.filter(function (bidderRequest) {\n    if (bidderExcluded(overrides.bidders, bidderRequest.bidderCode)) {\n      logger.logWarn(`bidRequest '${bidderRequest.bidderCode}' excluded from auction by bidder overrides`);\n      return false;\n    }\n    return true;\n  });\n\n  if (Array.isArray(overrides.bidRequests)) {\n    includedBidderRequests.forEach(function(bidderRequest) {\n      overrides.bidRequests.forEach(function(overrideBid) {\n        bidderRequest.bids.forEach(function(bid) {\n          if (!bidExcluded(overrideBid, bidderRequest.bidderCode, bid.adUnitCode)) {\n            applyBidOverrides(overrideBid, bid, 'bidRequest', logger);\n          }\n        });\n      });\n    });\n  }\n\n  next(includedBidderRequests);\n}\n","import {deepClone, delayExecution} from '../../src/utils.js';\nimport { STATUS } from '../../src/constants.js';\n\nexport function makePbsInterceptor({createBid}) {\n  return function pbsBidInterceptor(next, interceptBids, s2sBidRequest, bidRequests, ajax, {\n    onResponse,\n    onError,\n    onBid,\n    onFledge,\n  }) {\n    let responseArgs;\n    const done = delayExecution(() => onResponse(...responseArgs), bidRequests.length + 1)\n    function signalResponse(...args) {\n      responseArgs = args;\n      done();\n    }\n    function addBid(bid, bidRequest) {\n      onBid({\n        adUnit: bidRequest.adUnitCode,\n        bid: Object.assign(createBid(STATUS.GOOD, bidRequest), {requestBidder: bidRequest.bidder}, bid)\n      })\n    }\n    bidRequests = bidRequests\n      .map((req) => interceptBids({\n        bidRequest: req,\n        addBid,\n        addPaapiConfig(config, bidRequest, bidderRequest) {\n          onFledge({\n            adUnitCode: bidRequest.adUnitCode,\n            ortb2: bidderRequest.ortb2,\n            ortb2Imp: bidRequest.ortb2Imp,\n            ...config\n          })\n        },\n        done\n      }).bidRequest)\n      .filter((req) => req.bids.length > 0)\n\n    if (bidRequests.length > 0) {\n      const bidIds = new Set();\n      bidRequests.forEach((req) => req.bids.forEach((bid) => bidIds.add(bid.bidId)));\n      s2sBidRequest = deepClone(s2sBidRequest);\n      s2sBidRequest.ad_units.forEach((unit) => {\n        unit.bids = unit.bids.filter((bid) => bidIds.has(bid.bid_id));\n      })\n      s2sBidRequest.ad_units = s2sBidRequest.ad_units.filter((unit) => unit.bids.length > 0);\n      next(s2sBidRequest, bidRequests, ajax, {onResponse: signalResponse, onError, onBid});\n    } else {\n      signalResponse(true, []);\n    }\n  }\n}\n","import {BANNER, NATIVE, VIDEO} from '../../src/mediaTypes.js';\nimport {Renderer} from '../../src/Renderer.js';\nimport {getGptSlotInfoForAdUnitCode} from '../../libraries/gptUtils/gptUtils.js';\n\nconst ORTB_NATIVE_ASSET_TYPES = ['img', 'video', 'link', 'data', 'title'];\n\nexport default {\n  [BANNER]: (bid, bidResponse) => {\n    if (!bidResponse.hasOwnProperty('ad') && !bidResponse.hasOwnProperty('adUrl')) {\n      let [size, repeat] = (bidResponse.width ?? bidResponse.wratio) < (bidResponse.height ?? bidResponse.hratio) ? [bidResponse.width, 'repeat-y'] : [bidResponse.height, 'repeat-x'];\n      size = size == null ? '100%' : `${size}px`;\n      bidResponse.ad = `<html><body><div style=\"display: inline-block; height: ${bidResponse.height == null ? '100%' : bidResponse.height + 'px'}; width: ${bidResponse.width == null ? '100%' : bidResponse.width + 'px'}; background-image: url(https://vcdn.adnxs.com/p/creative-image/27/c0/52/67/27c05267-5a6d-4874-834e-18e218493c32.png); background-size: ${size}; background-repeat: ${repeat}\"></div></body></html>`;\n    }\n  },\n  [VIDEO]: (bid, bidResponse) => {\n    if (!bidResponse.hasOwnProperty('vastXml') && !bidResponse.hasOwnProperty('vastUrl')) {\n      bidResponse.vastXml = '<?xml version=\"1.0\" encoding=\"UTF-8\"?><VAST version=\"3.0\"><Ad><InLine><AdSystem>GDFP</AdSystem><AdTitle>Demo</AdTitle><Description><![CDATA[Demo]]></Description><Creatives><Creative><Linear ><Duration>00:00:11</Duration><VideoClicks><ClickThrough><![CDATA[https://prebid.org/]]></ClickThrough></VideoClicks><MediaFiles><MediaFile delivery=\"progressive\" width=\"640\" height=\"360\" type=\"video/mp4\" scalable=\"true\" maintainAspectRatio=\"true\"><![CDATA[https://s3.amazonaws.com/files.prebid.org/creatives/PrebidLogo.mp4]]></MediaFile></MediaFiles></Linear></Creative></Creatives></InLine></Ad></VAST>';\n      bidResponse.renderer = Renderer.install({\n        url: 'https://cdn.jwplayer.com/libraries/l5MchIxB.js',\n      });\n      bidResponse.renderer.setRender(function (bid, doc) {\n        const parentId = getGptSlotInfoForAdUnitCode(bid.adUnitCode).divId ?? bid.adUnitCode;\n        const div = doc.createElement('div');\n        div.id = `${parentId}-video-player`;\n        doc.getElementById(parentId).appendChild(div);\n        const player = window.jwplayer(div.id).setup({\n          debug: true,\n          width: bidResponse.width,\n          height: bidResponse.height,\n          advertising: {\n            client: 'vast',\n            outstream: true,\n            endstate: 'close'\n          },\n        });\n        player.on('ready', async function () {\n          if (bid.vastUrl) {\n            player.loadAdTag(bid.vastUrl);\n          } else {\n            player.loadAdXml(bid.vastXml);\n          }\n        });\n      })\n    }\n  },\n  [NATIVE]: (bid, bidResponse) => {\n    if (!bidResponse.hasOwnProperty('native')) {\n      bidResponse.native = {\n        ortb: {\n          link: {\n            url: 'https://www.link.example',\n            clicktrackers: ['https://impression.example']\n          },\n          assets: bid.nativeOrtbRequest.assets.map(mapDefaultNativeOrtbAsset)\n        }\n      }\n    }\n  }\n}\n\nfunction mapDefaultNativeOrtbAsset(asset) {\n  const assetType = ORTB_NATIVE_ASSET_TYPES.find(type => asset.hasOwnProperty(type));\n  switch (assetType) {\n    case 'img':\n      return {\n        ...asset,\n        img: {\n          type: 3,\n          w: 600,\n          h: 500,\n          url: 'https://vcdn.adnxs.com/p/creative-image/27/c0/52/67/27c05267-5a6d-4874-834e-18e218493c32.png',\n        }\n      }\n    case 'video':\n      return {\n        ...asset,\n        video: {\n          vasttag: '<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><VAST version=\\\"3.0\\\"><Ad><InLine><AdSystem>GDFP</AdSystem><AdTitle>Demo</AdTitle><Description><![CDATA[Demo]]></Description><Creatives><Creative><Linear ><Duration>00:00:11</Duration><VideoClicks><ClickThrough><![CDATA[https://prebid.org/]]></ClickThrough></VideoClicks><MediaFiles><MediaFile delivery=\\\"progressive\\\" width=\\\"640\\\" height=\\\"360\\\" type=\\\"video/mp4\\\" scalable=\\\"true\\\" maintainAspectRatio=\\\"true\\\"><![CDATA[https://s3.amazonaws.com/files.prebid.org/creatives/PrebidLogo.mp4]]></MediaFile></MediaFiles></Linear></Creative></Creatives></InLine></Ad></VAST>'\n        }\n      }\n    case 'data': {\n      return {\n        ...asset,\n        data: {\n          value: '5 stars'\n        }\n      }\n    }\n    case 'title': {\n      return {\n        ...asset,\n        title: {\n          text: 'Prebid Native Example'\n        }\n      }\n    }\n  }\n}\n","import { loadExternalScript } from './adloader.js';\nimport {\n  logError, logWarn, logMessage\n} from './utils.js';\nimport {find} from './polyfill.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport { MODULE_TYPE_PREBID } from './activities/modules.js';\n\nconst pbjsInstance = getGlobal();\nconst moduleCode = 'outstream';\n\n/**\n * @typedef {object} Renderer\n *\n * A Renderer stores some functions which are used to render a particular Bid.\n * These are used in Outstream Video Bids, returned on the Bid by the adapter, and will\n * be used to render that bid unless the Publisher overrides them.\n */\n\nexport function Renderer(options) {\n  const { url, config, id, callback, loaded, adUnitCode, renderNow } = options;\n  this.url = url;\n  this.config = config;\n  this.handlers = {};\n  this.id = id;\n  this.renderNow = renderNow;\n  this.adUnitCode = adUnitCode;\n\n  // a renderer may push to the command queue to delay rendering until the\n  // render function is loaded by loadExternalScript, at which point the the command\n  // queue will be processed\n  this.loaded = loaded;\n  this.cmd = [];\n  this.push = func => {\n    if (typeof func !== 'function') {\n      logError('Commands given to Renderer.push must be wrapped in a function');\n      return;\n    }\n    this.loaded ? func.call() : this.cmd.push(func);\n  };\n\n  // bidders may override this with the `callback` property given to `install`\n  this.callback = callback || (() => {\n    this.loaded = true;\n    this.process();\n  });\n\n  // use a function, not an arrow, in order to be able to pass \"arguments\" through\n  this.render = function () {\n    const renderArgs = arguments\n    const runRender = () => {\n      if (this._render) {\n        this._render.apply(this, renderArgs)\n      } else {\n        logWarn(`No render function was provided, please use .setRender on the renderer`);\n      }\n    }\n\n    if (isRendererPreferredFromAdUnit(adUnitCode)) {\n      logWarn(`External Js not loaded by Renderer since renderer url and callback is already defined on adUnit ${adUnitCode}`);\n      runRender();\n    } else if (renderNow) {\n      runRender();\n    } else {\n      // we expect to load a renderer url once only so cache the request to load script\n      this.cmd.unshift(runRender) // should render run first ?\n      loadExternalScript(url, MODULE_TYPE_PREBID, moduleCode, this.callback, this.documentContext);\n    }\n  }.bind(this); // bind the function to this object to avoid 'this' errors\n}\n\nRenderer.install = function({ url, config, id, callback, loaded, adUnitCode, renderNow }) {\n  return new Renderer({ url, config, id, callback, loaded, adUnitCode, renderNow });\n};\n\nRenderer.prototype.getConfig = function() {\n  return this.config;\n};\n\nRenderer.prototype.setRender = function(fn) {\n  this._render = fn;\n};\n\nRenderer.prototype.setEventHandlers = function(handlers) {\n  this.handlers = handlers;\n};\n\nRenderer.prototype.handleVideoEvent = function({ id, eventName }) {\n  if (typeof this.handlers[eventName] === 'function') {\n    this.handlers[eventName]();\n  }\n\n  logMessage(`Prebid Renderer event for id ${id} type ${eventName}`);\n};\n\n/*\n * Calls functions that were pushed to the command queue before the\n * renderer was loaded by `loadExternalScript`\n */\nRenderer.prototype.process = function() {\n  while (this.cmd.length > 0) {\n    try {\n      this.cmd.shift().call();\n    } catch (error) {\n      logError(`Error processing Renderer command on ad unit '${this.adUnitCode}':`, error);\n    }\n  }\n};\n\n/**\n * Checks whether creative rendering should be done by Renderer or not.\n * @param {Object} renderer Renderer object installed by adapter\n * @returns {Boolean}\n */\nexport function isRendererRequired(renderer) {\n  return !!(renderer && (renderer.url || renderer.renderNow));\n}\n\n/**\n * Render the bid returned by the adapter\n * @param {Object} renderer Renderer object installed by adapter\n * @param {Object} bid Bid response\n * @param {Document} doc context document of bid\n */\nexport function executeRenderer(renderer, bid, doc) {\n  let docContext = null;\n  if (renderer.config && renderer.config.documentResolver) {\n    docContext = renderer.config.documentResolver(bid, document, doc);// a user provided callback, which should return a Document, and expect the parameters; bid, sourceDocument, renderDocument\n  }\n  if (!docContext) {\n    docContext = document;\n  }\n  renderer.documentContext = docContext;\n  renderer.render(bid, renderer.documentContext);\n}\n\nfunction isRendererPreferredFromAdUnit(adUnitCode) {\n  const adUnits = pbjsInstance.adUnits;\n  const adUnit = find(adUnits, adUnit => {\n    return adUnit.code === adUnitCode;\n  });\n\n  if (!adUnit) {\n    return false\n  }\n\n  // renderer defined at adUnit level\n  const adUnitRenderer = adUnit?.renderer;\n  const hasValidAdUnitRenderer = !!(adUnitRenderer && adUnitRenderer.url && adUnitRenderer.render);\n\n  // renderer defined at adUnit.mediaTypes level\n  const mediaTypeRenderer = adUnit?.mediaTypes?.video?.renderer;\n  const hasValidMediaTypeRenderer = !!(mediaTypeRenderer && mediaTypeRenderer.url && mediaTypeRenderer.render)\n\n  return !!(\n    (hasValidAdUnitRenderer && !(adUnitRenderer.backupOnly === true)) ||\n    (hasValidMediaTypeRenderer && !(mediaTypeRenderer.backupOnly === true))\n  );\n}\n","/**\n * Activity (that are relevant for privacy) definitions\n *\n * ref. https://docs.google.com/document/d/1dRxFUFmhh2jGanzGZvfkK_6jtHPpHXWD7Qsi6KEugeE\n * & https://github.com/prebid/Prebid.js/issues/9546\n */\n\n/**\n * accessDevice: some component wants to read or write to localStorage or cookies.\n */\nexport const ACTIVITY_ACCESS_DEVICE = 'accessDevice';\n/**\n * syncUser: A bid adapter wants to run a user sync.\n */\nexport const ACTIVITY_SYNC_USER = 'syncUser';\n/**\n * enrichUfpd: some component wants to add user first-party data to bid requests.\n */\nexport const ACTIVITY_ENRICH_UFPD = 'enrichUfpd';\n/**\n * enrichEids: some component wants to add user IDs to bid requests.\n */\nexport const ACTIVITY_ENRICH_EIDS = 'enrichEids';\n/**\n * fetchBid: a bidder wants to bid.\n */\nexport const ACTIVITY_FETCH_BIDS = 'fetchBids';\n\n/**\n * reportAnalytics: some component wants to phone home with analytics data.\n */\nexport const ACTIVITY_REPORT_ANALYTICS = 'reportAnalytics';\n\n/**\n * some component wants access to (and send along) user IDs\n */\nexport const ACTIVITY_TRANSMIT_EIDS = 'transmitEids'\n\n/**\n * transmitUfpd: some component wants access to (and send along) user FPD\n */\nexport const ACTIVITY_TRANSMIT_UFPD = 'transmitUfpd';\n\n/**\n * transmitPreciseGeo: some component wants access to (and send along) geolocation info\n */\nexport const ACTIVITY_TRANSMIT_PRECISE_GEO = 'transmitPreciseGeo';\n\n/**\n * transmit TID: some component wants access ot (and send along) transaction IDs\n */\nexport const ACTIVITY_TRANSMIT_TID = 'transmitTid';\n\n/**\n * loadExternalScript: adLoader.js is allowed to load external script\n */\nexport const LOAD_EXTERNAL_SCRIPT = 'loadExternalScript';\n","import adapterManager from '../adapterManager.js';\nimport {activityParamsBuilder} from './params.js';\n\n/**\n * Utility function for building common activity parameters - broken out to its own\n * file to avoid circular imports.\n */\nexport const activityParams = activityParamsBuilder((alias) => adapterManager.resolveAlias(alias));\n","export const MODULE_TYPE_PREBID = 'prebid';\nexport const MODULE_TYPE_BIDDER = 'bidder';\nexport const MODULE_TYPE_UID = 'userId';\nexport const MODULE_TYPE_RTD = 'rtd';\nexport const MODULE_TYPE_ANALYTICS = 'analytics';\n","import {MODULE_TYPE_BIDDER} from './modules.js';\nimport {hook} from '../hook.js';\n\n/**\n * Component ID - who is trying to perform the activity?\n * Relevant for all activities.\n */\nexport const ACTIVITY_PARAM_COMPONENT = 'component';\nexport const ACTIVITY_PARAM_COMPONENT_TYPE = ACTIVITY_PARAM_COMPONENT + 'Type';\nexport const ACTIVITY_PARAM_COMPONENT_NAME = ACTIVITY_PARAM_COMPONENT + 'Name';\n\n/**\n * Code of the bid adapter that `componentName` is an alias of.\n * May be the same as the component name.\n *\n * relevant for all activities, but only when componentType is 'bidder'.\n */\nexport const ACTIVITY_PARAM_ADAPTER_CODE = 'adapterCode';\n\n/**\n * Storage type - either 'html5' or 'cookie'.\n * Relevant for: accessDevice\n */\nexport const ACTIVITY_PARAM_STORAGE_TYPE = 'storageType';\n\n/**\n * s2sConfig[].configName, used to identify a particular s2s instance\n * relevant for: fetchBids, but only when component is 'prebid.pbsBidAdapter'\n */\nexport const ACTIVITY_PARAM_S2S_NAME = 'configName';\n/**\n * user sync type - 'iframe' or 'pixel'\n * relevant for: syncUser\n */\nexport const ACTIVITY_PARAM_SYNC_TYPE = 'syncType'\n/**\n * user sync URL\n * relevant for: syncUser\n */\nexport const ACTIVITY_PARAM_SYNC_URL = 'syncUrl';\n/**\n * Configuration options for analytics adapter - the argument passed to `enableAnalytics`.\n * Relevant for: reportAnalytics\n * @private\n * @constant\n * @type {string}\n */\nexport const ACTIVITY_PARAM_ANL_CONFIG = '_config';\n\nexport function activityParamsBuilder(resolveAlias) {\n  return function activityParams(moduleType, moduleName, params) {\n    const defaults = {\n      [ACTIVITY_PARAM_COMPONENT_TYPE]: moduleType,\n      [ACTIVITY_PARAM_COMPONENT_NAME]: moduleName,\n      [ACTIVITY_PARAM_COMPONENT]: `${moduleType}.${moduleName}`\n    };\n    if (moduleType === MODULE_TYPE_BIDDER) {\n      defaults[ACTIVITY_PARAM_ADAPTER_CODE] = resolveAlias(moduleName);\n    }\n    return buildActivityParams(Object.assign(defaults, params));\n  }\n}\n\nexport const buildActivityParams = hook('sync', params => params);\n","import {deepAccess} from '../utils.js';\nimport {config} from '../config.js';\nimport {isActivityAllowed, registerActivityControl} from './rules.js';\nimport {\n  ACTIVITY_TRANSMIT_EIDS,\n  ACTIVITY_TRANSMIT_PRECISE_GEO,\n  ACTIVITY_TRANSMIT_TID,\n  ACTIVITY_TRANSMIT_UFPD\n} from './activities.js';\nimport { scrubIPv4, scrubIPv6 } from '../utils/ipUtils.js';\n\nexport const ORTB_UFPD_PATHS = [\n  'data',\n  'ext.data',\n  'yob',\n  'gender',\n  'keywords',\n  'kwarray',\n  'id',\n  'buyeruid',\n  'customdata'\n].map(f => `user.${f}`).concat('device.ext.cdep');\nexport const ORTB_EIDS_PATHS = ['user.eids', 'user.ext.eids'];\nexport const ORTB_GEO_PATHS = ['user.geo.lat', 'user.geo.lon', 'device.geo.lat', 'device.geo.lon'];\nexport const ORTB_IPV4_PATHS = ['device.ip']\nexport const ORTB_IPV6_PATHS = ['device.ipv6']\n\n/**\n * @typedef TransformationRuleDef\n * @property {name}\n * @property {Array[string]} paths dot-separated list of paths that this rule applies to.\n * @property {function(*): boolean} applies a predicate that should return true if this rule applies\n * (and the transformation defined herein should be applied). The arguments are those passed to the transformation function.\n * @property {name} a name for the rule; used to debounce calls to `applies` (and avoid excessive logging):\n * if a rule with the same name was already found to apply (or not), this one will (or won't) as well.\n */\n\n/**\n * @typedef RedactRuleDef A rule that removes, or replaces, values from an object (modifications are done in-place).\n * @augments TransformationRuleDef\n * @property {function(*): *} get? substitution functions for values that should be redacted;\n *  takes in the original (unredacted) value as an input, and returns a substitute to use in the redacted\n *  version. If it returns undefined, or this option is omitted, protected paths will be removed\n *  from the redacted object.\n */\n\n/**\n * @param {RedactRuleDef} ruleDef\n * @return {TransformationRule}\n */\nexport function redactRule(ruleDef) {\n  return Object.assign({\n    get() {},\n    run(root, path, object, property, applies) {\n      const val = object && object[property];\n      if (isData(val) && applies()) {\n        const repl = this.get(val);\n        if (repl === undefined) {\n          delete object[property];\n        } else {\n          object[property] = repl;\n        }\n      }\n    }\n  }, ruleDef)\n}\n\n/**\n * @typedef TransformationRule\n * @augments TransformationRuleDef\n * @property {function} run rule logic - see `redactRule` for an example.\n */\n\n/**\n * @typedef {Function} TransformationFunction\n * @param object object to transform\n * @param ...args arguments to pass down to rule's `apply` methods.\n */\n\n/**\n * Return a transformation function that will apply the given rules to an object.\n *\n * @param {Array[TransformationRule]} rules\n * @return {TransformationFunction}\n */\nexport function objectTransformer(rules) {\n  rules.forEach(rule => {\n    rule.paths = rule.paths.map((path) => {\n      const parts = path.split('.');\n      const tail = parts.pop();\n      return [parts.length > 0 ? parts.join('.') : null, tail]\n    })\n  })\n  return function applyTransform(session, obj, ...args) {\n    const result = [];\n    const applies = sessionedApplies(session, ...args);\n    rules.forEach(rule => {\n      if (session[rule.name] === false) return;\n      for (const [head, tail] of rule.paths) {\n        const parent = head == null ? obj : deepAccess(obj, head);\n        result.push(rule.run(obj, head, parent, tail, applies.bind(null, rule)));\n        if (session[rule.name] === false) return;\n      }\n    })\n    return result.filter(el => el != null);\n  }\n}\n\nexport function sessionedApplies(session, ...args) {\n  return function applies(rule) {\n    if (!session.hasOwnProperty(rule.name)) {\n      session[rule.name] = !!rule.applies(...args);\n    }\n    return session[rule.name];\n  }\n}\n\nexport function isData(val) {\n  return val != null && (typeof val !== 'object' || Object.keys(val).length > 0)\n}\n\nexport function appliesWhenActivityDenied(activity, isAllowed = isActivityAllowed) {\n  return function applies(params) {\n    return !isAllowed(activity, params);\n  };\n}\n\nfunction bidRequestTransmitRules(isAllowed = isActivityAllowed) {\n  return [\n    {\n      name: ACTIVITY_TRANSMIT_EIDS,\n      paths: ['userId', 'userIdAsEids'],\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_EIDS, isAllowed),\n    },\n    {\n      name: ACTIVITY_TRANSMIT_TID,\n      paths: ['ortb2Imp.ext.tid'],\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_TID, isAllowed)\n    }\n  ].map(redactRule)\n}\n\nexport function ortb2TransmitRules(isAllowed = isActivityAllowed) {\n  return [\n    {\n      name: ACTIVITY_TRANSMIT_UFPD,\n      paths: ORTB_UFPD_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_UFPD, isAllowed),\n    },\n    {\n      name: ACTIVITY_TRANSMIT_EIDS,\n      paths: ORTB_EIDS_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_EIDS, isAllowed),\n    },\n    {\n      name: ACTIVITY_TRANSMIT_PRECISE_GEO,\n      paths: ORTB_GEO_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_PRECISE_GEO, isAllowed),\n      get(val) {\n        return Math.round((val + Number.EPSILON) * 100) / 100;\n      }\n    },\n    {\n      name: ACTIVITY_TRANSMIT_PRECISE_GEO,\n      paths: ORTB_IPV4_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_PRECISE_GEO, isAllowed),\n      get(val) {\n        return scrubIPv4(val);\n      }\n    },\n    {\n      name: ACTIVITY_TRANSMIT_PRECISE_GEO,\n      paths: ORTB_IPV6_PATHS,\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_PRECISE_GEO, isAllowed),\n      get(val) {\n        return scrubIPv6(val);\n      }\n    },\n    {\n      name: ACTIVITY_TRANSMIT_TID,\n      paths: ['source.tid'],\n      applies: appliesWhenActivityDenied(ACTIVITY_TRANSMIT_TID, isAllowed),\n    }\n  ].map(redactRule);\n}\n\nexport function redactorFactory(isAllowed = isActivityAllowed) {\n  const redactOrtb2 = objectTransformer(ortb2TransmitRules(isAllowed));\n  const redactBidRequest = objectTransformer(bidRequestTransmitRules(isAllowed));\n  return function redactor(params) {\n    const session = {};\n    return {\n      ortb2(obj) { redactOrtb2(session, obj, params); return obj },\n      bidRequest(obj) { redactBidRequest(session, obj, params); return obj }\n    }\n  }\n}\n\n/**\n * Returns an object that can redact other privacy-sensitive objects according\n * to activity rules.\n *\n * @param {{}} params activity parameters to use for activity checks\n * @return {{ortb2: function({}): {}, bidRequest: function({}): {}}} methods\n *  that can redact disallowed data from ORTB2 and/or bid request objects.\n */\nexport const redactor = redactorFactory();\n\n// by default, TIDs are off since version 8\nregisterActivityControl(ACTIVITY_TRANSMIT_TID, 'enableTIDs config', () => {\n  if (!config.getConfig('enableTIDs')) {\n    return {allow: false, reason: 'TIDs are disabled'}\n  }\n});\n","import {prefixLog} from '../utils.js';\nimport {ACTIVITY_PARAM_COMPONENT} from './params.js';\n\nexport function ruleRegistry(logger = prefixLog('Activity control:')) {\n  const registry = {};\n\n  function getRules(activity) {\n    return registry[activity] = registry[activity] || [];\n  }\n\n  function runRule(activity, name, rule, params) {\n    let res;\n    try {\n      res = rule(params);\n    } catch (e) {\n      logger.logError(`Exception in rule ${name} for '${activity}'`, e);\n      res = {allow: false, reason: e};\n    }\n    return res && Object.assign({activity, name, component: params[ACTIVITY_PARAM_COMPONENT]}, res);\n  }\n\n  const dupes = {};\n  const DEDUPE_INTERVAL = 1000;\n\n  function logResult({activity, name, allow, reason, component}) {\n    const msg = `${name} ${allow ? 'allowed' : 'denied'} '${activity}' for '${component}'${reason ? ':' : ''}`;\n    const deduping = dupes.hasOwnProperty(msg);\n    if (deduping) {\n      clearTimeout(dupes[msg]);\n    }\n    dupes[msg] = setTimeout(() => delete dupes[msg], DEDUPE_INTERVAL);\n    if (!deduping) {\n      const parts = [msg];\n      reason && parts.push(reason);\n      (allow ? logger.logInfo : logger.logWarn).apply(logger, parts);\n    }\n  }\n\n  return [\n    /**\n     * Register an activity control rule.\n     *\n     * @param {string} activity - Activity name, as defined in `activities.js`.\n     * @param {string} ruleName - A name for this rule, used for logging.\n     * @param {function(Object): {allow: boolean, reason?: string}} rule - Rule definition function. Takes in activity\n     *        parameters as a single map; MAY return an object {allow, reason}, where allow is true/false,\n     *        and reason is an optional message used for logging.\n     *\n     *        {allow: true} will allow this activity AS LONG AS no other rules with the same or higher priority return {allow: false};\n     *        {allow: false} will deny this activity AS LONG AS no other rules with higher priority return {allow: true};\n     *        Returning null/undefined has no effect - the decision is left to other rules.\n     *        If no rule returns an allow value, the default is to allow the activity.\n     *\n     * @param {number} [priority=10] - Rule priority; lower number means higher priority.\n     * @returns {function(): void} - A function that unregisters the rule when called.\n     */\n    function registerActivityControl(activity, ruleName, rule, priority = 10) {\n      const rules = getRules(activity);\n      const pos = rules.findIndex(([itemPriority]) => priority < itemPriority);\n      const entry = [priority, ruleName, rule];\n      rules.splice(pos < 0 ? rules.length : pos, 0, entry);\n      return function () {\n        const idx = rules.indexOf(entry);\n        if (idx >= 0) rules.splice(idx, 1);\n      }\n    },\n    /**\n     * Test whether an activity is allowed.\n     *\n     * @param {string} activity activity name\n     * @param {{}} params activity parameters; should be generated through the `activityParams` utility.\n     * @return {boolean} true for allow, false for deny.\n     */\n    function isActivityAllowed(activity, params) {\n      let lastPriority, foundAllow;\n      for (const [priority, name, rule] of getRules(activity)) {\n        if (lastPriority !== priority && foundAllow) break;\n        lastPriority = priority;\n        const ruleResult = runRule(activity, name, rule, params);\n        if (ruleResult) {\n          if (!ruleResult.allow) {\n            logResult(ruleResult);\n            return false;\n          } else {\n            foundAllow = ruleResult;\n          }\n        }\n      }\n      foundAllow && logResult(foundAllow);\n      return true;\n    }\n  ];\n}\n\nexport const [registerActivityControl, isActivityAllowed] = ruleRegistry();\n","import {\n  createIframe,\n  createInvisibleIframe,\n  inIframe,\n  insertElement,\n  logError,\n  logWarn,\n  replaceMacros, triggerPixel\n} from './utils.js';\nimport * as events from './events.js';\nimport {AD_RENDER_FAILED_REASON, BID_STATUS, EVENTS, MESSAGES, PB_LOCATOR} from './constants.js';\nimport {config} from './config.js';\nimport {executeRenderer, isRendererRequired} from './Renderer.js';\nimport {VIDEO} from './mediaTypes.js';\nimport {auctionManager} from './auctionManager.js';\nimport {getCreativeRenderer} from './creativeRenderers.js';\nimport {hook} from './hook.js';\nimport {fireNativeTrackers} from './native.js';\nimport {PbPromise} from './utils/promise.js';\nimport adapterManager from './adapterManager.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {filters} from './targeting.js';\nimport {EVENT_TYPE_WIN, parseEventTrackers, TRACKER_METHOD_IMG} from './eventTrackers.js';\n\nconst { AD_RENDER_FAILED, AD_RENDER_SUCCEEDED, STALE_RENDER, BID_WON, EXPIRED_RENDER } = EVENTS;\nconst { EXCEPTION } = AD_RENDER_FAILED_REASON;\n\nexport const getBidToRender = hook('sync', function (adId, forRender = true, override = PbPromise.resolve()) {\n  return override\n    .then(bid => bid ?? auctionManager.findBidByAdId(adId))\n    .catch(() => {})\n})\n\nexport const markWinningBid = hook('sync', function (bid) {\n  (parseEventTrackers(bid.eventtrackers)[EVENT_TYPE_WIN]?.[TRACKER_METHOD_IMG] || [])\n    .forEach(url => triggerPixel(url));\n  events.emit(BID_WON, bid);\n  auctionManager.addWinningBid(bid);\n})\n\n/**\n * Emit the AD_RENDER_FAILED event.\n *\n * @param {Object} data\n * @param data.reason one of the values in AD_RENDER_FAILED_REASON\n * @param data.message failure description\n * @param [data.bid] bid response object that failed to render\n * @param [data.id] adId that failed to render\n */\nexport function emitAdRenderFail({ reason, message, bid, id }) {\n  const data = { reason, message };\n  if (bid) {\n    data.bid = bid;\n    data.adId = bid.adId;\n  }\n  if (id) data.adId = id;\n\n  logError(`Error rendering ad (id: ${id}): ${message}`);\n  events.emit(AD_RENDER_FAILED, data);\n}\n\n/**\n * Emit the AD_RENDER_SUCCEEDED event.\n * (Note: Invocation of this function indicates that the render function did not generate an error, it does not guarantee that tracking for this event has occurred yet.)\n * @param {Object} data\n * @param data.doc document object that was used to `.write` the ad. Should be `null` if unavailable (e.g. for documents in\n * a cross-origin frame).\n * @param [data.bid] bid response object for the ad that was rendered\n * @param [data.id] adId that was rendered.\n */\nexport function emitAdRenderSucceeded({ doc, bid, id }) {\n  const data = { doc };\n  if (bid) data.bid = bid;\n  if (id) data.adId = id;\n\n  adapterManager.callAdRenderSucceededBidder(bid.adapterCode || bid.bidder, bid);\n\n  events.emit(AD_RENDER_SUCCEEDED, data);\n}\n\nexport function handleCreativeEvent(data, bidResponse) {\n  switch (data.event) {\n    case EVENTS.AD_RENDER_FAILED:\n      emitAdRenderFail({\n        bid: bidResponse,\n        id: bidResponse.adId,\n        reason: data.info.reason,\n        message: data.info.message\n      });\n      break;\n    case EVENTS.AD_RENDER_SUCCEEDED:\n      emitAdRenderSucceeded({\n        doc: null,\n        bid: bidResponse,\n        id: bidResponse.adId\n      });\n      break;\n    default:\n      logError(`Received event request for unsupported event: '${data.event}' (adId: '${bidResponse.adId}')`);\n  }\n}\n\nexport function handleNativeMessage(data, bidResponse, {resizeFn, fireTrackers = fireNativeTrackers}) {\n  switch (data.action) {\n    case 'resizeNativeHeight':\n      resizeFn(data.width, data.height);\n      break;\n    default:\n      fireTrackers(data, bidResponse);\n  }\n}\n\nconst HANDLERS = {\n  [MESSAGES.EVENT]: handleCreativeEvent\n}\n\nif (FEATURES.NATIVE) {\n  HANDLERS[MESSAGES.NATIVE] = handleNativeMessage;\n}\n\nfunction creativeMessageHandler(deps) {\n  return function (type, data, bidResponse) {\n    if (HANDLERS.hasOwnProperty(type)) {\n      HANDLERS[type](data, bidResponse, deps);\n    }\n  }\n}\n\nexport const getRenderingData = hook('sync', function (bidResponse, options) {\n  const {ad, adUrl, cpm, originalCpm, width, height, instl} = bidResponse\n  const repl = {\n    AUCTION_PRICE: originalCpm || cpm,\n    CLICKTHROUGH: options?.clickUrl || ''\n  }\n  return {\n    ad: replaceMacros(ad, repl),\n    adUrl: replaceMacros(adUrl, repl),\n    width,\n    height,\n    instl\n  };\n})\n\nexport const doRender = hook('sync', function({renderFn, resizeFn, bidResponse, options, doc, isMainDocument = doc === document && !inIframe()}) {\n  const videoBid = (FEATURES.VIDEO && bidResponse.mediaType === VIDEO)\n  if (isMainDocument || videoBid) {\n    emitAdRenderFail({\n      reason: AD_RENDER_FAILED_REASON.PREVENT_WRITING_ON_MAIN_DOCUMENT,\n      message: videoBid ? 'Cannot render video ad without a renderer' : `renderAd was prevented from writing to the main document.`,\n      bid: bidResponse,\n      id: bidResponse.adId\n    });\n    return;\n  }\n  const data = getRenderingData(bidResponse, options);\n  renderFn(Object.assign({adId: bidResponse.adId}, data));\n  const {width, height} = data;\n  if ((width ?? height) != null) {\n    resizeFn(width, height);\n  }\n});\n\ndoRender.before(function (next, args) {\n  // run renderers from a high priority hook to allow the video module to insert itself between this and \"normal\" rendering.\n  const {bidResponse, doc} = args;\n  if (isRendererRequired(bidResponse.renderer)) {\n    executeRenderer(bidResponse.renderer, bidResponse, doc);\n    emitAdRenderSucceeded({doc, bid: bidResponse, id: bidResponse.adId})\n    next.bail();\n  } else {\n    next(args);\n  }\n}, 100)\n\nexport function handleRender({renderFn, resizeFn, adId, options, bidResponse, doc}) {\n  deferRendering(bidResponse, () => {\n    if (bidResponse == null) {\n      emitAdRenderFail({\n        reason: AD_RENDER_FAILED_REASON.CANNOT_FIND_AD,\n        message: `Cannot find ad '${adId}'`,\n        id: adId\n      });\n      return;\n    }\n    if (bidResponse.status === BID_STATUS.RENDERED) {\n      logWarn(`Ad id ${adId} has been rendered before`);\n      events.emit(STALE_RENDER, bidResponse);\n      if (config.getConfig('auctionOptions')?.suppressStaleRender) {\n        return;\n      }\n    }\n    if (!filters.isBidNotExpired(bidResponse)) {\n      logWarn(`Ad id ${adId} has been expired`);\n      events.emit(EXPIRED_RENDER, bidResponse);\n      if (config.getConfig('auctionOptions')?.suppressExpiredRender) {\n        return;\n      }\n    }\n\n    try {\n      doRender({renderFn, resizeFn, bidResponse, options, doc});\n    } catch (e) {\n      emitAdRenderFail({\n        reason: AD_RENDER_FAILED_REASON.EXCEPTION,\n        message: e.message,\n        id: adId,\n        bid: bidResponse\n      });\n    }\n  })\n}\n\nexport function markBidAsRendered(bidResponse) {\n  const metrics = useMetrics(bidResponse.metrics);\n  metrics.checkpoint('bidRender');\n  metrics.timeBetween('bidWon', 'bidRender', 'render.deferred');\n  metrics.timeBetween('auctionEnd', 'bidRender', 'render.pending');\n  metrics.timeBetween('requestBids', 'bidRender', 'render.e2e');\n  bidResponse.status = BID_STATUS.RENDERED;\n}\n\nconst DEFERRED_RENDER = new WeakMap();\nconst WINNERS = new WeakSet();\n\nexport function deferRendering(bidResponse, renderFn) {\n  if (bidResponse == null) {\n    // if the bid is missing, let renderFn deal with it now\n    renderFn();\n    return;\n  }\n  DEFERRED_RENDER.set(bidResponse, renderFn);\n  if (!bidResponse.deferRendering) {\n    renderIfDeferred(bidResponse);\n  }\n  markWinner(bidResponse);\n}\n\nexport function markWinner(bidResponse) {\n  if (!WINNERS.has(bidResponse)) {\n    WINNERS.add(bidResponse);\n    markWinningBid(bidResponse);\n  }\n}\n\nexport function renderIfDeferred(bidResponse) {\n  const renderFn = DEFERRED_RENDER.get(bidResponse);\n  if (renderFn) {\n    renderFn();\n    markBidAsRendered(bidResponse);\n    DEFERRED_RENDER.delete(bidResponse);\n  }\n}\n\nexport function renderAdDirect(doc, adId, options) {\n  let bid;\n  function fail(reason, message) {\n    emitAdRenderFail(Object.assign({id: adId, bid}, {reason, message}));\n  }\n  function resizeFn(width, height) {\n    const frame = doc.defaultView?.frameElement;\n    if (frame) {\n      if (width) {\n        frame.width = width;\n        frame.style.width && (frame.style.width = `${width}px`);\n      }\n      if (height) {\n        frame.height = height;\n        frame.style.height && (frame.style.height = `${height}px`);\n      }\n    }\n  }\n  const messageHandler = creativeMessageHandler({resizeFn});\n  function renderFn(adData) {\n    if (adData.ad) {\n      doc.write(adData.ad);\n      doc.close();\n      emitAdRenderSucceeded({doc, bid, id: bid.adId});\n    } else {\n      getCreativeRenderer(bid)\n        .then(render => render(adData, {\n          sendMessage: (type, data) => messageHandler(type, data, bid),\n          mkFrame: createIframe,\n        }, doc.defaultView))\n        .then(\n          () => emitAdRenderSucceeded({doc, bid, id: bid.adId}),\n          (e) => {\n            fail(e?.reason || AD_RENDER_FAILED_REASON.EXCEPTION, e?.message)\n            e?.stack && logError(e);\n          }\n        );\n    }\n    // TODO: this is almost certainly the wrong way to do this\n    const creativeComment = document.createComment(`Creative ${bid.creativeId} served by ${bid.bidder} Prebid.js Header Bidding`);\n    insertElement(creativeComment, doc, 'html');\n  }\n  try {\n    if (!adId || !doc) {\n      fail(AD_RENDER_FAILED_REASON.MISSING_DOC_OR_ADID, `missing ${adId ? 'doc' : 'adId'}`);\n    } else {\n      getBidToRender(adId).then(bidResponse => {\n        bid = bidResponse;\n        handleRender({renderFn, resizeFn, adId, options: {clickUrl: options?.clickThrough}, bidResponse, doc});\n      });\n    }\n  } catch (e) {\n    fail(EXCEPTION, e.message);\n  }\n}\n\n/**\n * Insert an invisible, named iframe that can be used by creatives to locate the window Prebid is running in\n * (by looking for one that has `.frames[PB_LOCATOR]` defined).\n * This is necessary because in some situations creatives may be rendered inside nested iframes - Prebid is not necessarily\n * in the immediate parent window.\n */\nexport function insertLocatorFrame() {\n  if (!window.frames[PB_LOCATOR]) {\n    if (!document.body) {\n      window.requestAnimationFrame(insertLocatorFrame);\n    } else {\n      const frame = createInvisibleIframe();\n      frame.name = PB_LOCATOR;\n      document.body.appendChild(frame);\n    }\n  }\n}\n","let adUnits = {};\nexport function reset() {\n  adUnits = {}\n}\n\nfunction ensureAdUnit(adunit, bidderCode) {\n  let adUnit = adUnits[adunit] = adUnits[adunit] || { bidders: {} };\n  if (bidderCode) {\n    return adUnit.bidders[bidderCode] = adUnit.bidders[bidderCode] || {}\n  }\n  return adUnit;\n}\n\nfunction incrementAdUnitCount(adunit, counter, bidderCode) {\n  let adUnit = ensureAdUnit(adunit, bidderCode);\n  adUnit[counter] = (adUnit[counter] || 0) + 1;\n  return adUnit[counter];\n}\n\n/**\n * Increments and returns current Adunit counter\n * @param {string} adunit id\n * @returns {number} current adunit count\n */\nexport function incrementRequestsCounter(adunit) {\n  return incrementAdUnitCount(adunit, 'requestsCounter');\n}\n\n/**\n * Increments and returns current Adunit requests counter for a bidder\n * @param {string} adunit id\n * @param {string} bidderCode code\n * @returns {number} current adunit bidder requests count\n */\nexport function incrementBidderRequestsCounter(adunit, bidderCode) {\n  return incrementAdUnitCount(adunit, 'requestsCounter', bidderCode);\n}\n\n/**\n * Increments and returns current Adunit wins counter for a bidder\n * @param {string} adunit id\n * @param {string} bidderCode code\n * @returns {number} current adunit bidder requests count\n */\nexport function incrementBidderWinsCounter(adunit, bidderCode) {\n  return incrementAdUnitCount(adunit, 'winsCounter', bidderCode);\n}\n\n/**\n * Increments and returns current Adunit auctions counter\n * @param {string} adunit id\n * @returns {number} current adunit auctions count\n */\nexport function incrementAuctionsCounter(adunit) {\n  return incrementAdUnitCount(adunit, 'auctionsCounter');\n}\n\n/**\n * Returns current Adunit counter\n * @param {string} adunit id\n * @returns {number} current adunit count\n */\nexport function getRequestsCounter(adunit) {\n  return adUnits?.[adunit]?.requestsCounter || 0;\n}\n\n/**\n * Returns current Adunit requests counter for a specific bidder code\n * @param {string} adunit id\n * @param {string} bidder code\n * @returns {number} current adunit bidder requests count\n */\nexport function getBidderRequestsCounter(adunit, bidder) {\n  return adUnits?.[adunit]?.bidders?.[bidder]?.requestsCounter || 0;\n}\n\n/**\n * Returns current Adunit requests counter for a specific bidder code\n * @param {string} adunit id\n * @param {string} bidder code\n * @returns {number} current adunit bidder requests count\n */\nexport function getBidderWinsCounter(adunit, bidder) {\n  return adUnits?.[adunit]?.bidders?.[bidder]?.winsCounter || 0;\n}\n\n/**\n * Returns current Adunit auctions counter\n * @param {string} adunit id\n * @returns {number} current adunit auctions count\n */\nexport function getAuctionsCounter(adunit) {\n  return adUnits?.[adunit]?.auctionsCounter || 0;\n}\n","export default function Adapter(code) {\n  var bidderCode = code;\n\n  function setBidderCode(code) {\n    bidderCode = code;\n  }\n\n  function getBidderCode() {\n    return bidderCode;\n  }\n\n  function callBids() {\n  }\n\n  return {\n    callBids: callBids,\n    setBidderCode: setBidderCode,\n    getBidderCode: getBidderCode\n  };\n}\n","/** @module adaptermanger */\n\nimport {\n  deepClone,\n  flatten,\n  generateUUID,\n  getBidderCodes,\n  getDefinedParams,\n  getUniqueIdentifierStr,\n  getUserConfiguredParams,\n  groupBy,\n  internal,\n  isArray,\n  isPlainObject,\n  isValidMediaTypes,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  mergeDeep,\n  shuffle,\n  timestamp,\n  uniques,\n} from './utils.js';\nimport {decorateAdUnitsWithNativeParams, nativeAdapters} from './native.js';\nimport {newBidder} from './adapters/bidderFactory.js';\nimport {ajaxBuilder} from './ajax.js';\nimport {config, RANDOM} from './config.js';\nimport {hook} from './hook.js';\nimport {find, includes} from './polyfill.js';\nimport {\n  getAuctionsCounter,\n  getBidderRequestsCounter,\n  getBidderWinsCounter,\n  getRequestsCounter,\n  incrementAuctionsCounter,\n  incrementBidderRequestsCounter,\n  incrementBidderWinsCounter,\n  incrementRequestsCounter\n} from './adUnits.js';\nimport {getRefererInfo} from './refererDetection.js';\nimport {GDPR_GVLIDS, gdprDataHandler, gppDataHandler, uspDataHandler, } from './consentHandler.js';\nimport * as events from './events.js';\nimport {EVENTS, S2S} from './constants.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {auctionManager} from './auctionManager.js';\nimport {MODULE_TYPE_ANALYTICS, MODULE_TYPE_BIDDER, MODULE_TYPE_PREBID} from './activities/modules.js';\nimport {isActivityAllowed} from './activities/rules.js';\nimport {ACTIVITY_FETCH_BIDS, ACTIVITY_REPORT_ANALYTICS} from './activities/activities.js';\nimport {ACTIVITY_PARAM_ANL_CONFIG, ACTIVITY_PARAM_S2S_NAME, activityParamsBuilder} from './activities/params.js';\nimport {redactor} from './activities/redactor.js';\nimport {EVENT_TYPE_IMPRESSION, parseEventTrackers, TRACKER_METHOD_IMG} from './eventTrackers.js';\n\nexport {gdprDataHandler, gppDataHandler, uspDataHandler, coppaDataHandler} from './consentHandler.js';\n\nexport const PBS_ADAPTER_NAME = 'pbsBidAdapter';\nexport const PARTITIONS = {\n  CLIENT: 'client',\n  SERVER: 'server'\n}\n\nexport const dep = {\n  isAllowed: isActivityAllowed,\n  redact: redactor\n}\n\nlet adapterManager = {};\n\nlet _bidderRegistry = adapterManager.bidderRegistry = {};\nlet _aliasRegistry = adapterManager.aliasRegistry = {};\n\nlet _s2sConfigs = [];\nconfig.getConfig('s2sConfig', config => {\n  if (config && config.s2sConfig) {\n    _s2sConfigs = isArray(config.s2sConfig) ? config.s2sConfig : [config.s2sConfig];\n  }\n});\n\nvar _analyticsRegistry = {};\n\nconst activityParams = activityParamsBuilder((alias) => adapterManager.resolveAlias(alias));\n\nexport function s2sActivityParams(s2sConfig) {\n  return activityParams(MODULE_TYPE_PREBID, PBS_ADAPTER_NAME, {\n    [ACTIVITY_PARAM_S2S_NAME]: s2sConfig.configName\n  });\n}\n\n/**\n * @typedef {object} LabelDescriptor\n * @property {boolean} labelAll describes whether or not this object expects all labels to match, or any label to match\n * @property {Array<string>} labels the labels listed on the bidder or adUnit\n * @property {Array<string>} activeLabels the labels specified as being active by requestBids\n */\n\nfunction getBids({bidderCode, auctionId, bidderRequestId, adUnits, src, metrics}) {\n  return adUnits.reduce((result, adUnit) => {\n    const bids = adUnit.bids.filter(bid => bid.bidder === bidderCode);\n    if (bidderCode == null && bids.length === 0 && adUnit.s2sBid != null) {\n      bids.push({bidder: null});\n    }\n    result.push(\n      bids.reduce((bids, bid) => {\n        bid = Object.assign({}, bid,\n          {ortb2Imp: mergeDeep({}, adUnit.ortb2Imp, bid.ortb2Imp)},\n          getDefinedParams(adUnit, [\n            'nativeParams',\n            'nativeOrtbRequest',\n            'mediaType',\n            'renderer'\n          ])\n        );\n\n        const mediaTypes = bid.mediaTypes == null ? adUnit.mediaTypes : bid.mediaTypes\n\n        if (isValidMediaTypes(mediaTypes)) {\n          bid = Object.assign({}, bid, {\n            mediaTypes\n          });\n        } else {\n          logError(\n            `mediaTypes is not correctly configured for adunit ${adUnit.code}`\n          );\n        }\n\n        if (src === 'client') {\n          incrementBidderRequestsCounter(adUnit.code, bidderCode);\n        }\n\n        bids.push(Object.assign({}, bid, {\n          adUnitCode: adUnit.code,\n          transactionId: adUnit.transactionId,\n          adUnitId: adUnit.adUnitId,\n          sizes: mediaTypes?.banner?.sizes || mediaTypes?.video?.playerSize || [],\n          bidId: bid.bid_id || getUniqueIdentifierStr(),\n          bidderRequestId,\n          auctionId,\n          src,\n          metrics,\n          auctionsCount: getAuctionsCounter(adUnit.code),\n          bidRequestsCount: getRequestsCounter(adUnit.code),\n          bidderRequestsCount: getBidderRequestsCounter(adUnit.code, bid.bidder),\n          bidderWinsCount: getBidderWinsCounter(adUnit.code, bid.bidder),\n          deferBilling: !!adUnit.deferBilling\n        }));\n        return bids;\n      }, [])\n    );\n    return result;\n  }, []).reduce(flatten, []).filter(val => val !== '');\n}\n\nconst hookedGetBids = hook('sync', getBids, 'getBids');\n\n/**\n * Filter an adUnit's  bids for building client and/or server requests\n *\n * @param bids an array of bids as defined in an adUnit\n * @param s2sConfig null if the adUnit is being routed to a client adapter; otherwise the s2s adapter's config\n * @returns the subset of `bids` that are pertinent for the given `s2sConfig`\n */\nexport function _filterBidsForAdUnit(bids, s2sConfig, {getS2SBidders = getS2SBidderSet} = {}) {\n  if (s2sConfig == null) {\n    return bids;\n  } else {\n    const serverBidders = getS2SBidders(s2sConfig);\n    return bids.filter((bid) => serverBidders.has(bid.bidder))\n  }\n}\nexport const filterBidsForAdUnit = hook('sync', _filterBidsForAdUnit, 'filterBidsForAdUnit');\n\nfunction getAdUnitCopyForPrebidServer(adUnits, s2sConfig) {\n  let adUnitsCopy = deepClone(adUnits);\n  let hasModuleBids = false;\n\n  adUnitsCopy.forEach((adUnit) => {\n    // filter out client side bids\n    const s2sBids = adUnit.bids.filter((b) => b.module === PBS_ADAPTER_NAME && b.params?.configName === s2sConfig.configName);\n    if (s2sBids.length === 1) {\n      adUnit.s2sBid = s2sBids[0];\n      hasModuleBids = true;\n      adUnit.ortb2Imp = mergeDeep({}, adUnit.s2sBid.ortb2Imp, adUnit.ortb2Imp);\n    } else if (s2sBids.length > 1) {\n      logWarn('Multiple \"module\" bids for the same s2s configuration; all will be ignored', s2sBids);\n    }\n    adUnit.bids = filterBidsForAdUnit(adUnit.bids, s2sConfig)\n      .map((bid) => {\n        bid.bid_id = getUniqueIdentifierStr();\n        return bid;\n      });\n  });\n\n  // don't send empty requests\n  adUnitsCopy = adUnitsCopy.filter(adUnit => {\n    return adUnit.bids.length !== 0 || adUnit.s2sBid != null;\n  });\n  return {adUnits: adUnitsCopy, hasModuleBids};\n}\n\nfunction getAdUnitCopyForClientAdapters(adUnits) {\n  let adUnitsClientCopy = deepClone(adUnits);\n  adUnitsClientCopy.forEach((adUnit) => {\n    adUnit.bids = filterBidsForAdUnit(adUnit.bids, null);\n  });\n\n  // don't send empty requests\n  adUnitsClientCopy = adUnitsClientCopy.filter(adUnit => {\n    return adUnit.bids.length !== 0;\n  });\n\n  return adUnitsClientCopy;\n}\n\n/**\n * Filter and/or modify media types for ad units based on the given labels.\n *\n * This should return adUnits that are active for the given labels, modified to have their `mediaTypes`\n * conform to size mapping configuration. If different bids for the same adUnit should use different `mediaTypes`,\n * they should be exposed under `adUnit.bids[].mediaTypes`.\n */\nexport const setupAdUnitMediaTypes = hook('sync', (adUnits, labels) => {\n  return adUnits;\n}, 'setupAdUnitMediaTypes')\n\n/**\n * @param {{}|Array<{}>} s2sConfigs\n * @returns {Set<String>} a set of all the bidder codes that should be routed through the S2S adapter(s)\n *                        as defined in `s2sConfigs`\n */\nexport function getS2SBidderSet(s2sConfigs) {\n  if (!isArray(s2sConfigs)) s2sConfigs = [s2sConfigs];\n  // `null` represents the \"no bid bidder\" - when an ad unit is meant only for S2S adapters, like stored impressions\n  const serverBidders = new Set([null]);\n  s2sConfigs.filter((s2s) => s2s && s2s.enabled)\n    .flatMap((s2s) => s2s.bidders)\n    .forEach((bidder) => serverBidders.add(bidder));\n  return serverBidders;\n}\n\n/**\n * @param {Array} adUnits - The ad units to be processed.\n * @param {Object} s2sConfigs - The server-to-server configurations.\n * @returns {Object} - An object containing arrays of bidder codes for client and server.\n * @returns {Object} return.client - Array of bidder codes that should be routed to client adapters.\n * @returns {Object} return.server - Array of bidder codes that should be routed to server adapters.\n */\nexport function _partitionBidders (adUnits, s2sConfigs, {getS2SBidders = getS2SBidderSet} = {}) {\n  const serverBidders = getS2SBidders(s2sConfigs);\n  return getBidderCodes(adUnits).reduce((memo, bidder) => {\n    const partition = serverBidders.has(bidder) ? PARTITIONS.SERVER : PARTITIONS.CLIENT;\n    memo[partition].push(bidder);\n    return memo;\n  }, {[PARTITIONS.CLIENT]: [], [PARTITIONS.SERVER]: []})\n}\n\nexport const partitionBidders = hook('sync', _partitionBidders, 'partitionBidders');\n\nadapterManager.makeBidRequests = hook('sync', function (adUnits, auctionStart, auctionId, cbTimeout, labels, ortb2Fragments = {}, auctionMetrics) {\n  auctionMetrics = useMetrics(auctionMetrics);\n  /**\n   * emit and pass adunits for external modification\n   * @see {@link https://github.com/prebid/Prebid.js/issues/4149|Issue}\n   */\n  events.emit(EVENTS.BEFORE_REQUEST_BIDS, adUnits);\n  if (FEATURES.NATIVE) {\n    decorateAdUnitsWithNativeParams(adUnits);\n  }\n  adUnits\n    .map(adUnit => adUnit.code)\n    .filter(uniques)\n    .forEach(incrementAuctionsCounter);\n\n  adUnits.forEach(au => {\n    if (!isPlainObject(au.mediaTypes)) {\n      au.mediaTypes = {};\n    }\n    // filter out bidders that cannot participate in the auction\n    au.bids = au.bids.filter((bid) => !bid.bidder || dep.isAllowed(ACTIVITY_FETCH_BIDS, activityParams(MODULE_TYPE_BIDDER, bid.bidder)))\n    incrementRequestsCounter(au.code);\n  });\n\n  adUnits = setupAdUnitMediaTypes(adUnits, labels);\n\n  let {[PARTITIONS.CLIENT]: clientBidders, [PARTITIONS.SERVER]: serverBidders} = partitionBidders(adUnits, _s2sConfigs);\n\n  if (config.getConfig('bidderSequence') === RANDOM) {\n    clientBidders = shuffle(clientBidders);\n  }\n  const refererInfo = getRefererInfo();\n\n  let bidRequests = [];\n\n  const ortb2 = ortb2Fragments.global || {};\n  const bidderOrtb2 = ortb2Fragments.bidder || {};\n\n  function addOrtb2(bidderRequest, s2sActivityParams) {\n    const redact = dep.redact(\n      s2sActivityParams != null\n        ? s2sActivityParams\n        : activityParams(MODULE_TYPE_BIDDER, bidderRequest.bidderCode)\n    );\n    const fpd = Object.freeze(redact.ortb2(mergeDeep({source: {tid: auctionId}}, ortb2, bidderOrtb2[bidderRequest.bidderCode])));\n    bidderRequest.ortb2 = fpd;\n    bidderRequest.bids = bidderRequest.bids.map((bid) => {\n      bid.ortb2 = fpd;\n      return redact.bidRequest(bid);\n    })\n    return bidderRequest;\n  }\n\n  _s2sConfigs.forEach(s2sConfig => {\n    const s2sParams = s2sActivityParams(s2sConfig);\n    if (s2sConfig && s2sConfig.enabled && dep.isAllowed(ACTIVITY_FETCH_BIDS, s2sParams)) {\n      let {adUnits: adUnitsS2SCopy, hasModuleBids} = getAdUnitCopyForPrebidServer(adUnits, s2sConfig);\n\n      // uniquePbsTid is so we know which server to send which bids to during the callBids function\n      let uniquePbsTid = generateUUID();\n\n      (serverBidders.length === 0 && hasModuleBids ? [null] : serverBidders).forEach(bidderCode => {\n        const bidderRequestId = getUniqueIdentifierStr();\n        const metrics = auctionMetrics.fork();\n        const bidderRequest = addOrtb2({\n          bidderCode,\n          auctionId,\n          bidderRequestId,\n          uniquePbsTid,\n          bids: hookedGetBids({ bidderCode, auctionId, bidderRequestId, 'adUnits': deepClone(adUnitsS2SCopy), src: S2S.SRC, metrics }),\n          auctionStart: auctionStart,\n          timeout: s2sConfig.timeout,\n          src: S2S.SRC,\n          refererInfo,\n          metrics,\n        }, s2sParams);\n        if (bidderRequest.bids.length !== 0) {\n          bidRequests.push(bidderRequest);\n        }\n      });\n\n      // update the s2sAdUnits object and remove all bids that didn't pass sizeConfig/label checks from getBids()\n      // this is to keep consistency and only allow bids/adunits that passed the checks to go to pbs\n      adUnitsS2SCopy.forEach((adUnitCopy) => {\n        let validBids = adUnitCopy.bids.filter((adUnitBid) =>\n          find(bidRequests, request =>\n            find(request.bids, (reqBid) => reqBid.bidId === adUnitBid.bid_id)));\n        adUnitCopy.bids = validBids;\n      });\n\n      bidRequests.forEach(request => {\n        if (request.adUnitsS2SCopy === undefined) {\n          request.adUnitsS2SCopy = adUnitsS2SCopy.filter(au => au.bids.length > 0 || au.s2sBid != null);\n        }\n      });\n    }\n  });\n\n  // client adapters\n  let adUnitsClientCopy = getAdUnitCopyForClientAdapters(adUnits);\n  clientBidders.forEach(bidderCode => {\n    const bidderRequestId = getUniqueIdentifierStr();\n    const metrics = auctionMetrics.fork();\n    const bidderRequest = addOrtb2({\n      bidderCode,\n      auctionId,\n      bidderRequestId,\n      bids: hookedGetBids({bidderCode, auctionId, bidderRequestId, 'adUnits': deepClone(adUnitsClientCopy), labels, src: 'client', metrics}),\n      auctionStart: auctionStart,\n      timeout: cbTimeout,\n      refererInfo,\n      metrics,\n    });\n    const adapter = _bidderRegistry[bidderCode];\n    if (!adapter) {\n      logError(`Trying to make a request for bidder that does not exist: ${bidderCode}`);\n    }\n\n    if (adapter && bidderRequest.bids && bidderRequest.bids.length !== 0) {\n      bidRequests.push(bidderRequest);\n    }\n  });\n\n  bidRequests.forEach(bidRequest => {\n    if (gdprDataHandler.getConsentData()) {\n      bidRequest['gdprConsent'] = gdprDataHandler.getConsentData();\n    }\n    if (uspDataHandler.getConsentData()) {\n      bidRequest['uspConsent'] = uspDataHandler.getConsentData();\n    }\n    if (gppDataHandler.getConsentData()) {\n      bidRequest['gppConsent'] = gppDataHandler.getConsentData();\n    }\n  });\n  return bidRequests;\n}, 'makeBidRequests');\n\nadapterManager.callBids = (adUnits, bidRequests, addBidResponse, doneCb, requestCallbacks, requestBidsTimeout, onTimelyResponse, ortb2Fragments = {}) => {\n  if (!bidRequests.length) {\n    logWarn('callBids executed with no bidRequests.  Were they filtered by labels or sizing?');\n    return;\n  }\n\n  let [clientBidderRequests, serverBidderRequests] = bidRequests.reduce((partitions, bidRequest) => {\n    partitions[Number(typeof bidRequest.src !== 'undefined' && bidRequest.src === S2S.SRC)].push(bidRequest);\n    return partitions;\n  }, [[], []]);\n\n  var uniqueServerBidRequests = [];\n  serverBidderRequests.forEach(serverBidRequest => {\n    var index = -1;\n    for (var i = 0; i < uniqueServerBidRequests.length; ++i) {\n      if (serverBidRequest.uniquePbsTid === uniqueServerBidRequests[i].uniquePbsTid) {\n        index = i;\n        break;\n      }\n    }\n    if (index <= -1) {\n      uniqueServerBidRequests.push(serverBidRequest);\n    }\n  });\n\n  let counter = 0;\n\n  _s2sConfigs.forEach((s2sConfig) => {\n    if (s2sConfig && uniqueServerBidRequests[counter] && getS2SBidderSet(s2sConfig).has(uniqueServerBidRequests[counter].bidderCode)) {\n      // s2s should get the same client side timeout as other client side requests.\n      const s2sAjax = ajaxBuilder(requestBidsTimeout, requestCallbacks ? {\n        request: requestCallbacks.request.bind(null, 's2s'),\n        done: requestCallbacks.done\n      } : undefined);\n      let adaptersServerSide = s2sConfig.bidders;\n      const s2sAdapter = _bidderRegistry[s2sConfig.adapter];\n      let uniquePbsTid = uniqueServerBidRequests[counter].uniquePbsTid;\n      let adUnitsS2SCopy = uniqueServerBidRequests[counter].adUnitsS2SCopy;\n\n      let uniqueServerRequests = serverBidderRequests.filter(serverBidRequest => serverBidRequest.uniquePbsTid === uniquePbsTid);\n\n      if (s2sAdapter) {\n        let s2sBidRequest = {'ad_units': adUnitsS2SCopy, s2sConfig, ortb2Fragments, requestBidsTimeout};\n        if (s2sBidRequest.ad_units.length) {\n          let doneCbs = uniqueServerRequests.map(bidRequest => {\n            bidRequest.start = timestamp();\n            return function (timedOut) {\n              if (!timedOut) {\n                onTimelyResponse(bidRequest.bidderRequestId);\n              }\n              doneCb.apply(bidRequest, arguments);\n            }\n          });\n\n          const bidders = getBidderCodes(s2sBidRequest.ad_units).filter((bidder) => adaptersServerSide.includes(bidder));\n          logMessage(`CALLING S2S HEADER BIDDERS ==== ${bidders.length > 0 ? bidders.join(', ') : 'No bidder specified, using \"ortb2Imp\" definition(s) only'}`);\n\n          // fire BID_REQUESTED event for each s2s bidRequest\n          uniqueServerRequests.forEach(bidRequest => {\n            // add the new sourceTid\n            events.emit(EVENTS.BID_REQUESTED, { ...bidRequest, tid: bidRequest.auctionId });\n          });\n\n          // make bid requests\n          s2sAdapter.callBids(\n            s2sBidRequest,\n            serverBidderRequests,\n            addBidResponse,\n            (timedOut) => doneCbs.forEach(done => done(timedOut)),\n            s2sAjax\n          );\n        }\n      } else {\n        logError('missing ' + s2sConfig.adapter);\n      }\n      counter++;\n    }\n  });\n\n  // handle client adapter requests\n  clientBidderRequests.forEach(bidderRequest => {\n    bidderRequest.start = timestamp();\n    // TODO : Do we check for bid in pool from here and skip calling adapter again ?\n    const adapter = _bidderRegistry[bidderRequest.bidderCode];\n    config.runWithBidder(bidderRequest.bidderCode, () => {\n      logMessage(`CALLING BIDDER`);\n      events.emit(EVENTS.BID_REQUESTED, bidderRequest);\n    });\n    let ajax = ajaxBuilder(requestBidsTimeout, requestCallbacks ? {\n      request: requestCallbacks.request.bind(null, bidderRequest.bidderCode),\n      done: requestCallbacks.done\n    } : undefined);\n    const adapterDone = doneCb.bind(bidderRequest);\n    try {\n      config.runWithBidder(\n        bidderRequest.bidderCode,\n        adapter.callBids.bind(\n          adapter,\n          bidderRequest,\n          addBidResponse,\n          adapterDone,\n          ajax,\n          () => onTimelyResponse(bidderRequest.bidderRequestId),\n          config.callbackWithBidder(bidderRequest.bidderCode)\n        )\n      );\n    } catch (e) {\n      logError(`${bidderRequest.bidderCode} Bid Adapter emitted an uncaught error when parsing their bidRequest`, {e, bidRequest: bidderRequest});\n      adapterDone();\n    }\n  });\n};\n\nfunction getSupportedMediaTypes(bidderCode) {\n  let supportedMediaTypes = [];\n  if (FEATURES.VIDEO && includes(adapterManager.videoAdapters, bidderCode)) supportedMediaTypes.push('video');\n  if (FEATURES.NATIVE && includes(nativeAdapters, bidderCode)) supportedMediaTypes.push('native');\n  return supportedMediaTypes;\n}\n\nadapterManager.videoAdapters = []; // added by adapterLoader for now\n\nadapterManager.registerBidAdapter = function (bidAdapter, bidderCode, {supportedMediaTypes = []} = {}) {\n  if (bidAdapter && bidderCode) {\n    if (typeof bidAdapter.callBids === 'function') {\n      _bidderRegistry[bidderCode] = bidAdapter;\n      GDPR_GVLIDS.register(MODULE_TYPE_BIDDER, bidderCode, bidAdapter.getSpec?.().gvlid);\n\n      if (FEATURES.VIDEO && includes(supportedMediaTypes, 'video')) {\n        adapterManager.videoAdapters.push(bidderCode);\n      }\n      if (FEATURES.NATIVE && includes(supportedMediaTypes, 'native')) {\n        nativeAdapters.push(bidderCode);\n      }\n    } else {\n      logError('Bidder adaptor error for bidder code: ' + bidderCode + 'bidder must implement a callBids() function');\n    }\n  } else {\n    logError('bidAdapter or bidderCode not specified');\n  }\n};\n\nadapterManager.aliasBidAdapter = function (bidderCode, alias, options) {\n  let existingAlias = _bidderRegistry[alias];\n\n  if (typeof existingAlias === 'undefined') {\n    let bidAdapter = _bidderRegistry[bidderCode];\n    if (typeof bidAdapter === 'undefined') {\n      // check if alias is part of s2sConfig and allow them to register if so (as base bidder may be s2s-only)\n      const nonS2SAlias = [];\n      _s2sConfigs.forEach(s2sConfig => {\n        if (s2sConfig.bidders && s2sConfig.bidders.length) {\n          const s2sBidders = s2sConfig && s2sConfig.bidders;\n          if (!(s2sConfig && includes(s2sBidders, alias))) {\n            nonS2SAlias.push(bidderCode);\n          } else {\n            _aliasRegistry[alias] = bidderCode;\n          }\n        }\n      });\n      nonS2SAlias.forEach(bidderCode => {\n        logError('bidderCode \"' + bidderCode + '\" is not an existing bidder.', 'adapterManager.aliasBidAdapter');\n      });\n    } else {\n      try {\n        let newAdapter;\n        let supportedMediaTypes = getSupportedMediaTypes(bidderCode);\n        // Have kept old code to support backward compatibilitiy.\n        // Remove this if loop when all adapters are supporting bidderFactory. i.e When Prebid.js is 1.0\n        if (bidAdapter.constructor.prototype != Object.prototype) {\n          newAdapter = new bidAdapter.constructor();\n          newAdapter.setBidderCode(alias);\n        } else {\n          const { useBaseGvlid = false } = options || {};\n          let spec = bidAdapter.getSpec();\n          const gvlid = useBaseGvlid ? spec.gvlid : options?.gvlid;\n          if (gvlid == null && spec.gvlid != null) {\n            logWarn(`Alias '${alias}' will NOT re-use the GVL ID of the original adapter ('${spec.code}', gvlid: ${spec.gvlid}). Functionality that requires TCF consent may not work as expected.`)\n          }\n\n          let skipPbsAliasing = options && options.skipPbsAliasing;\n          newAdapter = newBidder(Object.assign({}, spec, { code: alias, gvlid, skipPbsAliasing }));\n          _aliasRegistry[alias] = bidderCode;\n        }\n        adapterManager.registerBidAdapter(newAdapter, alias, {\n          supportedMediaTypes\n        });\n      } catch (e) {\n        logError(bidderCode + ' bidder does not currently support aliasing.', 'adapterManager.aliasBidAdapter');\n      }\n    }\n  } else {\n    logMessage('alias name \"' + alias + '\" has been already specified.');\n  }\n};\n\nadapterManager.resolveAlias = function (alias) {\n  let code = alias;\n  let visited;\n  while (_aliasRegistry[code] && (!visited || !visited.has(code))) {\n    code = _aliasRegistry[code];\n    (visited = visited || new Set()).add(code);\n  }\n  return code;\n}\n\nadapterManager.registerAnalyticsAdapter = function ({adapter, code, gvlid}) {\n  if (adapter && code) {\n    if (typeof adapter.enableAnalytics === 'function') {\n      adapter.code = code;\n      _analyticsRegistry[code] = { adapter, gvlid };\n      GDPR_GVLIDS.register(MODULE_TYPE_ANALYTICS, code, gvlid);\n    } else {\n      logError(`Prebid Error: Analytics adaptor error for analytics \"${code}\"\n        analytics adapter must implement an enableAnalytics() function`);\n    }\n  } else {\n    logError('Prebid Error: analyticsAdapter or analyticsCode not specified');\n  }\n};\n\nadapterManager.enableAnalytics = function (config) {\n  if (!isArray(config)) {\n    config = [config];\n  }\n\n  config.forEach(adapterConfig => {\n    const entry = _analyticsRegistry[adapterConfig.provider];\n    if (entry && entry.adapter) {\n      if (dep.isAllowed(ACTIVITY_REPORT_ANALYTICS, activityParams(MODULE_TYPE_ANALYTICS, adapterConfig.provider, {[ACTIVITY_PARAM_ANL_CONFIG]: adapterConfig}))) {\n        entry.adapter.enableAnalytics(adapterConfig);\n      }\n    } else {\n      logError(`Prebid Error: no analytics adapter found in registry for '${adapterConfig.provider}'.`);\n    }\n  });\n}\n\nadapterManager.getBidAdapter = function(bidder) {\n  return _bidderRegistry[bidder];\n};\n\nadapterManager.getAnalyticsAdapter = function(code) {\n  return _analyticsRegistry[code];\n}\n\nfunction getBidderMethod(bidder, method) {\n  const adapter = _bidderRegistry[bidder];\n  const spec = adapter?.getSpec && adapter.getSpec();\n  if (spec && spec[method] && typeof spec[method] === 'function') {\n    return [spec, spec[method]]\n  }\n}\n\nfunction invokeBidderMethod(bidder, method, spec, fn, ...params) {\n  try {\n    logInfo(`Invoking ${bidder}.${method}`);\n    config.runWithBidder(bidder, fn.bind(spec, ...params));\n  } catch (e) {\n    logWarn(`Error calling ${method} of ${bidder}`);\n  }\n}\n\nfunction tryCallBidderMethod(bidder, method, param) {\n  if (param?.source !== S2S.SRC) {\n    const target = getBidderMethod(bidder, method);\n    if (target != null) {\n      invokeBidderMethod(bidder, method, ...target, param);\n    }\n  }\n}\n\nadapterManager.callTimedOutBidders = function(adUnits, timedOutBidders, cbTimeout) {\n  timedOutBidders = timedOutBidders.map((timedOutBidder) => {\n    // Adding user configured params & timeout to timeout event data\n    timedOutBidder.params = getUserConfiguredParams(adUnits, timedOutBidder.adUnitCode, timedOutBidder.bidder);\n    timedOutBidder.timeout = cbTimeout;\n    return timedOutBidder;\n  });\n  timedOutBidders = groupBy(timedOutBidders, 'bidder');\n\n  Object.keys(timedOutBidders).forEach((bidder) => {\n    tryCallBidderMethod(bidder, 'onTimeout', timedOutBidders[bidder]);\n  });\n}\n\nadapterManager.callBidWonBidder = function(bidder, bid, adUnits) {\n  // Adding user configured params to bidWon event data\n  bid.params = getUserConfiguredParams(adUnits, bid.adUnitCode, bid.bidder);\n  incrementBidderWinsCounter(bid.adUnitCode, bid.bidder);\n  tryCallBidderMethod(bidder, 'onBidWon', bid);\n};\n\nadapterManager.triggerBilling = (() => {\n  const BILLED = new WeakSet();\n  return (bid) => {\n    if (!BILLED.has(bid)) {\n      BILLED.add(bid);\n      (parseEventTrackers(bid.eventtrackers)[EVENT_TYPE_IMPRESSION]?.[TRACKER_METHOD_IMG] || [])\n        .forEach((url) => internal.triggerPixel(url));\n      tryCallBidderMethod(bid.bidder, 'onBidBillable', bid);\n    }\n  }\n})();\n\nadapterManager.callSetTargetingBidder = function(bidder, bid) {\n  tryCallBidderMethod(bidder, 'onSetTargeting', bid);\n};\n\nadapterManager.callBidViewableBidder = function(bidder, bid) {\n  tryCallBidderMethod(bidder, 'onBidViewable', bid);\n};\n\nadapterManager.callBidderError = function(bidder, error, bidderRequest) {\n  const param = { error, bidderRequest };\n  tryCallBidderMethod(bidder, 'onBidderError', param);\n};\n\nadapterManager.callAdRenderSucceededBidder = function (bidder, bid) {\n  tryCallBidderMethod(bidder, 'onAdRenderSucceeded', bid);\n}\n\nfunction resolveAlias(alias) {\n  const seen = new Set();\n  while (_aliasRegistry.hasOwnProperty(alias) && !seen.has(alias)) {\n    seen.add(alias);\n    alias = _aliasRegistry[alias];\n  }\n  return alias;\n}\n/**\n * Ask every adapter to delete PII.\n * See https://github.com/prebid/Prebid.js/issues/9081\n */\nadapterManager.callDataDeletionRequest = hook('sync', function (...args) {\n  const method = 'onDataDeletionRequest';\n  Object.keys(_bidderRegistry)\n    .filter((bidder) => !_aliasRegistry.hasOwnProperty(bidder))\n    .forEach(bidder => {\n      const target = getBidderMethod(bidder, method);\n      if (target != null) {\n        const bidderRequests = auctionManager.getBidsRequested().filter((br) =>\n          resolveAlias(br.bidderCode) === bidder\n        );\n        invokeBidderMethod(bidder, method, ...target, bidderRequests, ...args);\n      }\n    });\n  Object.entries(_analyticsRegistry).forEach(([name, entry]) => {\n    const fn = entry?.adapter?.[method];\n    if (typeof fn === 'function') {\n      try {\n        fn.apply(entry.adapter, args);\n      } catch (e) {\n        logError(`error calling ${method} of ${name}`, e);\n      }\n    }\n  });\n});\n\nexport default adapterManager;\n","import Adapter from '../adapter.js';\nimport adapterManager from '../adapterManager.js';\nimport {config} from '../config.js';\nimport {createBid} from '../bidfactory.js';\nimport {userSync} from '../userSync.js';\nimport {nativeBidIsValid} from '../native.js';\nimport {isValidVideoBid} from '../video.js';\nimport {EVENTS, REJECTION_REASON, STATUS} from '../constants.js';\nimport * as events from '../events.js';\nimport {includes} from '../polyfill.js';\nimport {\n  delayExecution,\n  isArray,\n  isPlainObject,\n  logError,\n  logWarn,\n  memoize,\n  parseQueryStringParameters,\n  parseSizesInput,\n  pick,\n  uniques\n} from '../utils.js';\nimport {hook} from '../hook.js';\nimport {auctionManager} from '../auctionManager.js';\nimport {bidderSettings} from '../bidderSettings.js';\nimport {useMetrics} from '../utils/perfMetrics.js';\nimport {isActivityAllowed} from '../activities/rules.js';\nimport {activityParams} from '../activities/activityParams.js';\nimport {MODULE_TYPE_BIDDER} from '../activities/modules.js';\nimport {ACTIVITY_TRANSMIT_TID, ACTIVITY_TRANSMIT_UFPD} from '../activities/activities.js';\n\n/**\n * @typedef {import('../mediaTypes.js').MediaType} MediaType\n * @typedef {import('../Renderer.js').Renderer} Renderer\n */\n\n/**\n * This file aims to support Adapters during the Prebid 0.x -> 1.x transition.\n *\n * Prebid 1.x and Prebid 0.x will be in separate branches--perhaps for a long time.\n * This function defines an API for adapter construction which is compatible with both versions.\n * Adapters which use it can maintain their code in master, and only this file will need to change\n * in the 1.x branch.\n *\n * Typical usage looks something like:\n *\n * const adapter = registerBidder({\n *   code: 'myBidderCode',\n *   aliases: ['alias1', 'alias2'],\n *   supportedMediaTypes: ['video', 'native'],\n *   isBidRequestValid: function(paramsObject) { return true/false },\n *   buildRequests: function(bidRequests, bidderRequest) { return some ServerRequest(s) },\n *   interpretResponse: function(oneServerResponse) { return some Bids, or throw an error. }\n * });\n *\n * @see BidderSpec for the full API and more thorough descriptions.\n *\n */\n\n/**\n * @typedef {object} BidderSpec An object containing the adapter-specific functions needed to\n * make a Bidder.\n *\n * @property {string} code A code which will be used to uniquely identify this bidder. This should be the same\n *   one as is used in the call to registerBidAdapter\n * @property {string[]} [aliases] A list of aliases which should also resolve to this bidder.\n * @property {MediaType[]} [supportedMediaTypes] A list of Media Types which the adapter supports.\n * @property {function(object): boolean} isBidRequestValid Determines whether or not the given bid has all the params\n *   needed to make a valid request.\n * @property {function(BidRequest[], bidderRequest): ServerRequest|ServerRequest[]} buildRequests Build the request to the Server\n *   which requests Bids for the given array of Requests. Each BidRequest in the argument array is guaranteed to have\n *   passed the isBidRequestValid() test.\n * @property {function(ServerResponse, BidRequest): Bid[]} interpretResponse Given a successful response from the Server,\n *   interpret it and return the Bid objects. This function will be run inside a try/catch.\n *   If it throws any errors, your bids will be discarded.\n * @property {function(SyncOptions, ServerResponse[]): UserSync[]} [getUserSyncs] Given an array of all the responses\n *   from the server, determine which user syncs should occur. The argument array will contain every element\n *   which has been sent through to interpretResponse. The order of syncs in this array matters. The most\n *   important ones should come first, since publishers may limit how many are dropped on their page.\n * @property {function(object): object} transformBidParams Updates bid params before creating bid request\n }}\n */\n\n/**\n * @typedef {object} BidRequest\n *\n * @property {string} bidId A string which uniquely identifies this BidRequest in the current Auction.\n * @property {object} params Any bidder-specific params which the publisher used in their bid request.\n */\n\n/**\n * @typedef {object} BidderAuctionResponse An object encapsulating an adapter response for current Auction\n *\n * @property {Array<Bid>} bids? Contextual bids returned by this adapter, if any\n * @property {Array<{bidId: String, config: {}}>} paapiAuctionConfigs? Array of paapi auction configs, each scoped to a particular bidId\n */\n\n/**\n * @typedef {object} ServerRequest\n *\n * @property {('GET'|'POST')} method The type of request which this is.\n * @property {string} url The endpoint for the request. For example, \"//bids.example.com\".\n * @property {string|object} data Data to be sent in the request.\n * @property {object} options Content-Type set in the header of the bid request, overrides default 'text/plain'.\n *   If this is a GET request, they'll become query params. If it's a POST request, they'll be added to the body.\n *   Strings will be added as-is. Objects will be unpacked into query params based on key/value mappings, or\n *   JSON-serialized into the Request body.\n */\n\n/**\n * @typedef {object} ServerResponse\n *\n * @property {*} body The response body. If this is legal JSON, then it will be parsed. Otherwise it'll be a\n *   string with the body's content.\n * @property {{get: function(string): string}} headers The response headers.\n *   Call this like `ServerResponse.headers.get(\"Content-Type\")`\n */\n\n/**\n * @typedef {object} Bid\n *\n * @property {string} requestId The specific BidRequest which this bid is aimed at.\n *   This should match the BidRequest.bidId which this Bid targets.\n * @property {string} ad A URL which can be used to load this ad, if it's chosen by the publisher.\n * @property {string} currency The currency code for the cpm value\n * @property {number} cpm The bid price, in US cents per thousand impressions.\n * @property {number} ttl Time-to-live - how long (in seconds) Prebid can use this bid.\n * @property {boolean} netRevenue Boolean defining whether the bid is Net or Gross.  The default is true (Net).\n * @property {number} height The height of the ad, in pixels.\n * @property {number} width The width of the ad, in pixels.\n *\n * @property {object} [native] Object for storing native creative assets\n * @property {object} [video] Object for storing video response data\n * @property {object} [meta] Object for storing bid meta data\n * @property {string} [meta.primaryCatId] The IAB primary category ID\n * @property {Renderer} renderer A Renderer which can be used as a default for this bid,\n *   if the publisher doesn't override it. This is only relevant for Outstream Video bids.\n */\n\n/**\n * @typedef {Object} SyncOptions\n *\n * An object containing information about usersyncs which the adapter should obey.\n *\n * @property {boolean} iframeEnabled True if iframe usersyncs are allowed, and false otherwise\n * @property {boolean} pixelEnabled True if image usersyncs are allowed, and false otherwise\n */\n\n/**\n * TODO: Move this to the UserSync module after that PR is merged.\n *\n * @typedef {object} UserSync\n *\n * @property {('image'|'iframe')} type The type of user sync to be done.\n * @property {string} url The URL which makes the sync happen.\n */\n\n// common params for all mediaTypes\nconst COMMON_BID_RESPONSE_KEYS = ['cpm', 'ttl', 'creativeId', 'netRevenue', 'currency'];\nconst TIDS = ['auctionId', 'transactionId'];\n\n/**\n * Register a bidder with prebid, using the given spec.\n *\n * If possible, Adapter modules should use this function instead of adapterManager.registerBidAdapter().\n *\n * @param {BidderSpec} spec An object containing the bare-bones functions we need to make a Bidder.\n */\nexport function registerBidder(spec) {\n  const mediaTypes = Array.isArray(spec.supportedMediaTypes)\n    ? { supportedMediaTypes: spec.supportedMediaTypes }\n    : undefined;\n  function putBidder(spec) {\n    const bidder = newBidder(spec);\n    adapterManager.registerBidAdapter(bidder, spec.code, mediaTypes);\n  }\n\n  putBidder(spec);\n  if (Array.isArray(spec.aliases)) {\n    spec.aliases.forEach(alias => {\n      let aliasCode = alias;\n      let gvlid;\n      let skipPbsAliasing;\n      if (isPlainObject(alias)) {\n        aliasCode = alias.code;\n        gvlid = alias.gvlid;\n        skipPbsAliasing = alias.skipPbsAliasing\n      }\n      adapterManager.aliasRegistry[aliasCode] = spec.code;\n      putBidder(Object.assign({}, spec, { code: aliasCode, gvlid, skipPbsAliasing }));\n    });\n  }\n}\n\nexport const guardTids = memoize(({bidderCode}) => {\n  if (isActivityAllowed(ACTIVITY_TRANSMIT_TID, activityParams(MODULE_TYPE_BIDDER, bidderCode))) {\n    return {\n      bidRequest: (br) => br,\n      bidderRequest: (br) => br\n    };\n  }\n  function get(target, prop, receiver) {\n    if (TIDS.includes(prop)) {\n      return null;\n    }\n    return Reflect.get(target, prop, receiver);\n  }\n  function privateAccessProxy(target, handler) {\n    const proxy = new Proxy(target, handler);\n    // always allow methods (such as getFloor) private access to TIDs\n    Object.entries(target)\n      .filter(([_, v]) => typeof v === 'function')\n      .forEach(([prop, fn]) => proxy[prop] = fn.bind(target));\n    return proxy;\n  }\n  const bidRequest = memoize((br) => privateAccessProxy(br, {get}), (arg) => arg.bidId);\n  /**\n   * Return a view on bidd(er) requests where auctionId/transactionId are nulled if the bidder is not allowed `transmitTid`.\n   *\n   * Because both auctionId and transactionId are used for Prebid's own internal bookkeeping, we cannot simply erase them\n   * from request objects; and because request objects are quite complex and not easily cloneable, we hide the IDs\n   * with a proxy instead. This should be used only around the adapter logic.\n   */\n  return {\n    bidRequest,\n    bidderRequest: (br) => privateAccessProxy(br, {\n      get(target, prop, receiver) {\n        if (prop === 'bids') return br.bids.map(bidRequest);\n        return get(target, prop, receiver);\n      }\n    })\n  }\n});\n\n/**\n * Make a new bidder from the given spec. This is exported mainly for testing.\n * Adapters will probably find it more convenient to use registerBidder instead.\n *\n * @param {BidderSpec} spec\n */\nexport function newBidder(spec) {\n  return Object.assign(new Adapter(spec.code), {\n    getSpec: function() {\n      return Object.freeze(Object.assign({}, spec));\n    },\n    registerSyncs,\n    callBids: function(bidderRequest, addBidResponse, done, ajax, onTimelyResponse, configEnabledCallback) {\n      if (!Array.isArray(bidderRequest.bids)) {\n        return;\n      }\n      const tidGuard = guardTids(bidderRequest);\n\n      const adUnitCodesHandled = {};\n      function addBidWithCode(adUnitCode, bid) {\n        const metrics = useMetrics(bid.metrics);\n        metrics.checkpoint('addBidResponse');\n        adUnitCodesHandled[adUnitCode] = true;\n        if (metrics.measureTime('addBidResponse.validate', () => isValid(adUnitCode, bid))) {\n          addBidResponse(adUnitCode, bid);\n        } else {\n          addBidResponse.reject(adUnitCode, bid, REJECTION_REASON.INVALID)\n        }\n      }\n\n      // After all the responses have come back, call done() and\n      // register any required usersync pixels.\n      const responses = [];\n      function afterAllResponses() {\n        done();\n        config.runWithBidder(spec.code, () => {\n          events.emit(EVENTS.BIDDER_DONE, bidderRequest);\n          registerSyncs(responses, bidderRequest.gdprConsent, bidderRequest.uspConsent, bidderRequest.gppConsent);\n        });\n      }\n\n      const validBidRequests = adapterMetrics(bidderRequest)\n        .measureTime('validate', () => bidderRequest.bids.filter((br) => filterAndWarn(tidGuard.bidRequest(br))));\n\n      if (validBidRequests.length === 0) {\n        afterAllResponses();\n        return;\n      }\n      const bidRequestMap = {};\n      validBidRequests.forEach(bid => {\n        bidRequestMap[bid.bidId] = bid;\n        // Delete this once we are 1.0\n        if (!bid.adUnitCode) {\n          bid.adUnitCode = bid.placementCode\n        }\n      });\n\n      processBidderRequests(spec, validBidRequests, bidderRequest, ajax, configEnabledCallback, {\n        onRequest: requestObject => events.emit(EVENTS.BEFORE_BIDDER_HTTP, bidderRequest, requestObject),\n        onResponse: (resp) => {\n          onTimelyResponse(spec.code);\n          responses.push(resp)\n        },\n        onPaapi: (paapiConfig) => {\n          const bidRequest = bidRequestMap[paapiConfig.bidId];\n          if (bidRequest) {\n            addPaapiConfig(bidRequest, paapiConfig);\n          } else {\n            logWarn('Received fledge auction configuration for an unknown bidId', paapiConfig);\n          }\n        },\n        // If the server responds with an error, there's not much we can do beside logging.\n        onError: (errorMessage, error) => {\n          if (!error.timedOut) {\n            onTimelyResponse(spec.code);\n          }\n          adapterManager.callBidderError(spec.code, error, bidderRequest)\n          events.emit(EVENTS.BIDDER_ERROR, { error, bidderRequest });\n          logError(`Server call for ${spec.code} failed: ${errorMessage} ${error.status}. Continuing without bids.`, {bidRequests: validBidRequests});\n        },\n        onBid: (bid) => {\n          const bidRequest = bidRequestMap[bid.requestId];\n          if (bidRequest) {\n            bid.adapterCode = bidRequest.bidder;\n            if (isInvalidAlternateBidder(bid.bidderCode, bidRequest.bidder)) {\n              logWarn(`${bid.bidderCode} is not a registered partner or known bidder of ${bidRequest.bidder}, hence continuing without bid. If you wish to support this bidder, please mark allowAlternateBidderCodes as true in bidderSettings.`);\n              addBidResponse.reject(bidRequest.adUnitCode, bid, REJECTION_REASON.BIDDER_DISALLOWED)\n              return;\n            }\n            // creating a copy of original values as cpm and currency are modified later\n            bid.originalCpm = bid.cpm;\n            bid.originalCurrency = bid.currency;\n            bid.meta = bid.meta || Object.assign({}, bid[bidRequest.bidder]);\n            bid.deferBilling = bidRequest.deferBilling;\n            bid.deferRendering = bid.deferBilling && (bid.deferRendering ?? typeof spec.onBidBillable !== 'function');\n            const prebidBid = Object.assign(createBid(STATUS.GOOD, bidRequest), bid, pick(bidRequest, TIDS));\n            addBidWithCode(bidRequest.adUnitCode, prebidBid);\n          } else {\n            logWarn(`Bidder ${spec.code} made bid for unknown request ID: ${bid.requestId}. Ignoring.`);\n            addBidResponse.reject(null, bid, REJECTION_REASON.INVALID_REQUEST_ID);\n          }\n        },\n        onCompletion: afterAllResponses,\n      });\n    }\n  });\n\n  function isInvalidAlternateBidder(responseBidder, requestBidder) {\n    let allowAlternateBidderCodes = bidderSettings.get(requestBidder, 'allowAlternateBidderCodes') || false;\n    let alternateBiddersList = bidderSettings.get(requestBidder, 'allowedAlternateBidderCodes');\n    if (!!responseBidder && !!requestBidder && requestBidder !== responseBidder) {\n      alternateBiddersList = isArray(alternateBiddersList) ? alternateBiddersList.map(val => val.trim().toLowerCase()).filter(val => !!val).filter(uniques) : alternateBiddersList;\n      if (!allowAlternateBidderCodes || (isArray(alternateBiddersList) && (alternateBiddersList[0] !== '*' && !alternateBiddersList.includes(responseBidder)))) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function registerSyncs(responses, gdprConsent, uspConsent, gppConsent) {\n    registerSyncInner(spec, responses, gdprConsent, uspConsent, gppConsent);\n  }\n\n  function filterAndWarn(bid) {\n    if (!spec.isBidRequestValid(bid)) {\n      logWarn(`Invalid bid sent to bidder ${spec.code}: ${JSON.stringify(bid)}`);\n      return false;\n    }\n    return true;\n  }\n}\n\nconst RESPONSE_PROPS = ['bids', 'paapi']\n\n/**\n * Run a set of bid requests - that entails converting them to HTTP requests, sending\n * them over the network, and parsing the responses.\n *\n * @param spec bid adapter spec\n * @param bids bid requests to run\n * @param bidderRequest the bid request object that `bids` is connected to\n * @param ajax ajax method to use\n * @param wrapCallback {function(callback)} a function used to wrap every callback (for the purpose of `config.currentBidder`)\n * @param onRequest {function({})} invoked once for each HTTP request built by the adapter - with the raw request\n * @param onResponse {function({})} invoked once on each successful HTTP response - with the raw response\n * @param onError {function(String, {})} invoked once for each HTTP error - with status code and response\n * @param onBid {function({})} invoked once for each bid in the response - with the bid as returned by interpretResponse\n * @param onCompletion {function()} invoked once when all bid requests have been processed\n */\nexport const processBidderRequests = hook('sync', function (spec, bids, bidderRequest, ajax, wrapCallback, {onRequest, onResponse, onPaapi, onError, onBid, onCompletion}) {\n  const metrics = adapterMetrics(bidderRequest);\n  onCompletion = metrics.startTiming('total').stopBefore(onCompletion);\n  const tidGuard = guardTids(bidderRequest);\n  let requests = metrics.measureTime('buildRequests', () => spec.buildRequests(bids.map(tidGuard.bidRequest), tidGuard.bidderRequest(bidderRequest)));\n\n  if (!requests || requests.length === 0) {\n    onCompletion();\n    return;\n  }\n  if (!Array.isArray(requests)) {\n    requests = [requests];\n  }\n\n  const requestDone = delayExecution(onCompletion, requests.length);\n\n  requests.forEach((request) => {\n    const requestMetrics = metrics.fork();\n    function addBid(bid) {\n      if (bid != null) bid.metrics = requestMetrics.fork().renameWith();\n      onBid(bid);\n    }\n    // If the server responds successfully, use the adapter code to unpack the Bids from it.\n    // If the adapter code fails, no bids should be added. After all the bids have been added,\n    // make sure to call the `requestDone` function so that we're one step closer to calling onCompletion().\n    const onSuccess = wrapCallback(function(response, responseObj) {\n      networkDone();\n      try {\n        response = JSON.parse(response);\n      } catch (e) { /* response might not be JSON... that's ok. */ }\n\n      // Make response headers available for #1742. These are lazy-loaded because most adapters won't need them.\n      response = {\n        body: response,\n        headers: headerParser(responseObj)\n      };\n      onResponse(response);\n\n      try {\n        response = requestMetrics.measureTime('interpretResponse', () => spec.interpretResponse(response, request));\n      } catch (err) {\n        logError(`Bidder ${spec.code} failed to interpret the server's response. Continuing without bids`, null, err);\n        requestDone();\n        return;\n      }\n\n      // adapters can reply with:\n      // a single bid\n      // an array of bids\n      // a BidderAuctionResponse object\n\n      let bids, paapiConfigs;\n      if (response && !Object.keys(response).some(key => !RESPONSE_PROPS.includes(key))) {\n        bids = response.bids;\n        paapiConfigs = response.paapi;\n      } else {\n        bids = response;\n      }\n      if (isArray(paapiConfigs)) {\n        paapiConfigs.forEach(onPaapi);\n      }\n      if (bids) {\n        if (isArray(bids)) {\n          bids.forEach(addBid);\n        } else {\n          addBid(bids);\n        }\n      }\n      requestDone();\n\n      function headerParser(xmlHttpResponse) {\n        return {\n          get: responseObj.getResponseHeader.bind(responseObj)\n        };\n      }\n    });\n\n    const onFailure = wrapCallback(function (errorMessage, error) {\n      networkDone();\n      onError(errorMessage, error);\n      requestDone();\n    });\n\n    onRequest(request);\n\n    const networkDone = requestMetrics.startTiming('net');\n\n    function getOptions(defaults) {\n      const ro = request.options;\n      return Object.assign(defaults, ro, {\n        browsingTopics: ro?.hasOwnProperty('browsingTopics') && !ro.browsingTopics\n          ? false\n          : (bidderSettings.get(spec.code, 'topicsHeader') ?? true) && isActivityAllowed(ACTIVITY_TRANSMIT_UFPD, activityParams(MODULE_TYPE_BIDDER, spec.code))\n      })\n    }\n    switch (request.method) {\n      case 'GET':\n        ajax(\n          `${request.url}${formatGetParameters(request.data)}`,\n          {\n            success: onSuccess,\n            error: onFailure\n          },\n          undefined,\n          getOptions({\n            method: 'GET',\n            withCredentials: true\n          })\n        );\n        break;\n      case 'POST':\n        ajax(\n          request.url,\n          {\n            success: onSuccess,\n            error: onFailure\n          },\n          typeof request.data === 'string' ? request.data : JSON.stringify(request.data),\n          getOptions({\n            method: 'POST',\n            contentType: 'text/plain',\n            withCredentials: true\n          })\n        );\n        break;\n      default:\n        logWarn(`Skipping invalid request from ${spec.code}. Request type ${request.type} must be GET or POST`);\n        requestDone();\n    }\n\n    function formatGetParameters(data) {\n      if (data) {\n        return `?${typeof data === 'object' ? parseQueryStringParameters(data) : data}`;\n      }\n\n      return '';\n    }\n  })\n}, 'processBidderRequests')\n\nexport const registerSyncInner = hook('async', function(spec, responses, gdprConsent, uspConsent, gppConsent) {\n  const aliasSyncEnabled = config.getConfig('userSync.aliasSyncEnabled');\n  if (spec.getUserSyncs && (aliasSyncEnabled || !adapterManager.aliasRegistry[spec.code])) {\n    let syncs = spec.getUserSyncs({\n      iframeEnabled: userSync.canBidderRegisterSync('iframe', spec.code),\n      pixelEnabled: userSync.canBidderRegisterSync('image', spec.code),\n    }, responses, gdprConsent, uspConsent, gppConsent);\n    if (syncs) {\n      if (!Array.isArray(syncs)) {\n        syncs = [syncs];\n      }\n      syncs.forEach((sync) => {\n        userSync.registerSync(sync.type, spec.code, sync.url)\n      });\n      userSync.bidderDone(spec.code);\n    }\n  }\n}, 'registerSyncs')\n\nexport const addPaapiConfig = hook('sync', (request, paapiConfig) => {\n}, 'addPaapiConfig');\n\n// check that the bid has a width and height set\nfunction validBidSize(adUnitCode, bid, {index = auctionManager.index} = {}) {\n  if ((bid.width || parseInt(bid.width, 10) === 0) && (bid.height || parseInt(bid.height, 10) === 0)) {\n    bid.width = parseInt(bid.width, 10);\n    bid.height = parseInt(bid.height, 10);\n    return true;\n  }\n\n  if (bid.wratio != null && bid.hratio != null) {\n    bid.wratio = parseInt(bid.wratio, 10);\n    bid.hratio = parseInt(bid.hratio, 10);\n    return true;\n  }\n\n  const bidRequest = index.getBidRequest(bid);\n  const mediaTypes = index.getMediaTypes(bid);\n\n  const sizes = (bidRequest && bidRequest.sizes) || (mediaTypes && mediaTypes.banner && mediaTypes.banner.sizes);\n  const parsedSizes = parseSizesInput(sizes);\n\n  // if a banner impression has one valid size, we assign that size to any bid\n  // response that does not explicitly set width or height\n  if (parsedSizes.length === 1) {\n    const [ width, height ] = parsedSizes[0].split('x');\n    bid.width = parseInt(width, 10);\n    bid.height = parseInt(height, 10);\n    return true;\n  }\n\n  return false;\n}\n\n// Validate the arguments sent to us by the adapter. If this returns false, the bid should be totally ignored.\nexport function isValid(adUnitCode, bid, {index = auctionManager.index} = {}) {\n  function hasValidKeys() {\n    let bidKeys = Object.keys(bid);\n    return COMMON_BID_RESPONSE_KEYS.every(key => includes(bidKeys, key) && !includes([undefined, null], bid[key]));\n  }\n\n  function errorMessage(msg) {\n    return `Invalid bid from ${bid.bidderCode}. Ignoring bid: ${msg}`;\n  }\n\n  if (!adUnitCode) {\n    logWarn('No adUnitCode was supplied to addBidResponse.');\n    return false;\n  }\n\n  if (!bid) {\n    logWarn(`Some adapter tried to add an undefined bid for ${adUnitCode}.`);\n    return false;\n  }\n\n  if (!hasValidKeys()) {\n    logError(errorMessage(`Bidder ${bid.bidderCode} is missing required params. Check http://prebid.org/dev-docs/bidder-adapter-1.html for list of params.`));\n    return false;\n  }\n\n  if (FEATURES.NATIVE && bid.mediaType === 'native' && !nativeBidIsValid(bid, {index})) {\n    logError(errorMessage('Native bid missing some required properties.'));\n    return false;\n  }\n  if (FEATURES.VIDEO && bid.mediaType === 'video' && !isValidVideoBid(bid, {index})) {\n    logError(errorMessage(`Video bid does not have required vastUrl or renderer property`));\n    return false;\n  }\n  if (bid.mediaType === 'banner' && !validBidSize(adUnitCode, bid, {index})) {\n    logError(errorMessage(`Banner bids require a width and height`));\n    return false;\n  }\n\n  return true;\n}\n\nexport function adapterMetrics(bidderRequest) {\n  return useMetrics(bidderRequest.metrics).renameWith(n => [`adapter.client.${n}`, `adapters.client.${bidderRequest.bidderCode}.${n}`])\n}\n","import { LOAD_EXTERNAL_SCRIPT } from './activities/activities.js';\nimport { activityParams } from './activities/activityParams.js';\nimport { isActivityAllowed } from './activities/rules.js';\nimport { includes } from './polyfill.js';\nimport { insertElement, logError, logWarn, setScriptAttributes } from './utils.js';\n\nconst _requestCache = new WeakMap();\n// The below list contains modules or vendors whom Prebid allows to load external JS.\nconst _approvedLoadExternalJSList = [\n  // Prebid maintained modules:\n  'debugging',\n  'outstream',\n  // RTD modules:\n  'aaxBlockmeter',\n  'adagio',\n  'adloox',\n  'akamaidap',\n  'arcspan',\n  'airgrid',\n  'browsi',\n  'brandmetrics',\n  'clean.io',\n  'humansecurity',\n  'confiant',\n  'contxtful',\n  'hadron',\n  'mediafilter',\n  'medianet',\n  'azerionedge',\n  'a1Media',\n  'geoedge',\n  'qortex',\n  'dynamicAdBoost',\n  '51Degrees',\n  'symitridap',\n  'wurfl',\n  'nodalsAi',\n  'anonymised',\n  'optable',\n  // UserId Submodules\n  'justtag',\n  'tncId',\n  'ftrackId',\n  'id5',\n];\n\n/**\n * Loads external javascript. Can only be used if external JS is approved by Prebid. See https://github.com/prebid/prebid-js-external-js-template#policy\n * Each unique URL will be loaded at most 1 time.\n * @param {string} url the url to load\n * @param {string} moduleType moduleType of the module requesting this resource\n * @param {string} moduleCode bidderCode or module code of the module requesting this resource\n * @param {function} [callback] callback function to be called after the script is loaded\n * @param {Document} [doc] the context document, in which the script will be loaded, defaults to loaded document\n * @param {object} attributes an object of attributes to be added to the script with setAttribute by [key] and [value]; Only the attributes passed in the first request of a url will be added.\n */\nexport function loadExternalScript(url, moduleType, moduleCode, callback, doc, attributes) {\n  if (!isActivityAllowed(LOAD_EXTERNAL_SCRIPT, activityParams(moduleType, moduleCode))) {\n    return;\n  }\n\n  if (!moduleCode || !url) {\n    logError('cannot load external script without url and moduleCode');\n    return;\n  }\n  if (!includes(_approvedLoadExternalJSList, moduleCode)) {\n    logError(`${moduleCode} not whitelisted for loading external JavaScript`);\n    return;\n  }\n  if (!doc) {\n    doc = document; // provide a \"valid\" key for the WeakMap\n  }\n  // only load each asset once\n  const storedCachedObject = getCacheObject(doc, url);\n  if (storedCachedObject) {\n    if (callback && typeof callback === 'function') {\n      if (storedCachedObject.loaded) {\n        // invokeCallbacks immediately\n        callback();\n      } else {\n        // queue the callback\n        storedCachedObject.callbacks.push(callback);\n      }\n    }\n    return storedCachedObject.tag;\n  }\n  const cachedDocObj = _requestCache.get(doc) || {};\n  const cacheObject = {\n    loaded: false,\n    tag: null,\n    callbacks: []\n  };\n  cachedDocObj[url] = cacheObject;\n  _requestCache.set(doc, cachedDocObj);\n\n  if (callback && typeof callback === 'function') {\n    cacheObject.callbacks.push(callback);\n  }\n\n  logWarn(`module ${moduleCode} is loading external JavaScript`);\n  return requestResource(url, function () {\n    cacheObject.loaded = true;\n    try {\n      for (let i = 0; i < cacheObject.callbacks.length; i++) {\n        cacheObject.callbacks[i]();\n      }\n    } catch (e) {\n      logError('Error executing callback', 'adloader.js:loadExternalScript', e);\n    }\n  }, doc, attributes);\n\n  function requestResource(tagSrc, callback, doc, attributes) {\n    if (!doc) {\n      doc = document;\n    }\n    var jptScript = doc.createElement('script');\n    jptScript.type = 'text/javascript';\n    jptScript.async = true;\n\n    const cacheObject = getCacheObject(doc, url);\n    if (cacheObject) {\n      cacheObject.tag = jptScript;\n    }\n\n    if (jptScript.readyState) {\n      jptScript.onreadystatechange = function () {\n        if (jptScript.readyState === 'loaded' || jptScript.readyState === 'complete') {\n          jptScript.onreadystatechange = null;\n          callback();\n        }\n      };\n    } else {\n      jptScript.onload = function () {\n        callback();\n      };\n    }\n\n    jptScript.src = tagSrc;\n\n    if (attributes) {\n      setScriptAttributes(jptScript, attributes);\n    }\n\n    // add the new script tag to the page\n    insertElement(jptScript, doc);\n\n    return jptScript;\n  }\n  function getCacheObject(doc, url) {\n    const cachedDocObj = _requestCache.get(doc);\n    if (cachedDocObj && cachedDocObj[url]) {\n      return cachedDocObj[url];\n    }\n    return null; // return new cache object?\n  }\n};\n","import {config} from './config.js';\nimport {buildUrl, logError, parseUrl} from './utils.js';\n\nexport const dep = {\n  fetch: window.fetch.bind(window),\n  makeRequest: (r, o) => new Request(r, o),\n  timeout(timeout, resource) {\n    const ctl = new AbortController();\n    let cancelTimer = setTimeout(() => {\n      ctl.abort();\n      logError(`Request timeout after ${timeout}ms`, resource);\n      cancelTimer = null;\n    }, timeout);\n    return {\n      signal: ctl.signal,\n      done() {\n        cancelTimer && clearTimeout(cancelTimer)\n      }\n    }\n  }\n}\n\nconst GET = 'GET';\nconst POST = 'POST';\nconst CTYPE = 'Content-Type';\n\n/**\n * transform legacy `ajax` parameters into a fetch request.\n * @returns {Request}\n */\nexport function toFetchRequest(url, data, options = {}) {\n  const method = options.method || (data ? POST : GET);\n  if (method === GET && data) {\n    const urlInfo = parseUrl(url, options);\n    Object.assign(urlInfo.search, data);\n    url = buildUrl(urlInfo);\n  }\n  const headers = new Headers(options.customHeaders);\n  headers.set(CTYPE, options.contentType || 'text/plain');\n  const rqOpts = {\n    method,\n    headers\n  }\n  if (method !== GET && data) {\n    rqOpts.body = data;\n  }\n  if (options.withCredentials) {\n    rqOpts.credentials = 'include';\n  }\n  if (isSecureContext) {\n    ['browsingTopics', 'adAuctionHeaders'].forEach(opt => {\n      // the Request constructor will throw an exception if the browser supports topics/fledge\n      // but we're not in a secure context\n      if (options[opt]) {\n        rqOpts[opt] = true;\n      }\n    })\n  }\n  if (options.keepalive) {\n    rqOpts.keepalive = true;\n  }\n  return dep.makeRequest(url, rqOpts);\n}\n\n/**\n * Return a version of `fetch` that automatically cancels requests after `timeout` milliseconds.\n *\n * If provided, `request` and `done` should be functions accepting a single argument.\n * `request` is invoked at the beginning of each request, and `done` at the end; both are passed its origin.\n *\n * @returns {function(*, {}?): Promise<Response>}\n */\nexport function fetcherFactory(timeout = 3000, {request, done} = {}) {\n  let fetcher = (resource, options) => {\n    let to;\n    if (timeout != null && options?.signal == null && !config.getConfig('disableAjaxTimeout')) {\n      to = dep.timeout(timeout, resource);\n      options = Object.assign({signal: to.signal}, options);\n    }\n    let pm = dep.fetch(resource, options);\n    if (to?.done != null) pm = pm.finally(to.done);\n    return pm;\n  };\n\n  if (request != null || done != null) {\n    fetcher = ((fetch) => function (resource, options) {\n      const origin = new URL(resource?.url == null ? resource : resource.url, document.location).origin;\n      let req = fetch(resource, options);\n      request && request(origin);\n      if (done) req = req.finally(() => done(origin));\n      return req;\n    })(fetcher);\n  }\n  return fetcher;\n}\n\nfunction toXHR({status, statusText = '', headers, url}, responseText) {\n  let xml = 0;\n  function getXML(onError) {\n    if (xml === 0) {\n      try {\n        xml = new DOMParser().parseFromString(responseText, headers?.get(CTYPE)?.split(';')?.[0])\n      } catch (e) {\n        xml = null;\n        onError && onError(e)\n      }\n    }\n    return xml;\n  }\n  return {\n    // eslint-disable-next-line no-restricted-globals\n    readyState: XMLHttpRequest.DONE,\n    status,\n    statusText,\n    responseText,\n    response: responseText,\n    responseType: '',\n    responseURL: url,\n    get responseXML() {\n      return getXML(logError);\n    },\n    getResponseHeader: (header) => headers?.has(header) ? headers.get(header) : null,\n    toJSON() {\n      return Object.assign({responseXML: getXML()}, this)\n    },\n    timedOut: false\n  }\n}\n\n/**\n * attach legacy `ajax` callbacks to a fetch promise.\n */\nexport function attachCallbacks(fetchPm, callback) {\n  const {success, error} = typeof callback === 'object' && callback != null ? callback : {\n    success: typeof callback === 'function' ? callback : () => null,\n    error: (e, x) => logError('Network error', e, x)\n  };\n  return fetchPm.then(response => response.text().then((responseText) => [response, responseText]))\n    .then(([response, responseText]) => {\n      const xhr = toXHR(response, responseText);\n      response.ok || response.status === 304 ? success(responseText, xhr) : error(response.statusText, xhr);\n    }, (reason) => error('', Object.assign(\n      toXHR({status: 0}, ''),\n      {reason, timedOut: reason?.name === 'AbortError'}))\n    );\n}\n\nexport function ajaxBuilder(timeout = 3000, {request, done} = {}) {\n  const fetcher = fetcherFactory(timeout, {request, done});\n  return function (url, callback, data, options = {}) {\n    attachCallbacks(fetcher(toFetchRequest(url, data, options)), callback);\n  };\n}\n\n/**\n * simple wrapper around sendBeacon such that invocations of navigator.sendBeacon can be centrally maintained.\n * verifies that the navigator and sendBeacon are defined for maximum compatibility\n * @param {string} url The URL that will receive the data. Can be relative or absolute.\n * @param {*} data An ArrayBuffer, a TypedArray, a DataView, a Blob, a string literal or object, a FormData or a URLSearchParams object containing the data to send.\n * @returns {boolean} true if the user agent successfully queued the data for transfer. Otherwise, it returns false.\n */\nexport function sendBeacon(url, data) {\n  if (!window.navigator || !window.navigator.sendBeacon) {\n    return false;\n  }\n  return window.navigator.sendBeacon(url, data);\n}\n\nexport const ajax = ajaxBuilder();\nexport const fetch = fetcherFactory();\n","/**\n * Module for auction instances.\n *\n * In Prebid 0.x, $$PREBID_GLOBAL$$ had _bidsRequested and _bidsReceived as public properties.\n * Starting 1.0, Prebid will support concurrent auctions. Each auction instance will store private properties, bidsRequested and bidsReceived.\n *\n * AuctionManager will create an instance of auction and will store all the auctions.\n *\n */\n\n/**\n * @typedef {import('../src/adapters/bidderFactory.js').BidRequest} BidRequest\n * @typedef {import('../src/adapters/bidderFactory.js').Bid} Bid\n * @typedef {import('../src/config.js').MediaTypePriceGranularity} MediaTypePriceGranularity\n * @typedef {import('../src/mediaTypes.js').MediaType} MediaType\n */\n\n/**\n * @typedef {Object} AdUnit An object containing the adUnit configuration.\n *\n * @property {string} code A code which will be used to uniquely identify this bidder. This should be the same\n *   one as is used in the call to registerBidAdapter\n * @property {Array.<size>} sizes A list of size for adUnit.\n * @property {object} params Any bidder-specific params which the publisher used in their bid request.\n *   This is guaranteed to have passed the spec.areParamsValid() test.\n */\n\n/**\n * @typedef {Array.<number>} size\n */\n\n/**\n * @typedef {Array.<string>} AdUnitCode\n */\n\n/**\n * @typedef {Object} BidderRequest\n *\n * @property {string} bidderCode - adUnit bidder\n * @property {number} auctionId - random UUID\n * @property {string} bidderRequestId - random string, unique key set on all bidRequest.bids[]\n * @property {Array.<Bid>} bids\n * @property {number} auctionStart - Date.now() at auction start\n * @property {number} timeout - callback timeout\n * @property {refererInfo} refererInfo - referer info object\n * @property {string} [tid] - random UUID (used for s2s)\n * @property {string} [src] - s2s or client (used for s2s)\n * @property {import('./types/ortb2.js').Ortb2.BidRequest} [ortb2] Global (not specific to any adUnit) first party data to use for all requests in this auction.\n */\n\n/**\n * @typedef {Object} BidReceived\n * //TODO add all properties\n */\n\n/**\n * @typedef {Object} Auction\n *\n * @property {function(): string} getAuctionStatus - returns the auction status which can be any one of 'started', 'in progress' or 'completed'\n * @property {function(): AdUnit[]} getAdUnits - return the adUnits for this auction instance\n * @property {function(): AdUnitCode[]} getAdUnitCodes - return the adUnitCodes for this auction instance\n * @property {function(): BidRequest[]} getBidRequests - get all bid requests for this auction instance\n * @property {function(): BidReceived[]} getBidsReceived - get all bid received for this auction instance\n * @property {function(): void} startAuctionTimer - sets the bidsBackHandler callback and starts the timer for auction\n * @property {function(): void} callBids - sends requests to all adapters for bids\n */\n\nimport {\n  generateUUID,\n  isEmpty,\n  isEmptyStr,\n  isFn,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  parseUrl,\n  timestamp\n} from './utils.js';\nimport {getPriceBucketString} from './cpmBucketManager.js';\nimport {getNativeTargeting, isNativeResponse, setNativeResponseProperties} from './native.js';\nimport {batchAndStore, storeLocally} from './videoCache.js';\nimport {Renderer} from './Renderer.js';\nimport {config} from './config.js';\nimport {userSync} from './userSync.js';\nimport {hook} from './hook.js';\nimport {find, includes} from './polyfill.js';\nimport {OUTSTREAM} from './video.js';\nimport {VIDEO} from './mediaTypes.js';\nimport {auctionManager} from './auctionManager.js';\nimport {bidderSettings} from './bidderSettings.js';\nimport * as events from './events.js';\nimport adapterManager from './adapterManager.js';\nimport {EVENTS, GRANULARITY_OPTIONS, JSON_MAPPING, REJECTION_REASON, S2S, TARGETING_KEYS} from './constants.js';\nimport {defer, PbPromise} from './utils/promise.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {adjustCpm} from './utils/cpm.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport {ttlCollection} from './utils/ttlCollection.js';\nimport {getMinBidCacheTTL, onMinBidCacheTTLChange} from './bidTTL.js';\n\nconst { syncUsers } = userSync;\n\nexport const AUCTION_STARTED = 'started';\nexport const AUCTION_IN_PROGRESS = 'inProgress';\nexport const AUCTION_COMPLETED = 'completed';\n\n// register event for bid adjustment\nevents.on(EVENTS.BID_ADJUSTMENT, function (bid) {\n  adjustBids(bid);\n});\n\nconst MAX_REQUESTS_PER_ORIGIN = 4;\nconst outstandingRequests = {};\nconst sourceInfo = {};\nconst queuedCalls = [];\n\nconst pbjsInstance = getGlobal();\n\n/**\n * Clear global state for tests\n */\nexport function resetAuctionState() {\n  queuedCalls.length = 0;\n  [outstandingRequests, sourceInfo].forEach((ob) => Object.keys(ob).forEach((k) => { delete ob[k] }));\n}\n\n/**\n * Creates new auction instance\n *\n * @param {Object} requestConfig\n * @param {AdUnit} requestConfig.adUnits\n * @param {AdUnitCode} requestConfig.adUnitCodes\n * @param {function():void} requestConfig.callback\n * @param {number} requestConfig.cbTimeout\n * @param {Array.<string>} requestConfig.labels\n * @param {string} requestConfig.auctionId\n * @param {{global: {}, bidder: {}}} requestConfig.ortb2Fragments first party data, separated into global\n *    (from getConfig('ortb2') + requestBids({ortb2})) and bidder (a map from bidderCode to ortb2)\n * @param {Object} requestConfig.metrics\n * @returns {Auction} auction instance\n */\nexport function newAuction({adUnits, adUnitCodes, callback, cbTimeout, labels, auctionId, ortb2Fragments, metrics}) {\n  metrics = useMetrics(metrics);\n  const _adUnits = adUnits;\n  const _labels = labels;\n  const _adUnitCodes = adUnitCodes;\n  const _auctionId = auctionId || generateUUID();\n  const _timeout = cbTimeout;\n  const _timelyRequests = new Set();\n  const done = defer();\n  const requestsDone = defer();\n  let _bidsRejected = [];\n  let _callback = callback;\n  let _bidderRequests = [];\n  let _bidsReceived = ttlCollection({\n    startTime: (bid) => bid.responseTimestamp,\n    ttl: (bid) => getMinBidCacheTTL() == null ? null : Math.max(getMinBidCacheTTL(), bid.ttl) * 1000\n  });\n  let _noBids = [];\n  let _winningBids = [];\n  let _auctionStart;\n  let _auctionEnd;\n  let _timeoutTimer;\n  let _auctionStatus;\n  let _nonBids = [];\n\n  onMinBidCacheTTLChange(() => _bidsReceived.refresh());\n\n  function addBidRequests(bidderRequests) { _bidderRequests = _bidderRequests.concat(bidderRequests); }\n  function addBidReceived(bid) { _bidsReceived.add(bid); }\n  function addBidRejected(bidsRejected) { _bidsRejected = _bidsRejected.concat(bidsRejected); }\n  function addNoBid(noBid) { _noBids = _noBids.concat(noBid); }\n  function addNonBids(seatnonbids) { _nonBids = _nonBids.concat(seatnonbids); }\n\n  function getProperties() {\n    return {\n      auctionId: _auctionId,\n      timestamp: _auctionStart,\n      auctionEnd: _auctionEnd,\n      auctionStatus: _auctionStatus,\n      adUnits: _adUnits,\n      adUnitCodes: _adUnitCodes,\n      labels: _labels,\n      bidderRequests: _bidderRequests,\n      noBids: _noBids,\n      bidsReceived: _bidsReceived.toArray(),\n      bidsRejected: _bidsRejected,\n      winningBids: _winningBids,\n      timeout: _timeout,\n      metrics: metrics,\n      seatNonBids: _nonBids\n    };\n  }\n\n  function startAuctionTimer() {\n    _timeoutTimer = setTimeout(() => executeCallback(true), _timeout);\n  }\n\n  function executeCallback(timedOut) {\n    if (!timedOut) {\n      clearTimeout(_timeoutTimer);\n    } else {\n      events.emit(EVENTS.AUCTION_TIMEOUT, getProperties());\n    }\n    if (_auctionEnd === undefined) {\n      let timedOutRequests = [];\n      if (timedOut) {\n        logMessage(`Auction ${_auctionId} timedOut`);\n        timedOutRequests = _bidderRequests.filter(rq => !_timelyRequests.has(rq.bidderRequestId)).flatMap(br => br.bids)\n        if (timedOutRequests.length) {\n          events.emit(EVENTS.BID_TIMEOUT, timedOutRequests);\n        }\n      }\n\n      _auctionStatus = AUCTION_COMPLETED;\n      _auctionEnd = Date.now();\n      metrics.checkpoint('auctionEnd');\n      metrics.timeBetween('requestBids', 'auctionEnd', 'requestBids.total');\n      metrics.timeBetween('callBids', 'auctionEnd', 'requestBids.callBids');\n      done.resolve();\n\n      events.emit(EVENTS.AUCTION_END, getProperties());\n      bidsBackCallback(_adUnits, function () {\n        try {\n          if (_callback != null) {\n            const bids = _bidsReceived.toArray()\n              .filter(bid => _adUnitCodes.includes(bid.adUnitCode))\n              .reduce(groupByPlacement, {});\n            _callback.apply(pbjsInstance, [bids, timedOut, _auctionId]);\n            _callback = null;\n          }\n        } catch (e) {\n          logError('Error executing bidsBackHandler', null, e);\n        } finally {\n          // Calling timed out bidders\n          if (timedOutRequests.length) {\n            adapterManager.callTimedOutBidders(adUnits, timedOutRequests, _timeout);\n          }\n          // Only automatically sync if the publisher has not chosen to \"enableOverride\"\n          let userSyncConfig = config.getConfig('userSync') || {};\n          if (!userSyncConfig.enableOverride) {\n            // Delay the auto sync by the config delay\n            syncUsers(userSyncConfig.syncDelay);\n          }\n        }\n      })\n    }\n  }\n\n  function auctionDone() {\n    config.resetBidder();\n    // when all bidders have called done callback atleast once it means auction is complete\n    logInfo(`Bids Received for Auction with id: ${_auctionId}`, _bidsReceived.toArray());\n    _auctionStatus = AUCTION_COMPLETED;\n    executeCallback(false);\n  }\n\n  function onTimelyResponse(bidderRequestId) {\n    _timelyRequests.add(bidderRequestId);\n  }\n\n  function callBids() {\n    _auctionStatus = AUCTION_STARTED;\n    _auctionStart = Date.now();\n\n    let bidRequests = metrics.measureTime('requestBids.makeRequests',\n      () => adapterManager.makeBidRequests(_adUnits, _auctionStart, _auctionId, _timeout, _labels, ortb2Fragments, metrics));\n    logInfo(`Bids Requested for Auction with id: ${_auctionId}`, bidRequests);\n\n    metrics.checkpoint('callBids')\n\n    if (bidRequests.length < 1) {\n      logWarn('No valid bid requests returned for auction');\n      auctionDone();\n    } else {\n      addBidderRequests.call({\n        dispatch: addBidderRequestsCallback,\n        context: this\n      }, bidRequests);\n    }\n  }\n\n  /**\n   * callback executed after addBidderRequests completes\n   * @param {BidRequest[]} bidRequests\n   */\n  function addBidderRequestsCallback(bidRequests) {\n    bidRequests.forEach(bidRequest => {\n      addBidRequests(bidRequest);\n    });\n\n    let requests = {};\n    let call = {\n      bidRequests,\n      run: () => {\n        startAuctionTimer();\n\n        _auctionStatus = AUCTION_IN_PROGRESS;\n\n        events.emit(EVENTS.AUCTION_INIT, getProperties());\n\n        let callbacks = auctionCallbacks(auctionDone, this);\n        adapterManager.callBids(_adUnits, bidRequests, callbacks.addBidResponse, callbacks.adapterDone, {\n          request(source, origin) {\n            increment(outstandingRequests, origin);\n            increment(requests, source);\n\n            if (!sourceInfo[source]) {\n              sourceInfo[source] = {\n                SRA: true,\n                origin\n              };\n            }\n            if (requests[source] > 1) {\n              sourceInfo[source].SRA = false;\n            }\n          },\n          done(origin) {\n            outstandingRequests[origin]--;\n            if (queuedCalls[0]) {\n              if (runIfOriginHasCapacity(queuedCalls[0])) {\n                queuedCalls.shift();\n              }\n            }\n          }\n        }, _timeout, onTimelyResponse, ortb2Fragments);\n        requestsDone.resolve();\n      }\n    };\n\n    if (!runIfOriginHasCapacity(call)) {\n      logWarn('queueing auction due to limited endpoint capacity');\n      queuedCalls.push(call);\n    }\n\n    function runIfOriginHasCapacity(call) {\n      let hasCapacity = true;\n\n      let maxRequests = config.getConfig('maxRequestsPerOrigin') || MAX_REQUESTS_PER_ORIGIN;\n\n      call.bidRequests.some(bidRequest => {\n        let requests = 1;\n        let source = (typeof bidRequest.src !== 'undefined' && bidRequest.src === S2S.SRC) ? 's2s'\n          : bidRequest.bidderCode;\n        // if we have no previous info on this source just let them through\n        if (sourceInfo[source]) {\n          if (sourceInfo[source].SRA === false) {\n            // some bidders might use more than the MAX_REQUESTS_PER_ORIGIN in a single auction.  In those cases\n            // set their request count to MAX_REQUESTS_PER_ORIGIN so the auction isn't permanently queued waiting\n            // for capacity for that bidder\n            requests = Math.min(bidRequest.bids.length, maxRequests);\n          }\n          if (outstandingRequests[sourceInfo[source].origin] + requests > maxRequests) {\n            hasCapacity = false;\n          }\n        }\n        // return only used for terminating this .some() iteration early if it is determined we don't have capacity\n        return !hasCapacity;\n      });\n\n      if (hasCapacity) {\n        call.run();\n      }\n\n      return hasCapacity;\n    }\n\n    function increment(obj, prop) {\n      if (typeof obj[prop] === 'undefined') {\n        obj[prop] = 1\n      } else {\n        obj[prop]++;\n      }\n    }\n  }\n\n  function addWinningBid(winningBid) {\n    _winningBids = _winningBids.concat(winningBid);\n    adapterManager.callBidWonBidder(winningBid.adapterCode || winningBid.bidder, winningBid, adUnits);\n    if (!winningBid.deferBilling) {\n      adapterManager.triggerBilling(winningBid)\n    }\n  }\n\n  function setBidTargeting(bid) {\n    adapterManager.callSetTargetingBidder(bid.adapterCode || bid.bidder, bid);\n  }\n\n  events.on(EVENTS.SEAT_NON_BID, (event) => {\n    if (event.auctionId === _auctionId) {\n      addNonBids(event.seatnonbid)\n    }\n  });\n\n  return {\n    addBidReceived,\n    addBidRejected,\n    addNoBid,\n    callBids,\n    addWinningBid,\n    setBidTargeting,\n    getWinningBids: () => _winningBids,\n    getAuctionStart: () => _auctionStart,\n    getAuctionEnd: () => _auctionEnd,\n    getTimeout: () => _timeout,\n    getAuctionId: () => _auctionId,\n    getAuctionStatus: () => _auctionStatus,\n    getAdUnits: () => _adUnits,\n    getAdUnitCodes: () => _adUnitCodes,\n    getBidRequests: () => _bidderRequests,\n    getBidsReceived: () => _bidsReceived.toArray(),\n    getNoBids: () => _noBids,\n    getNonBids: () => _nonBids,\n    getFPD: () => ortb2Fragments,\n    getMetrics: () => metrics,\n    end: done.promise,\n    requestsDone: requestsDone.promise,\n    getProperties\n  };\n}\n\n/**\n * Hook into this to intercept bids before they are added to an auction.\n *\n * @type {Function}\n * @param adUnitCode\n * @param bid\n * @param {function(String): void} reject a function that, when called, rejects `bid` with the given reason.\n */\nexport const addBidResponse = hook('sync', function(adUnitCode, bid, reject) {\n  if (!isValidPrice(bid)) {\n    reject(REJECTION_REASON.PRICE_TOO_HIGH)\n  } else {\n    this.dispatch.call(null, adUnitCode, bid);\n  }\n}, 'addBidResponse');\n\n/**\n * Delay hook for adapter responses.\n *\n * `ready` is a promise; auctions wait for it to resolve before closing. Modules can hook into this\n * to delay the end of auctions while they perform initialization that does not need to delay their start.\n */\nexport const responsesReady = hook('sync', (ready) => ready, 'responsesReady');\n\nexport const addBidderRequests = hook('sync', function(bidderRequests) {\n  this.dispatch.call(this.context, bidderRequests);\n}, 'addBidderRequests');\n\nexport const bidsBackCallback = hook('async', function (adUnits, callback) {\n  if (callback) {\n    callback();\n  }\n}, 'bidsBackCallback');\n\nexport function auctionCallbacks(auctionDone, auctionInstance, {index = auctionManager.index} = {}) {\n  let outstandingBidsAdded = 0;\n  let allAdapterCalledDone = false;\n  let bidderRequestsDone = new Set();\n  let bidResponseMap = {};\n\n  function afterBidAdded() {\n    outstandingBidsAdded--;\n    if (allAdapterCalledDone && outstandingBidsAdded === 0) {\n      auctionDone()\n    }\n  }\n\n  function handleBidResponse(adUnitCode, bid, handler) {\n    bidResponseMap[bid.requestId] = true;\n    addCommonResponseProperties(bid, adUnitCode)\n    outstandingBidsAdded++;\n    return handler(afterBidAdded);\n  }\n\n  function acceptBidResponse(adUnitCode, bid) {\n    handleBidResponse(adUnitCode, bid, (done) => {\n      let bidResponse = getPreparedBidForAuction(bid);\n      events.emit(EVENTS.BID_ACCEPTED, bidResponse);\n      if (FEATURES.VIDEO && bidResponse.mediaType === VIDEO) {\n        tryAddVideoBid(auctionInstance, bidResponse, done);\n      } else {\n        if (FEATURES.NATIVE && isNativeResponse(bidResponse)) {\n          setNativeResponseProperties(bidResponse, index.getAdUnit(bidResponse));\n        }\n        addBidToAuction(auctionInstance, bidResponse);\n        done();\n      }\n    });\n  }\n\n  function rejectBidResponse(adUnitCode, bid, reason) {\n    return handleBidResponse(adUnitCode, bid, (done) => {\n      bid.rejectionReason = reason;\n      logWarn(`Bid from ${bid.bidder || 'unknown bidder'} was rejected: ${reason}`, bid)\n      events.emit(EVENTS.BID_REJECTED, bid);\n      auctionInstance.addBidRejected(bid);\n      done();\n    })\n  }\n\n  function adapterDone() {\n    let bidderRequest = this;\n    let bidderRequests = auctionInstance.getBidRequests();\n    const auctionOptionsConfig = config.getConfig('auctionOptions');\n\n    bidderRequestsDone.add(bidderRequest);\n\n    if (auctionOptionsConfig && !isEmpty(auctionOptionsConfig)) {\n      const secondaryBidders = auctionOptionsConfig.secondaryBidders;\n      if (secondaryBidders && !bidderRequests.every(bidder => includes(secondaryBidders, bidder.bidderCode))) {\n        bidderRequests = bidderRequests.filter(request => !includes(secondaryBidders, request.bidderCode));\n      }\n    }\n\n    allAdapterCalledDone = bidderRequests.every(bidderRequest => bidderRequestsDone.has(bidderRequest));\n\n    bidderRequest.bids.forEach(bid => {\n      if (!bidResponseMap[bid.bidId]) {\n        auctionInstance.addNoBid(bid);\n        events.emit(EVENTS.NO_BID, bid);\n      }\n    });\n\n    if (allAdapterCalledDone && outstandingBidsAdded === 0) {\n      auctionDone();\n    }\n  }\n\n  return {\n    addBidResponse: (function () {\n      function addBid(adUnitCode, bid) {\n        addBidResponse.call({\n          dispatch: acceptBidResponse,\n        }, adUnitCode, bid, (() => {\n          let rejected = false;\n          return (reason) => {\n            if (!rejected) {\n              rejectBidResponse(adUnitCode, bid, reason);\n              rejected = true;\n            }\n          }\n        })())\n      }\n      addBid.reject = rejectBidResponse;\n      return addBid;\n    })(),\n    adapterDone: function () {\n      responsesReady(PbPromise.resolve()).finally(() => adapterDone.call(this));\n    }\n  }\n}\n\n// Add a bid to the auction.\nexport function addBidToAuction(auctionInstance, bidResponse) {\n  setupBidTargeting(bidResponse);\n\n  useMetrics(bidResponse.metrics).timeSince('addBidResponse', 'addBidResponse.total');\n  auctionInstance.addBidReceived(bidResponse);\n  events.emit(EVENTS.BID_RESPONSE, bidResponse);\n}\n\n// Video bids may fail if the cache is down, or there's trouble on the network.\nfunction tryAddVideoBid(auctionInstance, bidResponse, afterBidAdded, {index = auctionManager.index} = {}) {\n  let addBid = true;\n\n  const videoMediaType = index.getMediaTypes({\n    requestId: bidResponse.originalRequestId || bidResponse.requestId,\n    adUnitId: bidResponse.adUnitId\n  })?.video;\n  const context = videoMediaType && videoMediaType?.context;\n  const useCacheKey = videoMediaType && videoMediaType?.useCacheKey;\n  const {\n    useLocal,\n    url: cacheUrl,\n    ignoreBidderCacheKey\n  } = config.getConfig('cache') || {};\n\n  if (useLocal) {\n    // stores video bid vast as local blob in the browser\n    storeLocally(bidResponse);\n  } else if (cacheUrl && (useCacheKey || context !== OUTSTREAM)) {\n    if (!bidResponse.videoCacheKey || ignoreBidderCacheKey) {\n      addBid = false;\n      callPrebidCache(auctionInstance, bidResponse, afterBidAdded, videoMediaType);\n    } else if (!bidResponse.vastUrl) {\n      logError('videoCacheKey specified but not required vastUrl for video bid');\n      addBid = false;\n    }\n  }\n\n  if (addBid) {\n    addBidToAuction(auctionInstance, bidResponse);\n    afterBidAdded();\n  }\n}\n\nexport const callPrebidCache = hook('async', function(auctionInstance, bidResponse, afterBidAdded, videoMediaType) {\n  if (FEATURES.VIDEO) {\n    batchAndStore(auctionInstance, bidResponse, afterBidAdded);\n  }\n}, 'callPrebidCache');\n\n/**\n * Augment `bidResponse` with properties that are common across all bids - including rejected bids.\n *\n */\nfunction addCommonResponseProperties(bidResponse, adUnitCode, {index = auctionManager.index} = {}) {\n  const bidderRequest = index.getBidderRequest(bidResponse);\n  const adUnit = index.getAdUnit(bidResponse);\n  const start = (bidderRequest && bidderRequest.start) || bidResponse.requestTimestamp;\n\n  Object.assign(bidResponse, {\n    responseTimestamp: bidResponse.responseTimestamp || timestamp(),\n    requestTimestamp: bidResponse.requestTimestamp || start,\n    cpm: parseFloat(bidResponse.cpm) || 0,\n    bidder: bidResponse.bidder || bidResponse.bidderCode,\n    adUnitCode\n  });\n\n  if (adUnit?.ttlBuffer != null) {\n    bidResponse.ttlBuffer = adUnit.ttlBuffer;\n  }\n\n  bidResponse.timeToRespond = bidResponse.responseTimestamp - bidResponse.requestTimestamp;\n}\n\n/**\n * Add additional bid response properties that are universal for all _accepted_ bids.\n */\nfunction getPreparedBidForAuction(bid, {index = auctionManager.index} = {}) {\n  // Let listeners know that now is the time to adjust the bid, if they want to.\n  //\n  // CAREFUL: Publishers rely on certain bid properties to be available (like cpm),\n  // but others to not be set yet (like priceStrings). See #1372 and #1389.\n  events.emit(EVENTS.BID_ADJUSTMENT, bid);\n\n  const adUnit = index.getAdUnit(bid);\n  bid.instl = adUnit?.ortb2Imp?.instl === 1;\n\n  // a publisher-defined renderer can be used to render bids\n  const bidRenderer = index.getBidRequest(bid)?.renderer || adUnit.renderer;\n\n  // a publisher can also define a renderer for a mediaType\n  const bidObjectMediaType = bid.mediaType;\n  const mediaTypes = index.getMediaTypes(bid);\n  const bidMediaType = mediaTypes && mediaTypes[bidObjectMediaType];\n\n  var mediaTypeRenderer = bidMediaType && bidMediaType.renderer;\n\n  var renderer = null;\n\n  // the renderer for the mediaType takes precendence\n  if (mediaTypeRenderer && mediaTypeRenderer.render && !(mediaTypeRenderer.backupOnly === true && bid.renderer)) {\n    renderer = mediaTypeRenderer;\n  } else if (bidRenderer && bidRenderer.render && !(bidRenderer.backupOnly === true && bid.renderer)) {\n    renderer = bidRenderer;\n  }\n\n  if (renderer) {\n    // be aware, an adapter could already have installed the bidder, in which case this overwrite's the existing adapter\n    bid.renderer = Renderer.install({ url: renderer.url, config: renderer.options, renderNow: renderer.url == null });// rename options to config, to make it consistent?\n    bid.renderer.setRender(renderer.render);\n  }\n\n  // Use the config value 'mediaTypeGranularity' if it has been defined for mediaType, else use 'customPriceBucket'\n  const mediaTypeGranularity = getMediaTypeGranularity(bid.mediaType, mediaTypes, config.getConfig('mediaTypePriceGranularity'));\n  const priceStringsObj = getPriceBucketString(\n    bid.cpm,\n    (typeof mediaTypeGranularity === 'object') ? mediaTypeGranularity : config.getConfig('customPriceBucket'),\n    config.getConfig('currency.granularityMultiplier')\n  );\n  bid.pbLg = priceStringsObj.low;\n  bid.pbMg = priceStringsObj.med;\n  bid.pbHg = priceStringsObj.high;\n  bid.pbAg = priceStringsObj.auto;\n  bid.pbDg = priceStringsObj.dense;\n  bid.pbCg = priceStringsObj.custom;\n\n  return bid;\n}\n\nfunction setupBidTargeting(bidObject) {\n  let keyValues;\n  const cpmCheck = (bidderSettings.get(bidObject.bidderCode, 'allowZeroCpmBids') === true) ? bidObject.cpm >= 0 : bidObject.cpm > 0;\n  if (bidObject.bidderCode && (cpmCheck || bidObject.dealId)) {\n    keyValues = getKeyValueTargetingPairs(bidObject.bidderCode, bidObject);\n  }\n\n  // use any targeting provided as defaults, otherwise just set from getKeyValueTargetingPairs\n  bidObject.adserverTargeting = Object.assign(bidObject.adserverTargeting || {}, keyValues);\n}\n\n/**\n * @param {MediaType} mediaType\n * @param mediaTypes media types map from adUnit\n * @param {MediaTypePriceGranularity} [mediaTypePriceGranularity]\n * @returns {(Object|string|undefined)}\n */\nexport function getMediaTypeGranularity(mediaType, mediaTypes, mediaTypePriceGranularity) {\n  if (mediaType && mediaTypePriceGranularity) {\n    if (FEATURES.VIDEO && mediaType === VIDEO) {\n      const context = mediaTypes?.[VIDEO]?.context ?? 'instream';\n      if (mediaTypePriceGranularity[`${VIDEO}-${context}`]) {\n        return mediaTypePriceGranularity[`${VIDEO}-${context}`];\n      }\n    }\n    return mediaTypePriceGranularity[mediaType];\n  }\n}\n\n/**\n * This function returns the price granularity defined. It can be either publisher defined or default value\n * @param {Bid} bid bid response object\n * @param {object} obj\n * @param {object} obj.index\n * @returns {string} granularity\n */\nexport const getPriceGranularity = (bid, {index = auctionManager.index} = {}) => {\n  // Use the config value 'mediaTypeGranularity' if it has been set for mediaType, else use 'priceGranularity'\n  const mediaTypeGranularity = getMediaTypeGranularity(bid.mediaType, index.getMediaTypes(bid), config.getConfig('mediaTypePriceGranularity'));\n  const granularity = (typeof bid.mediaType === 'string' && mediaTypeGranularity) ? ((typeof mediaTypeGranularity === 'string') ? mediaTypeGranularity : 'custom') : config.getConfig('priceGranularity');\n  return granularity;\n}\n\n/**\n * This function returns a function to get bid price by price granularity\n * @param {string} granularity\n * @returns {function}\n */\nexport const getPriceByGranularity = (granularity) => {\n  return (bid) => {\n    const bidGranularity = granularity || getPriceGranularity(bid);\n    if (bidGranularity === GRANULARITY_OPTIONS.AUTO) {\n      return bid.pbAg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.DENSE) {\n      return bid.pbDg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.LOW) {\n      return bid.pbLg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.MEDIUM) {\n      return bid.pbMg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.HIGH) {\n      return bid.pbHg;\n    } else if (bidGranularity === GRANULARITY_OPTIONS.CUSTOM) {\n      return bid.pbCg;\n    }\n  }\n}\n\n/**\n * This function returns a function to get crid from bid response\n * @returns {function}\n */\nexport const getCreativeId = () => {\n  return (bid) => {\n    return (bid.creativeId) ? bid.creativeId : '';\n  }\n}\n\n/**\n * This function returns a function to get first advertiser domain from bid response meta\n * @returns {function}\n */\nexport const getAdvertiserDomain = () => {\n  return (bid) => {\n    return (bid.meta && bid.meta.advertiserDomains && bid.meta.advertiserDomains.length > 0) ? [bid.meta.advertiserDomains].flat()[0] : '';\n  }\n}\n\n/**\n * This function returns a function to get dsp name or id from bid response meta\n * @returns {function}\n */\nexport const getDSP = () => {\n  return (bid) => {\n    return (bid.meta && (bid.meta.networkId || bid.meta.networkName)) ? bid?.meta?.networkName || bid?.meta?.networkId : '';\n  }\n}\n\n/**\n * This function returns a function to get the primary category id from bid response meta\n * @returns {function}\n */\nexport const getPrimaryCatId = () => {\n  return (bid) => {\n    return (bid.meta && bid.meta.primaryCatId) ? bid.meta.primaryCatId : '';\n  }\n}\n\n// factory for key value objs\nfunction createKeyVal(key, value) {\n  return {\n    key,\n    val: (typeof value === 'function')\n      ? function (bidResponse, bidReq) {\n        return value(bidResponse, bidReq);\n      }\n      : function (bidResponse) {\n        return bidResponse[value];\n      }\n  };\n}\n\nfunction defaultAdserverTargeting() {\n  return [\n    createKeyVal(TARGETING_KEYS.BIDDER, 'bidderCode'),\n    createKeyVal(TARGETING_KEYS.AD_ID, 'adId'),\n    createKeyVal(TARGETING_KEYS.PRICE_BUCKET, getPriceByGranularity()),\n    createKeyVal(TARGETING_KEYS.SIZE, 'size'),\n    createKeyVal(TARGETING_KEYS.DEAL, 'dealId'),\n    createKeyVal(TARGETING_KEYS.SOURCE, 'source'),\n    createKeyVal(TARGETING_KEYS.FORMAT, 'mediaType'),\n    createKeyVal(TARGETING_KEYS.ADOMAIN, getAdvertiserDomain()),\n    createKeyVal(TARGETING_KEYS.ACAT, getPrimaryCatId()),\n    createKeyVal(TARGETING_KEYS.DSP, getDSP()),\n    createKeyVal(TARGETING_KEYS.CRID, getCreativeId()),\n  ]\n}\n\n/**\n * @param {string} mediaType\n * @param {string} bidderCode\n * @returns {*}\n */\nexport function getStandardBidderSettings(mediaType, bidderCode) {\n  const standardSettings = Object.assign({}, bidderSettings.settingsFor(null));\n  if (!standardSettings[JSON_MAPPING.ADSERVER_TARGETING]) {\n    standardSettings[JSON_MAPPING.ADSERVER_TARGETING] = defaultAdserverTargeting();\n  }\n\n  if (FEATURES.VIDEO && mediaType === 'video') {\n    const adserverTargeting = standardSettings[JSON_MAPPING.ADSERVER_TARGETING].slice();\n    standardSettings[JSON_MAPPING.ADSERVER_TARGETING] = adserverTargeting;\n\n    // Adding hb_uuid + hb_cache_id\n    [TARGETING_KEYS.UUID, TARGETING_KEYS.CACHE_ID].forEach(targetingKeyVal => {\n      if (typeof find(adserverTargeting, kvPair => kvPair.key === targetingKeyVal) === 'undefined') {\n        adserverTargeting.push(createKeyVal(targetingKeyVal, 'videoCacheKey'));\n      }\n    });\n\n    // Adding hb_cache_host\n    if (config.getConfig('cache.url') && (!bidderCode || bidderSettings.get(bidderCode, 'sendStandardTargeting') !== false)) {\n      const urlInfo = parseUrl(config.getConfig('cache.url'));\n\n      if (typeof find(adserverTargeting, targetingKeyVal => targetingKeyVal.key === TARGETING_KEYS.CACHE_HOST) === 'undefined') {\n        adserverTargeting.push(createKeyVal(TARGETING_KEYS.CACHE_HOST, function(bidResponse) {\n          return bidResponse?.adserverTargeting?.[TARGETING_KEYS.CACHE_HOST] || urlInfo.hostname;\n        }));\n      }\n    }\n  }\n\n  return standardSettings;\n}\n\nexport function getKeyValueTargetingPairs(bidderCode, custBidObj, {index = auctionManager.index} = {}) {\n  if (!custBidObj) {\n    return {};\n  }\n  const bidRequest = index.getBidRequest(custBidObj);\n  var keyValues = {};\n\n  // 1) set the keys from \"standard\" setting or from prebid defaults\n  // initialize default if not set\n  const standardSettings = getStandardBidderSettings(custBidObj.mediaType, bidderCode);\n  setKeys(keyValues, standardSettings, custBidObj, bidRequest);\n\n  // 2) set keys from specific bidder setting override if they exist\n  if (bidderCode && bidderSettings.getOwn(bidderCode, JSON_MAPPING.ADSERVER_TARGETING)) {\n    setKeys(keyValues, bidderSettings.ownSettingsFor(bidderCode), custBidObj, bidRequest);\n    custBidObj.sendStandardTargeting = bidderSettings.get(bidderCode, 'sendStandardTargeting');\n  }\n\n  // set native key value targeting\n  if (FEATURES.NATIVE && custBidObj['native']) {\n    keyValues = Object.assign({}, keyValues, getNativeTargeting(custBidObj));\n  }\n\n  return keyValues;\n}\n\nfunction setKeys(keyValues, bidderSettings, custBidObj, bidReq) {\n  var targeting = bidderSettings[JSON_MAPPING.ADSERVER_TARGETING];\n  custBidObj.size = custBidObj.getSize();\n\n  (targeting || []).forEach(function (kvPair) {\n    var key = kvPair.key;\n    var value = kvPair.val;\n\n    if (keyValues[key]) {\n      logWarn('The key: ' + key + ' is being overwritten');\n    }\n\n    if (isFn(value)) {\n      try {\n        value = value(custBidObj, bidReq);\n      } catch (e) {\n        logError('bidmanager', 'ERROR', e);\n      }\n    }\n\n    if (\n      ((typeof bidderSettings.suppressEmptyKeys !== 'undefined' && bidderSettings.suppressEmptyKeys === true) ||\n        key === TARGETING_KEYS.DEAL || key === TARGETING_KEYS.ACAT || key === TARGETING_KEYS.DSP || key === TARGETING_KEYS.CRID) && // hb_deal & hb_acat are suppressed automatically if not set\n      (\n        isEmptyStr(value) ||\n        value === null ||\n        value === undefined\n      )\n    ) {\n      logInfo(\"suppressing empty key '\" + key + \"' from adserver targeting\");\n    } else {\n      keyValues[key] = value;\n    }\n  });\n\n  return keyValues;\n}\n\nexport function adjustBids(bid) {\n  let bidPriceAdjusted = adjustCpm(bid.cpm, bid);\n\n  if (bidPriceAdjusted >= 0) {\n    bid.cpm = bidPriceAdjusted;\n  }\n}\n\n/**\n * groupByPlacement is a reduce function that converts an array of Bid objects\n * to an object with placement codes as keys, with each key representing an object\n * with an array of `Bid` objects for that placement\n * @returns {*} as { [adUnitCode]: { bids: [Bid, Bid, Bid] } }\n */\nfunction groupByPlacement(bidsByPlacement, bid) {\n  if (!bidsByPlacement[bid.adUnitCode]) { bidsByPlacement[bid.adUnitCode] = { bids: [] }; }\n  bidsByPlacement[bid.adUnitCode].bids.push(bid);\n  return bidsByPlacement;\n}\n\n/**\n * isValidPrice is price validation function\n * which checks if price from bid response\n * is not higher than top limit set in config\n * @type {Function}\n * @param bid\n * @returns {boolean}\n */\nfunction isValidPrice(bid) {\n  const maxBidValue = config.getConfig('maxBid');\n  if (!maxBidValue || !bid.cpm) return true;\n  return maxBidValue >= Number(bid.cpm);\n}\n","/**\n * @typedef {Object} AuctionIndex\n *\n * @property {function({ auctionId: * }): *} getAuction Returns auction instance for `auctionId`\n * @property {function({ adUnitId: * }): *} getAdUnit Returns `adUnit` object for `transactionId`.\n * You should prefer `getMediaTypes` for looking up bid media types.\n * @property {function({ adUnitId: *, requestId: * }): *} getMediaTypes Returns mediaTypes object from bidRequest (through `requestId`) falling back to the adUnit (through `transactionId`).\n * The bidRequest is given precedence because its mediaTypes can differ from the adUnit's (if bidder-specific labels are in use).\n * Bids that have no associated request do not have labels either, and use the adUnit's mediaTypes.\n * @property {function({ requestId: *, bidderRequestId: * }): *} getBidderRequest Returns bidderRequest that matches both requestId and bidderRequestId (if either or both are provided).\n * Bid responses are not guaranteed to have a corresponding request.\n * @property {function({ requestId: * }): *} getBidRequest Returns bidRequest object for requestId.\n * Bid responses are not guaranteed to have a corresponding request.\n */\n\n/**\n * Retrieves request-related bid data.\n * All methods are designed to work with Bid (response) objects returned by bid adapters.\n */\nexport function AuctionIndex(getAuctions) {\n  Object.assign(this, {\n    getAuction({auctionId}) {\n      if (auctionId != null) {\n        return getAuctions()\n          .find(auction => auction.getAuctionId() === auctionId);\n      }\n    },\n    getAdUnit({adUnitId}) {\n      if (adUnitId != null) {\n        return getAuctions()\n          .flatMap(a => a.getAdUnits())\n          .find(au => au.adUnitId === adUnitId);\n      }\n    },\n    getMediaTypes({adUnitId, requestId}) {\n      if (requestId != null) {\n        const req = this.getBidRequest({requestId});\n        if (req != null && (adUnitId == null || req.adUnitId === adUnitId)) {\n          return req.mediaTypes;\n        }\n      } else if (adUnitId != null) {\n        const au = this.getAdUnit({adUnitId});\n        if (au != null) {\n          return au.mediaTypes;\n        }\n      }\n    },\n    getBidderRequest({requestId, bidderRequestId}) {\n      if (requestId != null || bidderRequestId != null) {\n        let bers = getAuctions().flatMap(a => a.getBidRequests());\n        if (bidderRequestId != null) {\n          bers = bers.filter(ber => ber.bidderRequestId === bidderRequestId);\n        }\n        if (requestId == null) {\n          return bers[0];\n        } else {\n          return bers.find(ber => ber.bids && ber.bids.find(br => br.bidId === requestId) != null)\n        }\n      }\n    },\n    getBidRequest({requestId}) {\n      if (requestId != null) {\n        return getAuctions()\n          .flatMap(a => a.getBidRequests())\n          .flatMap(ber => ber.bids)\n          .find(br => br && br.bidId === requestId);\n      }\n    },\n    getOrtb2(bid) {\n      return this.getBidderRequest(bid)?.ortb2 || this.getAuction(bid)?.getFPD()?.global?.ortb2\n    }\n  });\n}\n","/**\n * AuctionManager modules is responsible for creating auction instances.\n * This module is the gateway for Prebid core to access auctions.\n * It stores all created instances of auction and can be used to get consolidated values from auction.\n */\n\n/**\n * @typedef {Object} AuctionManager\n *\n * @property {function(): Array} getBidsRequested - returns consolidated bid requests\n * @property {function(): Array} getBidsReceived - returns consolidated bid received\n * @property {function(): Array} getAllBidsForAdUnitCode - returns consolidated bid received for a given adUnit\n * @property {function(): Array} getAdUnits - returns consolidated adUnits\n * @property {function(): Array} getAdUnitCodes - returns consolidated adUnitCodes\n * @property {function(): Object} createAuction - creates auction instance and stores it for future reference\n * @property {function(): Object} findBidByAdId - find bid received by adId. This function will be called by $$PREBID_GLOBAL$$.renderAd\n * @property {function(): Object} getStandardBidderAdServerTargeting - returns standard bidder targeting for all the adapters. Refer http://prebid.org/dev-docs/publisher-api-reference.html#module_pbjs.bidderSettings for more details\n * @property {function(Object): void} addWinningBid - add a winning bid to an auction based on auctionId\n * @property {function(): void} clearAllAuctions - clear all auctions for testing\n * @property {AuctionIndex} index\n */\n\nimport { uniques, logWarn } from './utils.js';\nimport { newAuction, getStandardBidderSettings, AUCTION_COMPLETED } from './auction.js';\nimport {AuctionIndex} from './auctionIndex.js';\nimport { BID_STATUS, JSON_MAPPING } from './constants.js';\nimport {useMetrics} from './utils/perfMetrics.js';\nimport {ttlCollection} from './utils/ttlCollection.js';\nimport {getMinBidCacheTTL, onMinBidCacheTTLChange} from './bidTTL.js';\n\n/**\n * Creates new instance of auctionManager. There will only be one instance of auctionManager but\n * a factory is created to assist in testing.\n *\n * @returns {AuctionManager} auctionManagerInstance\n */\nexport function newAuctionManager() {\n  const _auctions = ttlCollection({\n    startTime: (au) => au.end.then(() => au.getAuctionEnd()),\n    ttl: (au) => getMinBidCacheTTL() == null ? null : au.end.then(() => {\n      return Math.max(getMinBidCacheTTL(), ...au.getBidsReceived().map(bid => bid.ttl)) * 1000\n    }),\n  });\n\n  onMinBidCacheTTLChange(() => _auctions.refresh());\n\n  const auctionManager = {\n    onExpiry: _auctions.onExpiry\n  };\n\n  function getAuction(auctionId) {\n    for (const auction of _auctions) {\n      if (auction.getAuctionId() === auctionId) return auction;\n    }\n  }\n\n  auctionManager.addWinningBid = function(bid) {\n    const metrics = useMetrics(bid.metrics);\n    metrics.checkpoint('bidWon');\n    metrics.timeBetween('auctionEnd', 'bidWon', 'adserver.pending');\n    metrics.timeBetween('requestBids', 'bidWon', 'adserver.e2e');\n    const auction = getAuction(bid.auctionId);\n    if (auction) {\n      auction.addWinningBid(bid);\n    } else {\n      logWarn(`Auction not found when adding winning bid`);\n    }\n  };\n\n  Object.entries({\n    getAllWinningBids: {\n      name: 'getWinningBids',\n    },\n    getBidsRequested: {\n      name: 'getBidRequests'\n    },\n    getNoBids: {},\n    getAdUnits: {},\n    getBidsReceived: {\n      pre(auction) {\n        return auction.getAuctionStatus() === AUCTION_COMPLETED;\n      }\n    },\n    getAdUnitCodes: {\n      post: uniques,\n    }\n  }).forEach(([mgrMethod, {name = mgrMethod, pre, post}]) => {\n    const mapper = pre == null\n      ? (auction) => auction[name]()\n      : (auction) => pre(auction) ? auction[name]() : [];\n    const filter = post == null\n      ? (items) => items\n      : (items) => items.filter(post)\n    auctionManager[mgrMethod] = () => {\n      return filter(_auctions.toArray().flatMap(mapper));\n    }\n  })\n\n  function allBidsReceived() {\n    return _auctions.toArray().flatMap(au => au.getBidsReceived())\n  }\n\n  auctionManager.getAllBidsForAdUnitCode = function(adUnitCode) {\n    return allBidsReceived()\n      .filter(bid => bid && bid.adUnitCode === adUnitCode)\n  };\n\n  auctionManager.createAuction = function(opts) {\n    const auction = newAuction(opts);\n    _addAuction(auction);\n    return auction;\n  };\n\n  auctionManager.findBidByAdId = function(adId) {\n    return allBidsReceived()\n      .find(bid => bid.adId === adId);\n  };\n\n  auctionManager.getStandardBidderAdServerTargeting = function() {\n    return getStandardBidderSettings()[JSON_MAPPING.ADSERVER_TARGETING];\n  };\n\n  auctionManager.setStatusForBids = function(adId, status) {\n    let bid = auctionManager.findBidByAdId(adId);\n    if (bid) bid.status = status;\n\n    if (bid && status === BID_STATUS.BID_TARGETING_SET) {\n      const auction = getAuction(bid.auctionId);\n      if (auction) auction.setBidTargeting(bid);\n    }\n  }\n\n  auctionManager.getLastAuctionId = function() {\n    const auctions = _auctions.toArray();\n    return auctions.length && auctions[auctions.length - 1].getAuctionId()\n  };\n\n  auctionManager.clearAllAuctions = function() {\n    _auctions.clear();\n  }\n\n  function _addAuction(auction) {\n    _auctions.add(auction);\n  }\n\n  auctionManager.index = new AuctionIndex(() => _auctions.toArray());\n\n  return auctionManager;\n}\n\nexport const auctionManager = newAuctionManager();\n","import {config} from './config.js';\nimport {logError} from './utils.js';\nconst CACHE_TTL_SETTING = 'minBidCacheTTL';\nlet TTL_BUFFER = 1;\nlet minCacheTTL = null;\nconst listeners = [];\n\nconfig.getConfig('ttlBuffer', (cfg) => {\n  if (typeof cfg.ttlBuffer === 'number') {\n    TTL_BUFFER = cfg.ttlBuffer;\n  } else {\n    logError('Invalid value for ttlBuffer', cfg.ttlBuffer);\n  }\n})\n\nexport function getBufferedTTL(bid) {\n  return bid.ttl - (bid.hasOwnProperty('ttlBuffer') ? bid.ttlBuffer : TTL_BUFFER);\n}\n\nexport function getMinBidCacheTTL() {\n  return minCacheTTL;\n}\n\nconfig.getConfig(CACHE_TTL_SETTING, (cfg) => {\n  const prev = minCacheTTL;\n  minCacheTTL = cfg?.[CACHE_TTL_SETTING];\n  minCacheTTL = typeof minCacheTTL === 'number' ? minCacheTTL : null;\n  if (prev !== minCacheTTL) {\n    listeners.forEach(l => l(minCacheTTL))\n  }\n})\n\nexport function onMinBidCacheTTLChange(listener) {\n  listeners.push(listener);\n}\n","import {deepAccess, mergeDeep} from './utils.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport { JSON_MAPPING } from './constants.js';\n\nexport class ScopedSettings {\n  constructor(getSettings, defaultScope) {\n    this.getSettings = getSettings;\n    this.defaultScope = defaultScope;\n  }\n\n  /**\n   * Get setting value at `path` under the given scope, falling back to the default scope if needed.\n   * If `scope` is `null`, get the setting's default value.\n   * @param scope {String|null}\n   * @param path {String}\n   * @returns {*}\n   */\n  get(scope, path) {\n    let value = this.getOwn(scope, path);\n    if (typeof value === 'undefined') {\n      value = this.getOwn(null, path);\n    }\n    return value;\n  }\n\n  /**\n   * Get the setting value at `path` *without* falling back to the default value.\n   * @param scope {String}\n   * @param path {String}\n   * @returns {*}\n   */\n  getOwn(scope, path) {\n    scope = this.#resolveScope(scope);\n    return deepAccess(this.getSettings(), `${scope}.${path}`)\n  }\n\n  /**\n   * @returns {string[]} all existing scopes except the default one.\n   */\n  getScopes() {\n    return Object.keys(this.getSettings()).filter((scope) => scope !== this.defaultScope);\n  }\n\n  /**\n   * @returns all settings in the given scope, merged with the settings for the default scope.\n   */\n  settingsFor(scope) {\n    return mergeDeep({}, this.ownSettingsFor(null), this.ownSettingsFor(scope));\n  }\n\n  /**\n   * @returns all settings in the given scope, *without* any of the default settings.\n   */\n  ownSettingsFor(scope) {\n    scope = this.#resolveScope(scope);\n    return this.getSettings()[scope] || {};\n  }\n\n  #resolveScope(scope) {\n    if (scope == null) {\n      return this.defaultScope;\n    } else {\n      return scope;\n    }\n  }\n}\n\nexport const bidderSettings = new ScopedSettings(() => getGlobal().bidderSettings || {}, JSON_MAPPING.BD_SETTING_STANDARD);\n","import { getUniqueIdentifierStr } from './utils.js';\n\n/**\n Required paramaters\n bidderCode,\n height,\n width,\n statusCode\n Optional paramaters\n adId,\n cpm,\n ad,\n adUrl,\n dealId,\n priceKeyString;\n */\nfunction Bid(statusCode, {src = 'client', bidder = '', bidId, transactionId, adUnitId, auctionId} = {}) {\n  var _bidSrc = src;\n  var _statusCode = statusCode || 0;\n\n  Object.assign(this, {\n    bidderCode: bidder,\n    width: 0,\n    height: 0,\n    statusMessage: _getStatus(),\n    adId: getUniqueIdentifierStr(),\n    requestId: bidId,\n    transactionId,\n    adUnitId,\n    auctionId,\n    mediaType: 'banner',\n    source: _bidSrc\n  })\n\n  function _getStatus() {\n    switch (_statusCode) {\n      case 0:\n        return 'Pending';\n      case 1:\n        return 'Bid available';\n      case 2:\n        return 'Bid returned empty or error response';\n      case 3:\n        return 'Bid timed out';\n    }\n  }\n\n  this.getStatusCode = function () {\n    return _statusCode;\n  };\n\n  // returns the size of the bid creative. Concatenation of width and height by x.\n  this.getSize = function () {\n    return this.width + 'x' + this.height;\n  };\n\n  this.getIdentifiers = function () {\n    return {\n      src: this.source,\n      bidder: this.bidderCode,\n      bidId: this.requestId,\n      transactionId: this.transactionId,\n      adUnitId: this.adUnitId,\n      auctionId: this.auctionId\n    }\n  };\n}\n\n// Bid factory function.\nexport function createBid(statusCode, identifiers) {\n  return new Bid(statusCode, identifiers);\n}\n","/*\n * Module for getting and setting Prebid configuration.\n*/\n\n/**\n * @typedef {Object} MediaTypePriceGranularity\n *\n * @property {(string|Object)} [banner]\n * @property {(string|Object)} [native]\n * @property {(string|Object)} [video]\n * @property {(string|Object)} [video-instream]\n * @property {(string|Object)} [video-outstream]\n */\n\nimport {isValidPriceConfig} from './cpmBucketManager.js';\nimport {arrayFrom as from, find, includes} from './polyfill.js';\nimport {\n  deepAccess,\n  deepClone,\n  getParameterByName,\n  isArray,\n  isBoolean,\n  isPlainObject,\n  isStr,\n  logError,\n  logMessage,\n  logWarn,\n  mergeDeep\n} from './utils.js';\nimport {DEBUG_MODE} from './constants.js';\n\nconst DEFAULT_DEBUG = getParameterByName(DEBUG_MODE).toUpperCase() === 'TRUE';\nconst DEFAULT_BIDDER_TIMEOUT = 3000;\nconst DEFAULT_ENABLE_SEND_ALL_BIDS = true;\nconst DEFAULT_DISABLE_AJAX_TIMEOUT = false;\nconst DEFAULT_BID_CACHE = false;\nconst DEFAULT_DEVICE_ACCESS = true;\nconst DEFAULT_MAX_NESTED_IFRAMES = 10;\nconst DEFAULT_MAXBID_VALUE = 5000\n\nconst DEFAULT_IFRAMES_CONFIG = {};\n\nexport const RANDOM = 'random';\nconst FIXED = 'fixed';\n\nconst VALID_ORDERS = {};\nVALID_ORDERS[RANDOM] = true;\nVALID_ORDERS[FIXED] = true;\n\nconst DEFAULT_BIDDER_SEQUENCE = RANDOM;\n\nconst GRANULARITY_OPTIONS = {\n  LOW: 'low',\n  MEDIUM: 'medium',\n  HIGH: 'high',\n  AUTO: 'auto',\n  DENSE: 'dense',\n  CUSTOM: 'custom'\n};\n\nconst ALL_TOPICS = '*';\n\nfunction attachProperties(config, useDefaultValues = true) {\n  const values = useDefaultValues ? {\n    priceGranularity: GRANULARITY_OPTIONS.MEDIUM,\n    customPriceBucket: {},\n    mediaTypePriceGranularity: {},\n    bidderSequence: DEFAULT_BIDDER_SEQUENCE,\n    auctionOptions: {}\n  } : {}\n\n  function getProp(name) {\n    return values[name];\n  }\n\n  function setProp(name, val) {\n    if (!values.hasOwnProperty(name)) {\n      Object.defineProperty(config, name, {enumerable: true});\n    }\n    values[name] = val;\n  }\n\n  const props = {\n    publisherDomain: {\n      set(val) {\n        if (val != null) {\n          logWarn('publisherDomain is deprecated and has no effect since v7 - use pageUrl instead')\n        }\n        setProp('publisherDomain', val);\n      }\n    },\n    priceGranularity: {\n      set(val) {\n        if (validatePriceGranularity(val)) {\n          if (typeof val === 'string') {\n            setProp('priceGranularity', (hasGranularity(val)) ? val : GRANULARITY_OPTIONS.MEDIUM);\n          } else if (isPlainObject(val)) {\n            setProp('customPriceBucket', val);\n            setProp('priceGranularity', GRANULARITY_OPTIONS.CUSTOM)\n            logMessage('Using custom price granularity');\n          }\n        }\n      }\n    },\n    customPriceBucket: {},\n    mediaTypePriceGranularity: {\n      set(val) {\n        val != null && setProp('mediaTypePriceGranularity', Object.keys(val).reduce((aggregate, item) => {\n          if (validatePriceGranularity(val[item])) {\n            if (typeof val === 'string') {\n              aggregate[item] = (hasGranularity(val[item])) ? val[item] : getProp('priceGranularity');\n            } else if (isPlainObject(val)) {\n              aggregate[item] = val[item];\n              logMessage(`Using custom price granularity for ${item}`);\n            }\n          } else {\n            logWarn(`Invalid price granularity for media type: ${item}`);\n          }\n          return aggregate;\n        }, {}));\n      }\n    },\n    bidderSequence: {\n      set(val) {\n        if (VALID_ORDERS[val]) {\n          setProp('bidderSequence', val);\n        } else {\n          logWarn(`Invalid order: ${val}. Bidder Sequence was not set.`);\n        }\n      }\n    },\n    auctionOptions: {\n      set(val) {\n        if (validateauctionOptions(val)) {\n          setProp('auctionOptions', val);\n        }\n      }\n    }\n  }\n\n  Object.defineProperties(config, Object.fromEntries(\n    Object.entries(props)\n      .map(([k, def]) => [k, Object.assign({\n        get: getProp.bind(null, k),\n        set: setProp.bind(null, k),\n        enumerable: values.hasOwnProperty(k),\n        configurable: !values.hasOwnProperty(k)\n      }, def)])\n  ));\n\n  return config;\n\n  function hasGranularity(val) {\n    return find(Object.keys(GRANULARITY_OPTIONS), option => val === GRANULARITY_OPTIONS[option]);\n  }\n\n  function validatePriceGranularity(val) {\n    if (!val) {\n      logError('Prebid Error: no value passed to `setPriceGranularity()`');\n      return false;\n    }\n    if (typeof val === 'string') {\n      if (!hasGranularity(val)) {\n        logWarn('Prebid Warning: setPriceGranularity was called with invalid setting, using `medium` as default.');\n      }\n    } else if (isPlainObject(val)) {\n      if (!isValidPriceConfig(val)) {\n        logError('Invalid custom price value passed to `setPriceGranularity()`');\n        return false;\n      }\n    }\n    return true;\n  }\n\n  function validateauctionOptions(val) {\n    if (!isPlainObject(val)) {\n      logWarn('Auction Options must be an object')\n      return false\n    }\n\n    for (let k of Object.keys(val)) {\n      if (k !== 'secondaryBidders' && k !== 'suppressStaleRender' && k !== 'suppressExpiredRender') {\n        logWarn(`Auction Options given an incorrect param: ${k}`)\n        return false\n      }\n      if (k === 'secondaryBidders') {\n        if (!isArray(val[k])) {\n          logWarn(`Auction Options ${k} must be of type Array`);\n          return false\n        } else if (!val[k].every(isStr)) {\n          logWarn(`Auction Options ${k} must be only string`);\n          return false\n        }\n      } else if (k === 'suppressStaleRender' || k === 'suppressExpiredRender') {\n        if (!isBoolean(val[k])) {\n          logWarn(`Auction Options ${k} must be of type boolean`);\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n}\n\nexport function newConfig() {\n  let listeners = [];\n  let defaults;\n  let config;\n  let bidderConfig;\n  let currBidder = null;\n\n  function resetConfig() {\n    defaults = {};\n\n    let newConfig = attachProperties({\n      // `debug` is equivalent to legacy `pbjs.logging` property\n      debug: DEFAULT_DEBUG,\n      bidderTimeout: DEFAULT_BIDDER_TIMEOUT,\n      enableSendAllBids: DEFAULT_ENABLE_SEND_ALL_BIDS,\n      useBidCache: DEFAULT_BID_CACHE,\n\n      /**\n       * deviceAccess set to false will disable setCookie, getCookie, hasLocalStorage\n       * @type {boolean}\n       */\n      deviceAccess: DEFAULT_DEVICE_ACCESS,\n\n      disableAjaxTimeout: DEFAULT_DISABLE_AJAX_TIMEOUT,\n\n      // default max nested iframes for referer detection\n      maxNestedIframes: DEFAULT_MAX_NESTED_IFRAMES,\n\n      // default max bid\n      maxBid: DEFAULT_MAXBID_VALUE,\n      userSync: {\n        topics: DEFAULT_IFRAMES_CONFIG\n      }\n    });\n\n    if (config) {\n      callSubscribers(\n        Object.keys(config).reduce((memo, topic) => {\n          if (config[topic] !== newConfig[topic]) {\n            memo[topic] = newConfig[topic] || {};\n          }\n          return memo;\n        },\n        {})\n      );\n    }\n\n    config = newConfig;\n    bidderConfig = {};\n  }\n\n  /**\n   * Returns base config with bidder overrides (if there is currently a bidder)\n   * @private\n   */\n  function _getConfig() {\n    if (currBidder && bidderConfig && isPlainObject(bidderConfig[currBidder])) {\n      let currBidderConfig = bidderConfig[currBidder];\n      const configTopicSet = new Set(Object.keys(config).concat(Object.keys(currBidderConfig)));\n\n      return from(configTopicSet).reduce((memo, topic) => {\n        if (typeof currBidderConfig[topic] === 'undefined') {\n          memo[topic] = config[topic];\n        } else if (typeof config[topic] === 'undefined') {\n          memo[topic] = currBidderConfig[topic];\n        } else {\n          if (isPlainObject(currBidderConfig[topic])) {\n            memo[topic] = mergeDeep({}, config[topic], currBidderConfig[topic]);\n          } else {\n            memo[topic] = currBidderConfig[topic];\n          }\n        }\n        return memo;\n      }, {});\n    }\n    return Object.assign({}, config);\n  }\n\n  function _getRestrictedConfig() {\n    // This causes reading 'ortb2' to throw an error; with prebid 7, that will almost\n    // always be the incorrect way to access FPD configuration (https://github.com/prebid/Prebid.js/issues/7651)\n    // code that needs the ortb2 config should explicitly use `getAnyConfig`\n    // TODO: this is meant as a temporary tripwire to catch inadvertent use of `getConfig('ortb')` as we transition.\n    // It should be removed once the risk of that happening is low enough.\n    const conf = _getConfig();\n    Object.defineProperty(conf, 'ortb2', {\n      get: function () {\n        throw new Error('invalid access to \\'orbt2\\' config - use request parameters instead');\n      }\n    });\n    return conf;\n  }\n\n  const [getAnyConfig, getConfig] = [_getConfig, _getRestrictedConfig].map(accessor => {\n    /*\n     * Returns configuration object if called without parameters,\n     * or single configuration property if given a string matching a configuration\n     * property name.  Allows deep access e.g. getConfig('currency.adServerCurrency')\n     *\n     * If called with callback parameter, or a string and a callback parameter,\n     * subscribes to configuration updates. See `subscribe` function for usage.\n     */\n    return function getConfig(...args) {\n      if (args.length <= 1 && typeof args[0] !== 'function') {\n        const option = args[0];\n        return option ? deepAccess(accessor(), option) : _getConfig();\n      }\n\n      return subscribe(...args);\n    }\n  })\n\n  const [readConfig, readAnyConfig] = [getConfig, getAnyConfig].map(wrapee => {\n    /*\n     * Like getConfig, except that it returns a deepClone of the result.\n     */\n    return function readConfig(...args) {\n      let res = wrapee(...args);\n      if (res && typeof res === 'object') {\n        res = deepClone(res);\n      }\n      return res;\n    }\n  })\n\n  /**\n   * Internal API for modules (such as prebid-server) that might need access to all bidder config\n   */\n  function getBidderConfig() {\n    return bidderConfig;\n  }\n\n  /*\n   * Sets configuration given an object containing key-value pairs and calls\n   * listeners that were added by the `subscribe` function\n   */\n  function setConfig(options) {\n    if (!isPlainObject(options)) {\n      logError('setConfig options must be an object');\n      return;\n    }\n\n    let topics = Object.keys(options);\n    let topicalConfig = {};\n\n    topics.forEach(topic => {\n      let option = options[topic];\n\n      if (isPlainObject(defaults[topic]) && isPlainObject(option)) {\n        option = Object.assign({}, defaults[topic], option);\n      }\n\n      try {\n        topicalConfig[topic] = config[topic] = option;\n      } catch (e) {\n        logWarn(`Cannot set config for property ${topic} : `, e)\n      }\n    });\n\n    callSubscribers(topicalConfig);\n  }\n\n  /**\n   * Sets configuration defaults which setConfig values can be applied on top of\n   * @param {object} options\n   */\n  function setDefaults(options) {\n    if (!isPlainObject(defaults)) {\n      logError('defaults must be an object');\n      return;\n    }\n\n    Object.assign(defaults, options);\n    // Add default values to config as well\n    Object.assign(config, options);\n  }\n\n  /*\n   * Adds a function to a set of listeners that are invoked whenever `setConfig`\n   * is called. The subscribed function will be passed the options object that\n   * was used in the `setConfig` call. Topics can be subscribed to to only get\n   * updates when specific properties are updated by passing a topic string as\n   * the first parameter.\n   *\n   * If `options.init` is true, the listener will be immediately called with the current options.\n   *\n   * Returns an `unsubscribe` function for removing the subscriber from the\n   * set of listeners\n   *\n   * Example use:\n   * // subscribe to all configuration changes\n   * subscribe((config) => console.log('config set:', config));\n   *\n   * // subscribe to only 'logging' changes\n   * subscribe('logging', (config) => console.log('logging set:', config));\n   *\n   * // unsubscribe\n   * const unsubscribe = subscribe(...);\n   * unsubscribe(); // no longer listening\n   *\n   */\n  function subscribe(topic, listener, options = {}) {\n    let callback = listener;\n\n    if (typeof topic !== 'string') {\n      // first param should be callback function in this case,\n      // meaning it gets called for any config change\n      callback = topic;\n      topic = ALL_TOPICS;\n      options = listener || {};\n    }\n\n    if (typeof callback !== 'function') {\n      logError('listener must be a function');\n      return;\n    }\n\n    const nl = { topic, callback };\n    listeners.push(nl);\n\n    if (options.init) {\n      if (topic === ALL_TOPICS) {\n        callback(getConfig());\n      } else {\n        callback({[topic]: getConfig(topic)});\n      }\n    }\n\n    // save and call this function to remove the listener\n    return function unsubscribe() {\n      listeners.splice(listeners.indexOf(nl), 1);\n    };\n  }\n\n  /*\n   * Calls listeners that were added by the `subscribe` function\n   */\n  function callSubscribers(options) {\n    const TOPICS = Object.keys(options);\n\n    // call subscribers of a specific topic, passing only that configuration\n    listeners\n      .filter(listener => includes(TOPICS, listener.topic))\n      .forEach(listener => {\n        listener.callback({ [listener.topic]: options[listener.topic] });\n      });\n\n    // call subscribers that didn't give a topic, passing everything that was set\n    listeners\n      .filter(listener => listener.topic === ALL_TOPICS)\n      .forEach(listener => listener.callback(options));\n  }\n\n  function setBidderConfig(config, mergeFlag = false) {\n    try {\n      check(config);\n      config.bidders.forEach(bidder => {\n        if (!bidderConfig[bidder]) {\n          bidderConfig[bidder] = attachProperties({}, false);\n        }\n        Object.keys(config.config).forEach(topic => {\n          let option = config.config[topic];\n          const currentConfig = bidderConfig[bidder][topic];\n          if (isPlainObject(option) && (currentConfig == null || isPlainObject(currentConfig))) {\n            const func = mergeFlag ? mergeDeep : Object.assign;\n            bidderConfig[bidder][topic] = func({}, currentConfig || {}, option);\n          } else {\n            bidderConfig[bidder][topic] = option;\n          }\n        });\n      });\n    } catch (e) {\n      logError(e);\n    }\n\n    function check(obj) {\n      if (!isPlainObject(obj)) {\n        throw 'setBidderConfig bidder options must be an object';\n      }\n      if (!(Array.isArray(obj.bidders) && obj.bidders.length)) {\n        throw 'setBidderConfig bidder options must contain a bidders list with at least 1 bidder';\n      }\n      if (!isPlainObject(obj.config)) {\n        throw 'setBidderConfig bidder options must contain a config object';\n      }\n    }\n  }\n\n  function mergeConfig(obj) {\n    if (!isPlainObject(obj)) {\n      logError('mergeConfig input must be an object');\n      return;\n    }\n\n    const mergedConfig = mergeDeep(_getConfig(), obj);\n\n    setConfig({ ...mergedConfig });\n    return mergedConfig;\n  }\n\n  function mergeBidderConfig(obj) {\n    return setBidderConfig(obj, true);\n  }\n\n  /**\n   * Internal functions for core to execute some synchronous code while having an active bidder set.\n   */\n  function runWithBidder(bidder, fn) {\n    currBidder = bidder;\n    try {\n      return fn();\n    } finally {\n      resetBidder();\n    }\n  }\n  function callbackWithBidder(bidder) {\n    return function(cb) {\n      return function(...args) {\n        if (typeof cb === 'function') {\n          return runWithBidder(bidder, cb.bind(this, ...args))\n        } else {\n          logWarn('config.callbackWithBidder callback is not a function');\n        }\n      }\n    }\n  }\n\n  function getCurrentBidder() {\n    return currBidder;\n  }\n\n  function resetBidder() {\n    currBidder = null;\n  }\n\n  resetConfig();\n\n  return {\n    getCurrentBidder,\n    resetBidder,\n    getConfig,\n    getAnyConfig,\n    readConfig,\n    readAnyConfig,\n    setConfig,\n    mergeConfig,\n    setDefaults,\n    resetConfig,\n    runWithBidder,\n    callbackWithBidder,\n    setBidderConfig,\n    getBidderConfig,\n    mergeBidderConfig,\n  };\n}\n\n/**\n * Set a `cache.url` if we should use prebid-cache to store video bids before adding bids to the auction.\n * This must be set if you want to use the dfpAdServerVideo module.\n */\nexport const config = newConfig();\n","import {cyrb53Hash, isStr, timestamp} from './utils.js';\nimport {defer, PbPromise} from './utils/promise.js';\nimport {config} from './config.js';\n\n/**\n * Placeholder gvlid for when vendor consent is not required. When this value is used as gvlid, the gdpr\n * enforcement module will take it to mean \"vendor consent was given\".\n *\n * see https://github.com/prebid/Prebid.js/issues/8161\n */\nexport const VENDORLESS_GVLID = Object.freeze({});\n\nexport class ConsentHandler {\n  #enabled;\n  #data;\n  #defer;\n  #ready;\n  #dirty = true;\n  #hash;\n  generatedTime;\n  hashFields;\n\n  constructor() {\n    this.reset();\n  }\n\n  #resolve(data) {\n    this.#ready = true;\n    this.#data = data;\n    this.#defer.resolve(data);\n  }\n\n  /**\n   * reset this handler (mainly for tests)\n   */\n  reset() {\n    this.#defer = defer();\n    this.#enabled = false;\n    this.#data = null;\n    this.#ready = false;\n    this.generatedTime = null;\n  }\n\n  /**\n   * Enable this consent handler. This should be called by the relevant consent management module\n   * on initialization.\n   */\n  enable() {\n    this.#enabled = true;\n  }\n\n  /**\n   * @returns {boolean} true if the related consent management module is enabled.\n   */\n  get enabled() {\n    return this.#enabled;\n  }\n\n  /**\n   * @returns {boolean} true if consent data has been resolved (it may be `null` if the resolution failed).\n   */\n  get ready() {\n    return this.#ready;\n  }\n\n  /**\n   * @returns a promise than resolves to the consent data, or null if no consent data is available\n   */\n  get promise() {\n    if (this.#ready) {\n      return PbPromise.resolve(this.#data);\n    }\n    if (!this.#enabled) {\n      this.#resolve(null);\n    }\n    return this.#defer.promise;\n  }\n\n  setConsentData(data, time = timestamp()) {\n    this.generatedTime = time;\n    this.#dirty = true;\n    this.#resolve(data);\n  }\n\n  getConsentData() {\n    return this.#data;\n  }\n\n  get hash() {\n    if (this.#dirty) {\n      this.#hash = cyrb53Hash(JSON.stringify(this.#data && this.hashFields ? this.hashFields.map(f => this.#data[f]) : this.#data))\n      this.#dirty = false;\n    }\n    return this.#hash;\n  }\n}\n\nclass UspConsentHandler extends ConsentHandler {\n  getConsentMeta() {\n    const consentData = this.getConsentData();\n    if (consentData && this.generatedTime) {\n      return {\n        generatedAt: this.generatedTime\n      };\n    }\n  }\n}\n\nclass GdprConsentHandler extends ConsentHandler {\n  hashFields = ['gdprApplies', 'consentString']\n  getConsentMeta() {\n    const consentData = this.getConsentData();\n    if (consentData && consentData.vendorData && this.generatedTime) {\n      return {\n        gdprApplies: consentData.gdprApplies,\n        consentStringSize: (isStr(consentData.vendorData.tcString)) ? consentData.vendorData.tcString.length : 0,\n        generatedAt: this.generatedTime,\n        apiVersion: consentData.apiVersion\n      }\n    }\n  }\n}\n\nclass GppConsentHandler extends ConsentHandler {\n  hashFields = ['applicableSections', 'gppString'];\n  getConsentMeta() {\n    const consentData = this.getConsentData();\n    if (consentData && this.generatedTime) {\n      return {\n        generatedAt: this.generatedTime,\n      }\n    }\n  }\n}\n\nexport function gvlidRegistry() {\n  const registry = {};\n  const flat = {};\n  const none = {};\n  return {\n    /**\n     * Register a module's GVL ID.\n     * @param {string} moduleType defined in `activities/modules.js`\n     * @param {string} moduleName\n     * @param {number} gvlid\n     */\n    register(moduleType, moduleName, gvlid) {\n      if (gvlid) {\n        (registry[moduleName] = registry[moduleName] || {})[moduleType] = gvlid;\n        if (flat.hasOwnProperty(moduleName)) {\n          if (flat[moduleName] !== gvlid) flat[moduleName] = none;\n        } else {\n          flat[moduleName] = gvlid;\n        }\n      }\n    },\n    /**\n     * @typedef {Object} GvlIdResult\n     * @property {Object.<string, number>} modules - A map from module type to that module's GVL ID.\n     * @property {number} [gvlid] - The single GVL ID for this family of modules (only defined if all modules with this name declared the same ID).\n     */\n\n    /**\n     * Get a module's GVL ID(s).\n     *\n     * @param {string} moduleName - The name of the module.\n     * @return {GvlIdResult} An object where:\n     *   `modules` is a map from module type to that module's GVL ID;\n     *   `gvlid` is the single GVL ID for this family of modules (only defined if all modules with this name declare the same ID).\n     */\n    get(moduleName) {\n      const result = {modules: registry[moduleName] || {}};\n      if (flat.hasOwnProperty(moduleName) && flat[moduleName] !== none) {\n        result.gvlid = flat[moduleName];\n      }\n      return result;\n    }\n  }\n}\n\nexport const gdprDataHandler = new GdprConsentHandler();\nexport const uspDataHandler = new UspConsentHandler();\nexport const gppDataHandler = new GppConsentHandler();\nexport const coppaDataHandler = (() => {\n  function getCoppa() {\n    return !!(config.getConfig('coppa'))\n  }\n  return {\n    getCoppa,\n    getConsentData: getCoppa,\n    getConsentMeta: getCoppa,\n    reset() {},\n    get promise() {\n      return PbPromise.resolve(getCoppa())\n    },\n    get hash() {\n      return getCoppa() ? '1' : '0'\n    }\n  }\n})();\n\nexport const GDPR_GVLIDS = gvlidRegistry();\n\nconst ALL_HANDLERS = {\n  gdpr: gdprDataHandler,\n  usp: uspDataHandler,\n  gpp: gppDataHandler,\n  coppa: coppaDataHandler,\n}\n\nexport function multiHandler(handlers = ALL_HANDLERS) {\n  handlers = Object.entries(handlers);\n  function collector(method) {\n    return function () {\n      return Object.fromEntries(handlers.map(([name, handler]) => [name, handler[method]()]))\n    }\n  }\n  return Object.assign(\n    {\n      get promise() {\n        return PbPromise.all(handlers.map(([name, handler]) => handler.promise.then(val => [name, val])))\n          .then(entries => Object.fromEntries(entries));\n      },\n      get hash() {\n        return cyrb53Hash(handlers.map(([_, handler]) => handler.hash).join(':'));\n      }\n    },\n    Object.fromEntries(['getConsentData', 'getConsentMeta', 'reset'].map(n => [n, collector(n)])),\n  )\n}\n\nexport const allConsent = multiHandler();\n","export const JSON_MAPPING = {\n  PL_CODE: 'code',\n  PL_SIZE: 'sizes',\n  PL_BIDS: 'bids',\n  BD_BIDDER: 'bidder',\n  BD_ID: 'paramsd',\n  BD_PL_ID: 'placementId',\n  ADSERVER_TARGETING: 'adserverTargeting',\n  BD_SETTING_STANDARD: 'standard'\n};\n\nexport const DEBUG_MODE = 'pbjs_debug';\n\nexport const STATUS = {\n  GOOD: 1\n};\n\nexport const EVENTS = {\n  AUCTION_INIT: 'auctionInit',\n  AUCTION_TIMEOUT: 'auctionTimeout',\n  AUCTION_END: 'auctionEnd',\n  BID_ADJUSTMENT: 'bidAdjustment',\n  BID_TIMEOUT: 'bidTimeout',\n  BID_REQUESTED: 'bidRequested',\n  BID_RESPONSE: 'bidResponse',\n  BID_REJECTED: 'bidRejected',\n  NO_BID: 'noBid',\n  SEAT_NON_BID: 'seatNonBid',\n  BID_WON: 'bidWon',\n  BIDDER_DONE: 'bidderDone',\n  BIDDER_ERROR: 'bidderError',\n  SET_TARGETING: 'setTargeting',\n  BEFORE_REQUEST_BIDS: 'beforeRequestBids',\n  BEFORE_BIDDER_HTTP: 'beforeBidderHttp',\n  REQUEST_BIDS: 'requestBids',\n  ADD_AD_UNITS: 'addAdUnits',\n  AD_RENDER_FAILED: 'adRenderFailed',\n  AD_RENDER_SUCCEEDED: 'adRenderSucceeded',\n  TCF2_ENFORCEMENT: 'tcf2Enforcement',\n  AUCTION_DEBUG: 'auctionDebug',\n  BID_VIEWABLE: 'bidViewable',\n  STALE_RENDER: 'staleRender',\n  EXPIRED_RENDER: 'expiredRender',\n  BILLABLE_EVENT: 'billableEvent',\n  BID_ACCEPTED: 'bidAccepted',\n  RUN_PAAPI_AUCTION: 'paapiRunAuction',\n  PBS_ANALYTICS: 'pbsAnalytics',\n  PAAPI_BID: 'paapiBid',\n  PAAPI_NO_BID: 'paapiNoBid',\n  PAAPI_ERROR: 'paapiError',\n  BEFORE_PBS_HTTP: 'beforePBSHttp',\n  BROWSI_INIT: 'browsiInit',\n  BROWSI_DATA: 'browsiData',\n};\n\nexport const AD_RENDER_FAILED_REASON = {\n  PREVENT_WRITING_ON_MAIN_DOCUMENT: 'preventWritingOnMainDocument',\n  NO_AD: 'noAd',\n  EXCEPTION: 'exception',\n  CANNOT_FIND_AD: 'cannotFindAd',\n  MISSING_DOC_OR_ADID: 'missingDocOrAdid'\n};\n\nexport const EVENT_ID_PATHS = {\n  bidWon: 'adUnitCode'\n};\n\nexport const GRANULARITY_OPTIONS = {\n  LOW: 'low',\n  MEDIUM: 'medium',\n  HIGH: 'high',\n  AUTO: 'auto',\n  DENSE: 'dense',\n  CUSTOM: 'custom'\n};\n\nexport const TARGETING_KEYS = {\n  BIDDER: 'hb_bidder',\n  AD_ID: 'hb_adid',\n  PRICE_BUCKET: 'hb_pb',\n  SIZE: 'hb_size',\n  DEAL: 'hb_deal',\n  SOURCE: 'hb_source',\n  FORMAT: 'hb_format',\n  UUID: 'hb_uuid',\n  CACHE_ID: 'hb_cache_id',\n  CACHE_HOST: 'hb_cache_host',\n  ADOMAIN: 'hb_adomain',\n  ACAT: 'hb_acat',\n  CRID: 'hb_crid',\n  DSP: 'hb_dsp'\n};\n\nexport const DEFAULT_TARGETING_KEYS = {\n  BIDDER: 'hb_bidder',\n  AD_ID: 'hb_adid',\n  PRICE_BUCKET: 'hb_pb',\n  SIZE: 'hb_size',\n  DEAL: 'hb_deal',\n  FORMAT: 'hb_format',\n  UUID: 'hb_uuid',\n  CACHE_HOST: 'hb_cache_host'\n};\n\nexport const NATIVE_KEYS = {\n  title: 'hb_native_title',\n  body: 'hb_native_body',\n  body2: 'hb_native_body2',\n  privacyLink: 'hb_native_privacy',\n  privacyIcon: 'hb_native_privicon',\n  sponsoredBy: 'hb_native_brand',\n  image: 'hb_native_image',\n  icon: 'hb_native_icon',\n  clickUrl: 'hb_native_linkurl',\n  displayUrl: 'hb_native_displayurl',\n  cta: 'hb_native_cta',\n  rating: 'hb_native_rating',\n  address: 'hb_native_address',\n  downloads: 'hb_native_downloads',\n  likes: 'hb_native_likes',\n  phone: 'hb_native_phone',\n  price: 'hb_native_price',\n  salePrice: 'hb_native_saleprice',\n  rendererUrl: 'hb_renderer_url',\n  adTemplate: 'hb_adTemplate'\n};\n\nexport const S2S = {\n  SRC: 's2s',\n  DEFAULT_ENDPOINT: 'https://prebid.adnxs.com/pbs/v1/openrtb2/auction',\n  SYNCED_BIDDERS_KEY: 'pbjsSyncs'\n};\n\nexport const BID_STATUS = {\n  BID_TARGETING_SET: 'targetingSet',\n  RENDERED: 'rendered',\n  BID_REJECTED: 'bidRejected'\n};\n\nexport const REJECTION_REASON = {\n  INVALID: 'Bid has missing or invalid properties',\n  INVALID_REQUEST_ID: 'Invalid request ID',\n  BIDDER_DISALLOWED: 'Bidder code is not allowed by allowedAlternateBidderCodes / allowUnknownBidderCodes',\n  FLOOR_NOT_MET: 'Bid does not meet price floor',\n  CANNOT_CONVERT_CURRENCY: 'Unable to convert currency',\n  DSA_REQUIRED: 'Bid does not provide required DSA transparency info',\n  DSA_MISMATCH: 'Bid indicates inappropriate DSA rendering method',\n  PRICE_TOO_HIGH: 'Bid price exceeds maximum value'\n};\n\nexport const PREBID_NATIVE_DATA_KEYS_TO_ORTB = {\n  body: 'desc',\n  body2: 'desc2',\n  sponsoredBy: 'sponsored',\n  cta: 'ctatext',\n  rating: 'rating',\n  address: 'address',\n  downloads: 'downloads',\n  likes: 'likes',\n  phone: 'phone',\n  price: 'price',\n  salePrice: 'saleprice',\n  displayUrl: 'displayurl'\n};\n\nexport const NATIVE_ASSET_TYPES = {\n  sponsored: 1,\n  desc: 2,\n  rating: 3,\n  likes: 4,\n  downloads: 5,\n  price: 6,\n  saleprice: 7,\n  phone: 8,\n  address: 9,\n  desc2: 10,\n  displayurl: 11,\n  ctatext: 12\n};\n\nexport const NATIVE_IMAGE_TYPES = {\n  ICON: 1,\n  MAIN: 3\n};\n\nexport const NATIVE_KEYS_THAT_ARE_NOT_ASSETS = [\n  'privacyIcon',\n  'clickUrl',\n  'sendTargetingKeys',\n  'adTemplate',\n  'rendererUrl',\n  'type'\n];\n\nexport const MESSAGES = {\n  REQUEST: 'Prebid Request',\n  RESPONSE: 'Prebid Response',\n  NATIVE: 'Prebid Native',\n  EVENT: 'Prebid Event'\n};\n\nexport const PB_LOCATOR = '__pb_locator__';\n","import {find} from './polyfill.js';\nimport { isEmpty, logWarn } from './utils.js';\nimport { config } from './config.js';\n\nconst _defaultPrecision = 2;\nconst _lgPriceConfig = {\n  'buckets': [{\n    'max': 5,\n    'increment': 0.5\n  }]\n};\nconst _mgPriceConfig = {\n  'buckets': [{\n    'max': 20,\n    'increment': 0.1\n  }]\n};\nconst _hgPriceConfig = {\n  'buckets': [{\n    'max': 20,\n    'increment': 0.01\n  }]\n};\nconst _densePriceConfig = {\n  'buckets': [{\n    'max': 3,\n    'increment': 0.01\n  },\n  {\n    'max': 8,\n    'increment': 0.05\n  },\n  {\n    'max': 20,\n    'increment': 0.5\n  }]\n};\nconst _autoPriceConfig = {\n  'buckets': [{\n    'max': 5,\n    'increment': 0.05\n  },\n  {\n    'max': 10,\n    'increment': 0.1\n  },\n  {\n    'max': 20,\n    'increment': 0.5\n  }]\n};\n\nfunction getPriceBucketString(cpm, customConfig, granularityMultiplier = 1) {\n  let cpmFloat = parseFloat(cpm);\n  if (isNaN(cpmFloat)) {\n    cpmFloat = '';\n  }\n\n  return {\n    low: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _lgPriceConfig, granularityMultiplier),\n    med: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _mgPriceConfig, granularityMultiplier),\n    high: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _hgPriceConfig, granularityMultiplier),\n    auto: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _autoPriceConfig, granularityMultiplier),\n    dense: (cpmFloat === '') ? '' : getCpmStringValue(cpm, _densePriceConfig, granularityMultiplier),\n    custom: (cpmFloat === '') ? '' : getCpmStringValue(cpm, customConfig, granularityMultiplier)\n  };\n}\n\nfunction getCpmStringValue(cpm, config, granularityMultiplier) {\n  let cpmStr = '';\n  if (!isValidPriceConfig(config)) {\n    return cpmStr;\n  }\n  const cap = config.buckets.reduce((prev, curr) => {\n    if (prev.max > curr.max) {\n      return prev;\n    }\n    return curr;\n  }, {\n    'max': 0,\n  });\n\n  let bucketFloor = 0;\n  let bucket = find(config.buckets, bucket => {\n    if (cpm > cap.max * granularityMultiplier) {\n      // cpm exceeds cap, just return the cap.\n      let precision = bucket.precision;\n      if (typeof precision === 'undefined') {\n        precision = _defaultPrecision;\n      }\n      cpmStr = (bucket.max * granularityMultiplier).toFixed(precision);\n    } else if (cpm <= bucket.max * granularityMultiplier && cpm >= bucketFloor * granularityMultiplier) {\n      bucket.min = bucketFloor;\n      return bucket;\n    } else {\n      bucketFloor = bucket.max;\n    }\n  });\n  if (bucket) {\n    cpmStr = getCpmTarget(cpm, bucket, granularityMultiplier);\n  }\n  return cpmStr;\n}\n\nfunction isValidPriceConfig(config) {\n  if (isEmpty(config) || !config.buckets || !Array.isArray(config.buckets)) {\n    return false;\n  }\n  let isValid = true;\n  config.buckets.forEach(bucket => {\n    if (!bucket.max || !bucket.increment) {\n      isValid = false;\n    }\n  });\n  return isValid;\n}\n\nfunction getCpmTarget(cpm, bucket, granularityMultiplier) {\n  const precision = typeof bucket.precision !== 'undefined' ? bucket.precision : _defaultPrecision;\n  const increment = bucket.increment * granularityMultiplier;\n  const bucketMin = bucket.min * granularityMultiplier;\n  let roundingFunction = Math.floor;\n  let customRoundingFunction = config.getConfig('cpmRoundingFunction');\n  if (typeof customRoundingFunction === 'function') {\n    roundingFunction = customRoundingFunction;\n  }\n\n  // start increments at the bucket min and then add bucket min back to arrive at the correct rounding\n  // note - we're padding the values to avoid using decimals in the math prior to flooring\n  // this is done as JS can return values slightly below the expected mark which would skew the price bucket target\n  //   (eg 4.01 / 0.01 = 400.99999999999994)\n  // min precison should be 2 to move decimal place over.\n  let pow = Math.pow(10, precision + 2);\n  let cpmToRound = ((cpm * pow) - (bucketMin * pow)) / (increment * pow);\n  let cpmTarget;\n  let invalidRounding;\n  // It is likely that we will be passed {cpmRoundingFunction: roundingFunction()}\n  // rather than the expected {cpmRoundingFunction: roundingFunction}. Default back to floor in that case\n  try {\n    cpmTarget = (roundingFunction(cpmToRound) * increment) + bucketMin;\n  } catch (err) {\n    invalidRounding = true;\n  }\n  if (invalidRounding || typeof cpmTarget !== 'number') {\n    logWarn('Invalid rounding function passed in config');\n    cpmTarget = (Math.floor(cpmToRound) * increment) + bucketMin;\n  }\n  // force to 10 decimal places to deal with imprecise decimal/binary conversions\n  //    (for example 0.1 * 3 = 0.30000000000000004)\n\n  cpmTarget = Number(cpmTarget.toFixed(10));\n  return cpmTarget.toFixed(precision);\n}\n\nexport { getPriceBucketString, isValidPriceConfig };\n","import {PbPromise} from './utils/promise.js';\nimport {createInvisibleIframe} from './utils.js';\nimport {RENDERER} from '../libraries/creative-renderer-display/renderer.js';\nimport {hook} from './hook.js';\n\n// the minimum rendererVersion that will be used by PUC\nexport const PUC_MIN_VERSION = 3;\n\nexport const getCreativeRendererSource = hook('sync', function (bidResponse) {\n  return RENDERER;\n})\n\nexport const getCreativeRenderer = (function() {\n  const renderers = {};\n  return function (bidResponse) {\n    const src = getCreativeRendererSource(bidResponse);\n    if (!renderers.hasOwnProperty(src)) {\n      renderers[src] = new PbPromise((resolve) => {\n        const iframe = createInvisibleIframe();\n        iframe.srcdoc = `<script>${src}</script>`;\n        iframe.onload = () => resolve(iframe.contentWindow.render);\n        document.body.appendChild(iframe);\n      })\n    }\n    return renderers[src];\n  }\n})();\n","export const TRACKER_METHOD_IMG = 1;\nexport const TRACKER_METHOD_JS = 2;\nexport const EVENT_TYPE_IMPRESSION = 1;\nexport const EVENT_TYPE_WIN = 500;\n\n/**\n * Returns a map from event type (EVENT_TYPE_*)\n * to a map from tracker method (TRACKER_METHOD_*)\n * to an array of tracking URLs\n *\n * @param {{}[]} eventTrackers an array of \"Event Tracker Response Object\" as defined\n *  in the ORTB native 1.2 spec (https://www.iab.com/wp-content/uploads/2018/03/OpenRTB-Native-Ads-Specification-Final-1.2.pdf, section 5.8)\n * @returns {{[type: string]: {[method: string]: string[]}}}\n */\nexport function parseEventTrackers(eventTrackers) {\n  return (eventTrackers ?? []).reduce((tally, {event, method, url}) => {\n    const trackersForType = tally[event] = tally[event] ?? {};\n    const trackersForMethod = trackersForType[method] = trackersForType[method] ?? [];\n    trackersForMethod.push(url);\n    return tally;\n  }, {})\n}\n","/**\n * events.js\n */\nimport * as utils from './utils.js'\nimport { EVENTS, EVENT_ID_PATHS } from './constants.js';\nimport {ttlCollection} from './utils/ttlCollection.js';\nimport {config} from './config.js';\nconst TTL_CONFIG = 'eventHistoryTTL';\n\nlet eventTTL = null;\n\n// keep a record of all events fired\nconst eventsFired = ttlCollection({\n  monotonic: true,\n  ttl: () => eventTTL,\n})\n\nconfig.getConfig(TTL_CONFIG, (val) => {\n  const previous = eventTTL;\n  val = val?.[TTL_CONFIG];\n  eventTTL = typeof val === 'number' ? val * 1000 : null;\n  if (previous !== eventTTL) {\n    eventsFired.refresh();\n  }\n});\n\nlet slice = Array.prototype.slice;\nlet push = Array.prototype.push;\n\n// define entire events\nlet allEvents = Object.values(EVENTS);\n\nconst idPaths = EVENT_ID_PATHS;\n\nconst _public = (function () {\n  let _handlers = {};\n  let _public = {};\n\n  /**\n   *\n   * @param {String} eventString  The name of the event.\n   * @param {Array} args  The payload emitted with the event.\n   * @private\n   */\n  function _dispatch(eventString, args) {\n    utils.logMessage('Emitting event for: ' + eventString);\n\n    let eventPayload = args[0] || {};\n    let idPath = idPaths[eventString];\n    let key = eventPayload[idPath];\n    let event = _handlers[eventString] || { que: [] };\n    var eventKeys = Object.keys(event);\n\n    let callbacks = [];\n\n    // record the event:\n    eventsFired.add({\n      eventType: eventString,\n      args: eventPayload,\n      id: key,\n      elapsedTime: utils.getPerformanceNow(),\n    });\n\n    /**\n     * Push each specific callback to the `callbacks` array.\n     * If the `event` map has a key that matches the value of the\n     * event payload id path, e.g. `eventPayload[idPath]`, then apply\n     * each function in the `que` array as an argument to push to the\n     * `callbacks` array\n     */\n    if (key && eventKeys.includes(key)) {\n      push.apply(callbacks, event[key].que);\n    }\n\n    /** Push each general callback to the `callbacks` array. */\n    push.apply(callbacks, event.que);\n\n    /** call each of the callbacks */\n    (callbacks || []).forEach(function (fn) {\n      if (!fn) return;\n      try {\n        fn.apply(null, args);\n      } catch (e) {\n        utils.logError('Error executing handler:', 'events.js', e, eventString);\n      }\n    });\n  }\n\n  function _checkAvailableEvent(event) {\n    return allEvents.includes(event)\n  }\n\n  _public.has = _checkAvailableEvent;\n\n  _public.on = function (eventString, handler, id) {\n    // check whether available event or not\n    if (_checkAvailableEvent(eventString)) {\n      let event = _handlers[eventString] || { que: [] };\n\n      if (id) {\n        event[id] = event[id] || { que: [] };\n        event[id].que.push(handler);\n      } else {\n        event.que.push(handler);\n      }\n\n      _handlers[eventString] = event;\n    } else {\n      utils.logError('Wrong event name : ' + eventString + ' Valid event names :' + allEvents);\n    }\n  };\n\n  _public.emit = function (event) {\n    let args = slice.call(arguments, 1);\n    _dispatch(event, args);\n  };\n\n  _public.off = function (eventString, handler, id) {\n    let event = _handlers[eventString];\n\n    if (utils.isEmpty(event) || (utils.isEmpty(event.que) && utils.isEmpty(event[id]))) {\n      return;\n    }\n\n    if (id && (utils.isEmpty(event[id]) || utils.isEmpty(event[id].que))) {\n      return;\n    }\n\n    if (id) {\n      (event[id].que || []).forEach(function (_handler) {\n        let que = event[id].que;\n        if (_handler === handler) {\n          que.splice(que.indexOf(_handler), 1);\n        }\n      });\n    } else {\n      (event.que || []).forEach(function (_handler) {\n        let que = event.que;\n        if (_handler === handler) {\n          que.splice(que.indexOf(_handler), 1);\n        }\n      });\n    }\n\n    _handlers[eventString] = event;\n  };\n\n  _public.get = function () {\n    return _handlers;\n  };\n\n  _public.addEvents = function (events) {\n    allEvents = allEvents.concat(events);\n  }\n\n  /**\n   * This method can return a copy of all the events fired\n   * @return {Array} array of events fired\n   */\n  _public.getEvents = function () {\n    return eventsFired.toArray().map(val => Object.assign({}, val))\n  };\n\n  return _public;\n}());\n\nutils._setEventEmitter(_public.emit.bind(_public));\n\nexport const {on, off, get, getEvents, emit, addEvents, has} = _public;\n\nexport function clearEvents() {\n  eventsFired.clear();\n}\n","import {logWarn} from '../utils.js';\n\n// mutually exclusive ORTB sections in order of priority - 'dooh' beats 'app' & 'site' and 'app' beats 'site';\n// if one is set, the others will be removed\nexport const CLIENT_SECTIONS = ['dooh', 'app', 'site']\n\nexport function clientSectionChecker(logPrefix) {\n  return function onlyOneClientSection(ortb2) {\n    CLIENT_SECTIONS.reduce((found, section) => {\n      if (hasSection(ortb2, section)) {\n        if (found != null) {\n          logWarn(`${logPrefix} specifies both '${found}' and '${section}'; dropping the latter.`)\n          delete ortb2[section];\n        } else {\n          found = section;\n        }\n      }\n      return found;\n    }, null);\n    return ortb2;\n  }\n}\n\nexport function hasSection(ortb2, section) {\n  return ortb2[section] != null && Object.keys(ortb2[section]).length > 0\n}\n","import funHooks from 'fun-hooks/no-eval/index.js';\nimport {defer} from './utils/promise.js';\n\nexport let hook = funHooks({\n  ready: funHooks.SYNC | funHooks.ASYNC | funHooks.QUEUE\n});\n\nconst readyCtl = defer();\nhook.ready = (() => {\n  const ready = hook.ready;\n  return function () {\n    try {\n      return ready.apply(hook, arguments);\n    } finally {\n      readyCtl.resolve();\n    }\n  }\n})();\n\n/**\n * A promise that resolves when hooks are ready.\n * @type {Promise}\n */\nexport const ready = readyCtl.promise;\n\nexport const getHook = hook.get;\n\nexport function setupBeforeHookFnOnce(baseFn, hookFn, priority = 15) {\n  let result = baseFn.getHooks({hook: hookFn});\n  if (result.length === 0) {\n    baseFn.before(hookFn, priority);\n  }\n}\nconst submoduleInstallMap = {};\n\nexport function module(name, install, {postInstallAllowed = false} = {}) {\n  hook('async', function (submodules) {\n    submodules.forEach(args => install(...args));\n    if (postInstallAllowed) submoduleInstallMap[name] = install;\n  }, name)([]); // will be queued until hook.ready() called in pbjs.processQueue();\n}\n\nexport function submodule(name, ...args) {\n  const install = submoduleInstallMap[name];\n  if (install) return install(...args);\n  getHook(name).before((next, modules) => {\n    modules.push(args);\n    next(modules);\n  });\n}\n\n/**\n * Copy hook methods (.before, .after, etc) from a given hook to a given wrapper object.\n */\nexport function wrapHook(hook, wrapper) {\n  Object.defineProperties(\n    wrapper,\n    Object.fromEntries(['before', 'after', 'getHooks', 'removeAll'].map((m) => [m, {get: () => hook[m]}]))\n  );\n  return wrapper;\n}\n","/**\n * This file contains the valid Media Types in Prebid.\n *\n * All adapters are assumed to support banner ads. Other media types are specified by Adapters when they\n * register themselves with prebid-core.\n */\n\n/**\n * @typedef {('native'|'video'|'banner')} MediaType\n * @typedef {('adpod')} VideoContext\n */\n\n/** @type {MediaType} */\nexport const NATIVE = 'native';\n/** @type {MediaType} */\nexport const VIDEO = 'video';\n/** @type {MediaType} */\nexport const BANNER = 'banner';\n/** @type {VideoContext} */\nexport const ADPOD = 'adpod';\n\nexport const ALL_MEDIATYPES = [NATIVE, VIDEO, BANNER];\n","import {\n  deepClone, getDefinedParams,\n  insertHtmlIntoIframe,\n  isArray,\n  isBoolean,\n  isInteger,\n  isNumber,\n  isPlainObject,\n  logError,\n  pick,\n  triggerPixel\n} from './utils.js';\nimport {includes} from './polyfill.js';\nimport {auctionManager} from './auctionManager.js';\nimport {NATIVE_ASSET_TYPES, NATIVE_IMAGE_TYPES, PREBID_NATIVE_DATA_KEYS_TO_ORTB, NATIVE_KEYS_THAT_ARE_NOT_ASSETS, NATIVE_KEYS} from './constants.js';\nimport {NATIVE} from './mediaTypes.js';\nimport {getRenderingData} from './adRendering.js';\nimport {getCreativeRendererSource, PUC_MIN_VERSION} from './creativeRenderers.js';\nimport {EVENT_TYPE_IMPRESSION, parseEventTrackers, TRACKER_METHOD_IMG, TRACKER_METHOD_JS} from './eventTrackers.js';\n\n/**\n * @typedef {import('../src/adapters/bidderFactory.js').BidRequest} BidRequest\n * @typedef {import('../src/adapters/bidderFactory.js').Bid} Bid\n */\n\nexport const nativeAdapters = [];\n\nexport const NATIVE_TARGETING_KEYS = Object.keys(NATIVE_KEYS).map(\n  key => NATIVE_KEYS[key]\n);\n\nexport const IMAGE = {\n  ortb: {\n    ver: '1.2',\n    assets: [\n      {\n        required: 1,\n        id: 1,\n        img: {\n          type: 3,\n          wmin: 100,\n          hmin: 100,\n        }\n      },\n      {\n        required: 1,\n        id: 2,\n        title: {\n          len: 140,\n        }\n      },\n      {\n        required: 1,\n        id: 3,\n        data: {\n          type: 1,\n        }\n      },\n      {\n        required: 0,\n        id: 4,\n        data: {\n          type: 2,\n        }\n      },\n      {\n        required: 0,\n        id: 5,\n        img: {\n          type: 1,\n          wmin: 20,\n          hmin: 20,\n        }\n      },\n    ],\n  },\n  image: { required: true },\n  title: { required: true },\n  sponsoredBy: { required: true },\n  clickUrl: { required: true },\n  body: { required: false },\n  icon: { required: false },\n};\n\nconst SUPPORTED_TYPES = {\n  image: IMAGE\n};\n\n// inverse native maps useful for converting to legacy\nconst PREBID_NATIVE_DATA_KEYS_TO_ORTB_INVERSE = inverse(PREBID_NATIVE_DATA_KEYS_TO_ORTB);\nconst NATIVE_ASSET_TYPES_INVERSE = inverse(NATIVE_ASSET_TYPES);\n\nexport function isNativeResponse(bidResponse) {\n  // check for native data and not mediaType; it's possible\n  // to treat banner responses as native\n  return bidResponse.native && typeof bidResponse.native === 'object';\n}\n\n/**\n * Recieves nativeParams from an adUnit. If the params were not of type 'type',\n * passes them on directly. If they were of type 'type', translate\n * them into the predefined specific asset requests for that type of native ad.\n */\nexport function processNativeAdUnitParams(params) {\n  if (params && params.type && typeIsSupported(params.type)) {\n    params = SUPPORTED_TYPES[params.type];\n  }\n\n  if (params && params.ortb && !isOpenRTBBidRequestValid(params.ortb)) {\n    return;\n  }\n  return params;\n}\n\nexport function decorateAdUnitsWithNativeParams(adUnits) {\n  adUnits.forEach(adUnit => {\n    const nativeParams =\n      adUnit.nativeParams || adUnit?.mediaTypes?.native;\n    if (nativeParams) {\n      adUnit.nativeParams = processNativeAdUnitParams(nativeParams);\n    }\n    if (adUnit.nativeParams) {\n      adUnit.nativeOrtbRequest = adUnit.nativeParams.ortb || toOrtbNativeRequest(adUnit.nativeParams);\n    }\n  });\n}\nexport function isOpenRTBBidRequestValid(ortb) {\n  const assets = ortb.assets;\n  if (!Array.isArray(assets) || assets.length === 0) {\n    logError(`assets in mediaTypes.native.ortb is not an array, or it's empty. Assets: `, assets);\n    return false;\n  }\n\n  // validate that ids exist, that they are unique and that they are numbers\n  const ids = assets.map(asset => asset.id);\n  if (assets.length !== new Set(ids).size || ids.some(id => id !== parseInt(id, 10))) {\n    logError(`each asset object must have 'id' property, it must be unique and it must be an integer`);\n    return false;\n  }\n\n  if (ortb.hasOwnProperty('eventtrackers') && !Array.isArray(ortb.eventtrackers)) {\n    logError('ortb.eventtrackers is not an array. Eventtrackers: ', ortb.eventtrackers);\n    return false;\n  }\n\n  return assets.every(asset => isOpenRTBAssetValid(asset))\n}\n\nfunction isOpenRTBAssetValid(asset) {\n  if (!isPlainObject(asset)) {\n    logError(`asset must be an object. Provided asset: `, asset);\n    return false;\n  }\n  if (asset.img) {\n    if (!isNumber(asset.img.w) && !isNumber(asset.img.wmin)) {\n      logError(`for img asset there must be 'w' or 'wmin' property`);\n      return false;\n    }\n    if (!isNumber(asset.img.h) && !isNumber(asset.img.hmin)) {\n      logError(`for img asset there must be 'h' or 'hmin' property`);\n      return false;\n    }\n  } else if (asset.title) {\n    if (!isNumber(asset.title.len)) {\n      logError(`for title asset there must be 'len' property defined`);\n      return false;\n    }\n  } else if (asset.data) {\n    if (!isNumber(asset.data.type)) {\n      logError(`for data asset 'type' property must be a number`);\n      return false;\n    }\n  } else if (asset.video) {\n    if (!Array.isArray(asset.video.mimes) || !Array.isArray(asset.video.protocols) ||\n      !isNumber(asset.video.minduration) || !isNumber(asset.video.maxduration)) {\n      logError('video asset is not properly configured');\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Check if the native type specified in the adUnit is supported by Prebid.\n */\nfunction typeIsSupported(type) {\n  if (!(type && includes(Object.keys(SUPPORTED_TYPES), type))) {\n    logError(`${type} nativeParam is not supported`);\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Helper functions for working with native-enabled adUnits\n * TODO: abstract this and the video helper functions into general\n * adunit validation helper functions\n */\nexport const nativeAdUnit = adUnit => {\n  const mediaType = adUnit.mediaType === 'native';\n  const mediaTypes = adUnit?.mediaTypes?.native;\n  return mediaType || mediaTypes;\n}\nexport const nativeBidder = bid => includes(nativeAdapters, bid.bidder);\nexport const hasNonNativeBidder = adUnit =>\n  adUnit.bids.filter(bid => !nativeBidder(bid)).length;\n\n/**\n * Validate that the native assets on this bid contain all assets that were\n * marked as required in the adUnit configuration.\n * @param {Bid} bid Native bid to validate\n * @param {BidRequest[]} bidRequests All bid requests for an auction\n * @return {Boolean} If object is valid\n */\nexport function nativeBidIsValid(bid, {index = auctionManager.index} = {}) {\n  const adUnit = index.getAdUnit(bid);\n  if (!adUnit) { return false; }\n  let ortbRequest = adUnit.nativeOrtbRequest\n  let ortbResponse = bid.native?.ortb || toOrtbNativeResponse(bid.native, ortbRequest);\n  return isNativeOpenRTBBidValid(ortbResponse, ortbRequest);\n}\n\nexport function isNativeOpenRTBBidValid(bidORTB, bidRequestORTB) {\n  if (!bidORTB?.link?.url) {\n    logError(`native response doesn't have 'link' property. Ortb response: `, bidORTB);\n    return false;\n  }\n\n  let requiredAssetIds = bidRequestORTB.assets.filter(asset => asset.required === 1).map(a => a.id);\n  let returnedAssetIds = bidORTB.assets.map(asset => asset.id);\n\n  const match = requiredAssetIds.every(assetId => includes(returnedAssetIds, assetId));\n  if (!match) {\n    logError(`didn't receive a bid with all required assets. Required ids: ${requiredAssetIds}, but received ids in response: ${returnedAssetIds}`);\n  }\n\n  return match;\n}\n\n/*\n * Native responses may have associated impression or click trackers.\n * This retrieves the appropriate tracker urls for the given ad object and\n * fires them. As a native creatives may be in a cross-origin frame, it may be\n * necessary to invoke this function via postMessage. secureCreatives is\n * configured to fire this function when it receives a `message` of 'Prebid Native'\n * and an `adId` with the value of the `bid.adId`. When a message is posted with\n * these parameters, impression trackers are fired. To fire click trackers, the\n * message should contain an `action` set to 'click'.\n *\n * // Native creative template example usage\n * <a href=\"%%CLICK_URL_UNESC%%%%PATTERN:hb_native_linkurl%%\"\n *    target=\"_blank\"\n *    onclick=\"fireTrackers('click')\">\n *    %%PATTERN:hb_native_title%%\n * </a>\n *\n * <script>\n *   function fireTrackers(action) {\n *     var message = {message: 'Prebid Native', adId: '%%PATTERN:hb_adid%%'};\n *     if (action === 'click') {message.action = 'click';} // fires click trackers\n *     window.parent.postMessage(JSON.stringify(message), '*');\n *   }\n *   fireTrackers(); // fires impressions when creative is loaded\n * </script>\n */\nexport function fireNativeTrackers(message, bidResponse) {\n  const nativeResponse = bidResponse.native.ortb || legacyPropertiesToOrtbNative(bidResponse.native);\n\n  if (message.action === 'click') {\n    fireClickTrackers(nativeResponse, message?.assetId);\n  } else {\n    fireImpressionTrackers(nativeResponse);\n  }\n  return message.action;\n}\n\nexport function fireImpressionTrackers(nativeResponse, {runMarkup = (mkup) => insertHtmlIntoIframe(mkup), fetchURL = triggerPixel} = {}) {\n  let {[TRACKER_METHOD_IMG]: img = [], [TRACKER_METHOD_JS]: js = []} = parseEventTrackers(\n    nativeResponse.eventtrackers || []\n  )[EVENT_TYPE_IMPRESSION] || {};\n\n  if (nativeResponse.imptrackers) {\n    img = img.concat(nativeResponse.imptrackers);\n  }\n  img.forEach(url => fetchURL(url));\n\n  js = js.map(url => `<script async src=\"${url}\"></script>`);\n  if (nativeResponse.jstracker) {\n    // jstracker is already HTML markup\n    js = js.concat([nativeResponse.jstracker]);\n  }\n  if (js.length) {\n    runMarkup(js.join('\\n'));\n  }\n}\n\nexport function fireClickTrackers(nativeResponse, assetId = null, {fetchURL = triggerPixel} = {}) {\n  // legacy click tracker\n  if (!assetId) {\n    (nativeResponse.link?.clicktrackers || []).forEach(url => fetchURL(url));\n  } else {\n    // ortb click tracker. This will try to call the clicktracker associated with the asset;\n    // will fallback to the link if none is found.\n    const assetIdLinkMap = (nativeResponse.assets || [])\n      .filter(a => a.link)\n      .reduce((map, asset) => {\n        map[asset.id] = asset.link;\n        return map\n      }, {});\n    const masterClickTrackers = nativeResponse.link?.clicktrackers || [];\n    let assetLink = assetIdLinkMap[assetId];\n    let clickTrackers = masterClickTrackers;\n    if (assetLink) {\n      clickTrackers = assetLink.clicktrackers || [];\n    }\n    clickTrackers.forEach(url => fetchURL(url));\n  }\n}\n\nexport function setNativeResponseProperties(bid, adUnit) {\n  const nativeOrtbRequest = adUnit?.nativeOrtbRequest;\n  const nativeOrtbResponse = bid.native?.ortb;\n\n  if (nativeOrtbRequest && nativeOrtbResponse) {\n    const legacyResponse = toLegacyResponse(nativeOrtbResponse, nativeOrtbRequest);\n    Object.assign(bid.native, legacyResponse);\n  }\n\n  ['rendererUrl', 'adTemplate'].forEach(prop => {\n    const val = adUnit?.nativeParams?.[prop];\n    if (val) {\n      bid.native[prop] = getAssetValue(val);\n    }\n  });\n}\n\n/**\n * Gets native targeting key-value pairs\n * @param {Object} bid\n * @return {Object} targeting\n */\nexport function getNativeTargeting(bid, {index = auctionManager.index} = {}) {\n  let keyValues = {};\n  const adUnit = index.getAdUnit(bid);\n\n  const globalSendTargetingKeys = adUnit?.nativeParams?.ortb == null && adUnit?.nativeParams?.sendTargetingKeys !== false;\n\n  const nativeKeys = getNativeKeys(adUnit);\n\n  const flatBidNativeKeys = { ...bid.native, ...bid.native.ext };\n  delete flatBidNativeKeys.ext;\n\n  Object.keys(flatBidNativeKeys).forEach(asset => {\n    const key = nativeKeys[asset];\n    let value = getAssetValue(bid.native[asset]) || getAssetValue(bid?.native?.ext?.[asset]);\n\n    if (asset === 'adTemplate' || !key || !value) {\n      return;\n    }\n\n    let sendPlaceholder = adUnit?.nativeParams?.[asset]?.sendId;\n    if (typeof sendPlaceholder !== 'boolean') {\n      sendPlaceholder = adUnit?.nativeParams?.ext?.[asset]?.sendId;\n    }\n\n    if (sendPlaceholder) {\n      const placeholder = `${key}:${bid.adId}`;\n      value = placeholder;\n    }\n\n    let assetSendTargetingKeys = adUnit?.nativeParams?.[asset]?.sendTargetingKeys;\n    if (typeof assetSendTargetingKeys !== 'boolean') {\n      assetSendTargetingKeys = adUnit?.nativeParams?.ext?.[asset]?.sendTargetingKeys;\n    }\n\n    const sendTargeting = typeof assetSendTargetingKeys === 'boolean' ? assetSendTargetingKeys : globalSendTargetingKeys;\n\n    if (sendTargeting) {\n      keyValues[key] = value;\n    }\n  });\n\n  return keyValues;\n}\n\nfunction getNativeAssets(nativeProps, keys, ext = false) {\n  let assets = [];\n  Object.entries(nativeProps)\n    .filter(([k, v]) => v && ((ext === false && k === 'ext') || keys == null || keys.includes(k)))\n    .forEach(([key, value]) => {\n      if (ext === false && key === 'ext') {\n        assets.push(...getNativeAssets(value, keys, true));\n      } else if (ext || NATIVE_KEYS.hasOwnProperty(key)) {\n        assets.push({key, value: getAssetValue(value)});\n      }\n    });\n  return assets;\n}\n\nexport function getNativeRenderingData(bid, adUnit, keys) {\n  const data = {\n    ...getDefinedParams(bid.native, ['rendererUrl', 'adTemplate']),\n    assets: getNativeAssets(bid.native, keys),\n    nativeKeys: NATIVE_KEYS\n  };\n  if (bid.native.ortb) {\n    data.ortb = bid.native.ortb;\n  } else if (adUnit.mediaTypes?.native?.ortb) {\n    data.ortb = toOrtbNativeResponse(bid.native, adUnit.nativeOrtbRequest);\n  }\n  return data;\n}\n\nfunction assetsMessage(data, adObject, keys, {index = auctionManager.index} = {}) {\n  const msg = {\n    message: 'assetResponse',\n    adId: data.adId,\n  };\n  let renderData = getRenderingData(adObject).native;\n  if (renderData) {\n    // if we have native rendering data (set up by the nativeRendering module)\n    // include it in full (\"all assets\") together with the renderer.\n    // this is to allow PUC to use dynamic renderers without requiring changes in creative setup\n    msg.native = Object.assign({}, renderData);\n    msg.renderer = getCreativeRendererSource(adObject);\n    msg.rendererVersion = PUC_MIN_VERSION;\n    if (keys != null) {\n      renderData.assets = renderData.assets.filter(({key}) => keys.includes(key))\n    }\n  } else {\n    renderData = getNativeRenderingData(adObject, index.getAdUnit(adObject), keys);\n  }\n  return Object.assign(msg, renderData);\n}\n\nconst NATIVE_KEYS_INVERTED = Object.fromEntries(Object.entries(NATIVE_KEYS).map(([k, v]) => [v, k]));\n\n/**\n * Constructs a message object containing asset values for each of the\n * requested data keys.\n */\nexport function getAssetMessage(data, adObject) {\n  const keys = data.assets.map((k) => NATIVE_KEYS_INVERTED[k]);\n  return assetsMessage(data, adObject, keys);\n}\n\nexport function getAllAssetsMessage(data, adObject) {\n  return assetsMessage(data, adObject, null);\n}\n\n/**\n * Native assets can be a string or an object with a url prop. Returns the value\n * appropriate for sending in adserver targeting or placeholder replacement.\n */\nfunction getAssetValue(value) {\n  return value?.url || value;\n}\n\nfunction getNativeKeys(adUnit) {\n  const extraNativeKeys = {}\n\n  if (adUnit?.nativeParams?.ext) {\n    Object.keys(adUnit.nativeParams.ext).forEach(extKey => {\n      extraNativeKeys[extKey] = `hb_native_${extKey}`;\n    })\n  }\n\n  return {\n    ...NATIVE_KEYS,\n    ...extraNativeKeys\n  }\n}\n\n/**\n * converts Prebid legacy native assets request to OpenRTB format\n * @param {object} legacyNativeAssets an object that describes a native bid request in Prebid proprietary format\n * @returns an OpenRTB format of the same bid request\n */\nexport function toOrtbNativeRequest(legacyNativeAssets) {\n  if (!legacyNativeAssets && !isPlainObject(legacyNativeAssets)) {\n    logError('Native assets object is empty or not an object: ', legacyNativeAssets);\n    return;\n  }\n  const ortb = {\n    ver: '1.2',\n    assets: []\n  };\n  for (let key in legacyNativeAssets) {\n    // skip conversion for non-asset keys\n    if (NATIVE_KEYS_THAT_ARE_NOT_ASSETS.includes(key)) continue;\n    if (!NATIVE_KEYS.hasOwnProperty(key)) {\n      logError(`Unrecognized native asset code: ${key}. Asset will be ignored.`);\n      continue;\n    }\n\n    if (key === 'privacyLink') {\n      ortb.privacy = 1;\n      continue;\n    }\n\n    const asset = legacyNativeAssets[key];\n    let required = 0;\n    if (asset.required && isBoolean(asset.required)) {\n      required = Number(asset.required);\n    }\n    const ortbAsset = {\n      id: ortb.assets.length,\n      required\n    };\n    // data cases\n    if (key in PREBID_NATIVE_DATA_KEYS_TO_ORTB) {\n      ortbAsset.data = {\n        type: NATIVE_ASSET_TYPES[PREBID_NATIVE_DATA_KEYS_TO_ORTB[key]]\n      }\n      if (asset.len) {\n        ortbAsset.data.len = asset.len;\n      }\n    // icon or image case\n    } else if (key === 'icon' || key === 'image') {\n      ortbAsset.img = {\n        type: key === 'icon' ? NATIVE_IMAGE_TYPES.ICON : NATIVE_IMAGE_TYPES.MAIN,\n      }\n      // if min_width and min_height are defined in aspect_ratio, they are preferred\n      if (asset.aspect_ratios) {\n        if (!isArray(asset.aspect_ratios)) {\n          logError(\"image.aspect_ratios was passed, but it's not a an array:\", asset.aspect_ratios);\n        } else if (!asset.aspect_ratios.length) {\n          logError(\"image.aspect_ratios was passed, but it's empty:\", asset.aspect_ratios);\n        } else {\n          const { min_width: minWidth, min_height: minHeight } = asset.aspect_ratios[0];\n          if (!isInteger(minWidth) || !isInteger(minHeight)) {\n            logError('image.aspect_ratios min_width or min_height are invalid: ', minWidth, minHeight);\n          } else {\n            ortbAsset.img.wmin = minWidth;\n            ortbAsset.img.hmin = minHeight;\n          }\n          const aspectRatios = asset.aspect_ratios\n            .filter((ar) => ar.ratio_width && ar.ratio_height)\n            .map(ratio => `${ratio.ratio_width}:${ratio.ratio_height}`);\n          if (aspectRatios.length > 0) {\n            ortbAsset.img.ext = {\n              aspectratios: aspectRatios\n            }\n          }\n        }\n      }\n\n      // if asset.sizes exist, by OpenRTB spec we should remove wmin and hmin\n      if (asset.sizes) {\n        if (asset.sizes.length !== 2 || !isInteger(asset.sizes[0]) || !isInteger(asset.sizes[1])) {\n          logError('image.sizes was passed, but its value is not an array of integers:', asset.sizes);\n        } else {\n          ortbAsset.img.w = asset.sizes[0];\n          ortbAsset.img.h = asset.sizes[1];\n          delete ortbAsset.img.hmin;\n          delete ortbAsset.img.wmin;\n        }\n      }\n    // title case\n    } else if (key === 'title') {\n      ortbAsset.title = {\n        // in openRTB, len is required for titles, while in legacy prebid was not.\n        // for this reason, if len is missing in legacy prebid, we're adding a default value of 140.\n        len: asset.len || 140\n      }\n    // all extensions to the native bid request are passed as is\n    } else if (key === 'ext') {\n      ortbAsset.ext = asset;\n      // in `ext` case, required field is not needed\n      delete ortbAsset.required;\n    }\n    ortb.assets.push(ortbAsset);\n  }\n  return ortb;\n}\n\n/**\n * Greatest common divisor between two positive integers\n * https://en.wikipedia.org/wiki/Euclidean_algorithm\n */\nfunction gcd(a, b) {\n  while (a && b && a !== b) {\n    if (a > b) {\n      a = a - b;\n    } else {\n      b = b - a;\n    }\n  }\n  return a || b;\n}\n\n/**\n * This function converts an OpenRTB native request object to Prebid proprietary\n * format. The purpose of this function is to help adapters to handle the\n * transition phase where publishers may be using OpenRTB objects but the\n *  bidder does not yet support it.\n * @param {object} openRTBRequest an OpenRTB v1.2 request object\n * @returns a Prebid legacy native format request\n */\nexport function fromOrtbNativeRequest(openRTBRequest) {\n  if (!isOpenRTBBidRequestValid(openRTBRequest)) {\n    return;\n  }\n\n  const oldNativeObject = {};\n  for (const asset of openRTBRequest.assets) {\n    if (asset.title) {\n      const title = {\n        required: asset.required ? Boolean(asset.required) : false,\n        len: asset.title.len\n      }\n      oldNativeObject.title = title;\n    } else if (asset.img) {\n      const image = {\n        required: asset.required ? Boolean(asset.required) : false,\n      }\n      if (asset.img.w && asset.img.h) {\n        image.sizes = [asset.img.w, asset.img.h];\n      } else if (asset.img.wmin && asset.img.hmin) {\n        const scale = gcd(asset.img.wmin, asset.img.hmin)\n        image.aspect_ratios = [{\n          min_width: asset.img.wmin,\n          min_height: asset.img.hmin,\n          ratio_width: asset.img.wmin / scale,\n          ratio_height: asset.img.hmin / scale\n        }]\n      }\n\n      if (asset.img.type === NATIVE_IMAGE_TYPES.MAIN) {\n        oldNativeObject.image = image;\n      } else {\n        oldNativeObject.icon = image;\n      }\n    } else if (asset.data) {\n      let assetType = Object.keys(NATIVE_ASSET_TYPES).find(k => NATIVE_ASSET_TYPES[k] === asset.data.type);\n      let prebidAssetName = Object.keys(PREBID_NATIVE_DATA_KEYS_TO_ORTB).find(k => PREBID_NATIVE_DATA_KEYS_TO_ORTB[k] === assetType);\n      oldNativeObject[prebidAssetName] = {\n        required: asset.required ? Boolean(asset.required) : false,\n      }\n      if (asset.data.len) {\n        oldNativeObject[prebidAssetName].len = asset.data.len;\n      }\n    }\n    if (openRTBRequest.privacy) {\n      oldNativeObject.privacyLink = { required: false };\n    }\n    // video was not supported by old prebid assets\n  }\n  return oldNativeObject;\n}\n\n/**\n * Converts an OpenRTB request to a proprietary Prebid.js format.\n * The proprietary Prebid format has many limitations and will be dropped in\n * the future; adapters are encouraged to stop using it in favour of OpenRTB format.\n * IMPLEMENTATION DETAILS: This function returns the same exact object if no\n * conversion is needed. If a conversion is needed (meaning, at least one\n * bidRequest contains a native.ortb definition), it will return a copy.\n *\n * @param {BidRequest[]} bidRequests an array of valid bid requests\n * @returns an array of valid bid requests where the openRTB bids are converted to proprietary format.\n */\nexport function convertOrtbRequestToProprietaryNative(bidRequests) {\n  if (FEATURES.NATIVE) {\n    if (!bidRequests || !isArray(bidRequests)) return bidRequests;\n    // check if a conversion is needed\n    if (!bidRequests.some(bidRequest => (bidRequest?.mediaTypes || {})[NATIVE]?.ortb)) {\n      return bidRequests;\n    }\n    let bidRequestsCopy = deepClone(bidRequests);\n    // convert Native ORTB definition to old-style prebid native definition\n    for (const bidRequest of bidRequestsCopy) {\n      if (bidRequest.mediaTypes && bidRequest.mediaTypes[NATIVE] && bidRequest.mediaTypes[NATIVE].ortb) {\n        bidRequest.mediaTypes[NATIVE] = Object.assign(\n          pick(bidRequest.mediaTypes[NATIVE], NATIVE_KEYS_THAT_ARE_NOT_ASSETS),\n          fromOrtbNativeRequest(bidRequest.mediaTypes[NATIVE].ortb)\n        );\n        bidRequest.nativeParams = processNativeAdUnitParams(bidRequest.mediaTypes[NATIVE]);\n      }\n    }\n    return bidRequestsCopy;\n  }\n  return bidRequests;\n}\n\n/**\n * convert PBJS proprietary native properties that are *not* assets to the ORTB native format.\n *\n * @param legacyNative `bidResponse.native` object as returned by adapters\n */\nexport function legacyPropertiesToOrtbNative(legacyNative) {\n  const response = {\n    link: {},\n    eventtrackers: []\n  }\n  Object.entries(legacyNative).forEach(([key, value]) => {\n    switch (key) {\n      case 'clickUrl':\n        response.link.url = value;\n        break;\n      case 'clickTrackers':\n        response.link.clicktrackers = Array.isArray(value) ? value : [value];\n        break;\n      case 'impressionTrackers':\n        (Array.isArray(value) ? value : [value]).forEach(url => {\n          response.eventtrackers.push({\n            event: EVENT_TYPE_IMPRESSION,\n            method: TRACKER_METHOD_IMG,\n            url\n          });\n        });\n        break;\n      case 'javascriptTrackers':\n        // jstracker is deprecated, but we need to use it here since 'javascriptTrackers' is markup, not an url\n        // TODO: at the time of writing this, core expected javascriptTrackers to be a string (despite the name),\n        // but many adapters are passing an array. It's possible that some of them are, in fact, passing URLs and not markup\n        // in general, native trackers seem to be neglected and/or broken\n        response.jstracker = Array.isArray(value) ? value.join('') : value;\n        break;\n      case 'privacyLink':\n        response.privacy = value;\n        break;\n    }\n  });\n  return response;\n}\n\nexport function toOrtbNativeResponse(legacyResponse, ortbRequest) {\n  const ortbResponse = {\n    ...legacyPropertiesToOrtbNative(legacyResponse),\n    assets: []\n  };\n\n  function useRequestAsset(predicate, fn) {\n    let asset = ortbRequest.assets.find(predicate);\n    if (asset != null) {\n      asset = deepClone(asset);\n      fn(asset);\n      ortbResponse.assets.push(asset);\n    }\n  }\n\n  Object.keys(legacyResponse).filter(key => !!legacyResponse[key]).forEach(key => {\n    const value = getAssetValue(legacyResponse[key]);\n    switch (key) {\n      // process titles\n      case 'title':\n        useRequestAsset(asset => asset.title != null, titleAsset => {\n          titleAsset.title = {\n            text: value\n          };\n        })\n        break;\n      case 'image':\n      case 'icon':\n        const imageType = key === 'image' ? NATIVE_IMAGE_TYPES.MAIN : NATIVE_IMAGE_TYPES.ICON;\n        useRequestAsset(asset => asset.img != null && asset.img.type === imageType, imageAsset => {\n          imageAsset.img = {\n            url: value\n          };\n        })\n        break;\n      default:\n        if (key in PREBID_NATIVE_DATA_KEYS_TO_ORTB) {\n          useRequestAsset(asset => asset.data != null && asset.data.type === NATIVE_ASSET_TYPES[PREBID_NATIVE_DATA_KEYS_TO_ORTB[key]], dataAsset => {\n            dataAsset.data = {\n              value\n            };\n          })\n        }\n        break;\n    }\n  });\n  return ortbResponse;\n}\n\n/**\n * Generates a legacy response from an ortb response. Useful during the transition period.\n * @param {*} ortbResponse a standard ortb response object\n * @param {*} ortbRequest the ortb request, useful to match ids.\n * @returns an object containing the response in legacy native format: { title: \"this is a title\", image: ... }\n */\nexport function toLegacyResponse(ortbResponse, ortbRequest) {\n  const legacyResponse = {};\n  const requestAssets = ortbRequest?.assets || [];\n  legacyResponse.clickUrl = ortbResponse.link?.url;\n  legacyResponse.privacyLink = ortbResponse.privacy;\n  for (const asset of ortbResponse?.assets || []) {\n    const requestAsset = requestAssets.find(reqAsset => asset.id === reqAsset.id);\n    if (asset.title) {\n      legacyResponse.title = asset.title.text;\n    } else if (asset.img) {\n      legacyResponse[requestAsset?.img?.type === NATIVE_IMAGE_TYPES.MAIN ? 'image' : 'icon'] = {\n        url: asset.img.url,\n        width: asset.img.w,\n        height: asset.img.h\n      };\n    } else if (asset.data) {\n      legacyResponse[PREBID_NATIVE_DATA_KEYS_TO_ORTB_INVERSE[NATIVE_ASSET_TYPES_INVERSE[requestAsset?.data?.type]]] = asset.data.value;\n    }\n  }\n\n  // Handle trackers\n  legacyResponse.impressionTrackers = [];\n  let jsTrackers = [];\n\n  if (ortbResponse.imptrackers) {\n    legacyResponse.impressionTrackers.push(...ortbResponse.imptrackers);\n  }\n  for (const eventTracker of ortbResponse?.eventtrackers || []) {\n    if (eventTracker.event === EVENT_TYPE_IMPRESSION && eventTracker.method === TRACKER_METHOD_IMG) {\n      legacyResponse.impressionTrackers.push(eventTracker.url);\n    }\n    if (eventTracker.event === EVENT_TYPE_IMPRESSION && eventTracker.method === TRACKER_METHOD_JS) {\n      jsTrackers.push(eventTracker.url);\n    }\n  }\n\n  jsTrackers = jsTrackers.map(url => `<script async src=\"${url}\"></script>`);\n  if (ortbResponse?.jstracker) { jsTrackers.push(ortbResponse.jstracker); }\n  if (jsTrackers.length) {\n    legacyResponse.javascriptTrackers = jsTrackers.join('\\n');\n  }\n\n  return legacyResponse;\n}\n\n/**\n * Inverts key-values of an object.\n */\nfunction inverse(obj) {\n  var retobj = {};\n  for (var key in obj) {\n    retobj[obj[key]] = key;\n  }\n  return retobj;\n}\n","// These stubs are here to help transition away from core-js polyfills for browsers we are no longer supporting.\n// You should not need these for new code; use stock JS instead!\n\nexport function includes(target, elem, start) {\n  return (target && target.includes(elem, start)) || false;\n}\n\nexport function arrayFrom() {\n  return Array.from.apply(Array, arguments);\n}\n\nexport function find(arr, pred, thisArg) {\n  return arr && arr.find(pred, thisArg);\n}\n\nexport function findIndex(arr, pred, thisArg) {\n  return arr && arr.findIndex(pred, thisArg);\n}\n","// if $$PREBID_GLOBAL$$ already exists in global document scope, use it, if not, create the object\n// global defination should happen BEFORE imports to avoid global undefined errors.\n/* global $$DEFINE_PREBID_GLOBAL$$ */\nconst scope = !$$DEFINE_PREBID_GLOBAL$$ ? {} : window;\nconst global = scope.$$PREBID_GLOBAL$$ = scope.$$PREBID_GLOBAL$$ || {};\nglobal.cmd = global.cmd || [];\nglobal.que = global.que || [];\n\n// create a pbjs global pointer\nif (scope === window) {\n  scope._pbjsGlobals = scope._pbjsGlobals || [];\n  scope._pbjsGlobals.push('$$PREBID_GLOBAL$$');\n}\n\nexport function getGlobal() {\n  return global;\n}\n\nexport function registerModule(name) {\n  global.installedModules.push(name);\n}\n","/**\n * The referer detection module attempts to gather referer information from the current page that prebid.js resides in.\n * The information that it tries to collect includes:\n * The detected top url in the nav bar,\n * Whether it was able to reach the top most window (if for example it was embedded in several iframes),\n * The number of iframes it was embedded in if applicable (by default max ten iframes),\n * A list of the domains of each embedded window if applicable.\n * Canonical URL which refers to an HTML link element, with the attribute of rel=\"canonical\", found in the <head> element of your webpage\n */\n\nimport { config } from './config.js';\nimport {logWarn} from './utils.js';\n\n/**\n * Prepend a URL with the page's protocol (http/https), if necessary.\n */\nexport function ensureProtocol(url, win = window) {\n  if (!url) return url;\n  if (/\\w+:\\/\\//.exec(url)) {\n    // url already has protocol\n    return url;\n  }\n  let windowProto = win.location.protocol;\n  try {\n    windowProto = win.top.location.protocol;\n  } catch (e) {}\n  if (/^\\/\\//.exec(url)) {\n    // url uses relative protocol (\"//example.com\")\n    return windowProto + url;\n  } else {\n    return `${windowProto}//${url}`;\n  }\n}\n\n/**\n * Extract the domain portion from a URL.\n * @param {string} url - The URL to extract the domain from.\n * @param {Object} options - Options for parsing the domain.\n * @param {boolean} options.noLeadingWww - If true, remove 'www.' appearing at the beginning of the domain.\n * @param {boolean} options.noPort - If true, do not include the ':[port]' portion.\n * @return {string|undefined} - The extracted domain or undefined if the URL is invalid.\n */\nexport function parseDomain(url, {noLeadingWww = false, noPort = false} = {}) {\n  try {\n    url = new URL(ensureProtocol(url));\n  } catch (e) {\n    return;\n  }\n  url = noPort ? url.hostname : url.host;\n  if (noLeadingWww && url.startsWith('www.')) {\n    url = url.substring(4);\n  }\n  return url;\n}\n\n/**\n * This function returns canonical URL which refers to an HTML link element, with the attribute of rel=\"canonical\", found in the <head> element of your webpage\n *\n * @param {Object} doc document\n * @returns {string|null}\n */\nfunction getCanonicalUrl(doc) {\n  try {\n    const element = doc.querySelector(\"link[rel='canonical']\");\n\n    if (element !== null) {\n      return element.href;\n    }\n  } catch (e) {\n    // Ignore error\n  }\n\n  return null;\n}\n\n/**\n * @param {Window} win Window\n * @returns {Function}\n */\nexport function detectReferer(win) {\n  /**\n   * This function would return a read-only array of hostnames for all the parent frames.\n   * win.location.ancestorOrigins is only supported in webkit browsers. For non-webkit browsers it will return undefined.\n   *\n   * @param {Window} win Window object\n   * @returns {(undefined|Array)} Ancestor origins or undefined\n   */\n  function getAncestorOrigins(win) {\n    try {\n      if (!win.location.ancestorOrigins) {\n        return;\n      }\n\n      return win.location.ancestorOrigins;\n    } catch (e) {\n      // Ignore error\n    }\n  }\n\n  // TODO: the meaning of \"reachedTop\" seems to be intentionally ambiguous - best to leave them out of\n  // the typedef for now. (for example, unit tests enforce that \"reachedTop\" should be false in some situations where we\n  // happily provide a location for the top).\n\n  /**\n   * @typedef {Object} refererInfo\n   * @property {string|null} location the browser's location, or null if not available (due to cross-origin restrictions)\n   * @property {string|null} canonicalUrl the site's canonical URL as set by the publisher, through setConfig({pageUrl}) or <link rel=\"canonical\" />\n   * @property {string|null} page the best candidate for the current page URL: `canonicalUrl`, falling back to `location`\n   * @property {string|null} domain the domain portion of `page`\n   * @property {string|null} ref the referrer (document.referrer) to the current page, or null if not available (due to cross-origin restrictions)\n   * @property {string} topmostLocation of the top-most frame for which we could guess the location. Outside of cross-origin scenarios, this is equivalent to `location`.\n   * @property {number} numIframes number of steps between window.self and window.top\n   * @property {Array<string|null>} stack our best guess at the location for each frame, in the direction top -> self.\n   */\n\n  /**\n   * Walk up the windows to get the origin stack and best available referrer, canonical URL, etc.\n   *\n   * @returns {refererInfo} An object containing referer information.\n   */\n  function refererInfo() {\n    const stack = [];\n    const ancestors = getAncestorOrigins(win);\n    const maxNestedIframes = config.getConfig('maxNestedIframes');\n\n    let currentWindow;\n    let bestLocation;\n    let bestCanonicalUrl;\n    let reachedTop = false;\n    let level = 0;\n    let valuesFromAmp = false;\n    let inAmpFrame = false;\n    let hasTopLocation = false;\n\n    do {\n      const previousWindow = currentWindow;\n      const wasInAmpFrame = inAmpFrame;\n      let currentLocation;\n      let crossOrigin = false;\n      let foundLocation = null;\n\n      inAmpFrame = false;\n      currentWindow = currentWindow ? currentWindow.parent : win;\n\n      try {\n        currentLocation = currentWindow.location.href || null;\n      } catch (e) {\n        crossOrigin = true;\n      }\n\n      if (crossOrigin) {\n        if (wasInAmpFrame) {\n          const context = previousWindow.context;\n\n          try {\n            foundLocation = context.sourceUrl;\n            bestLocation = foundLocation;\n            hasTopLocation = true;\n\n            valuesFromAmp = true;\n\n            if (currentWindow === win.top) {\n              reachedTop = true;\n            }\n\n            if (context.canonicalUrl) {\n              bestCanonicalUrl = context.canonicalUrl;\n            }\n          } catch (e) { /* Do nothing */ }\n        } else {\n          logWarn('Trying to access cross domain iframe. Continuing without referrer and location');\n\n          try {\n            // the referrer to an iframe is the parent window\n            const referrer = previousWindow.document.referrer;\n\n            if (referrer) {\n              foundLocation = referrer;\n\n              if (currentWindow === win.top) {\n                reachedTop = true;\n              }\n            }\n          } catch (e) { /* Do nothing */ }\n\n          if (!foundLocation && ancestors && ancestors[level - 1]) {\n            foundLocation = ancestors[level - 1];\n            if (currentWindow === win.top) {\n              hasTopLocation = true;\n            }\n          }\n\n          if (foundLocation && !valuesFromAmp) {\n            bestLocation = foundLocation;\n          }\n        }\n      } else {\n        if (currentLocation) {\n          foundLocation = currentLocation;\n          bestLocation = foundLocation;\n          valuesFromAmp = false;\n\n          if (currentWindow === win.top) {\n            reachedTop = true;\n\n            const canonicalUrl = getCanonicalUrl(currentWindow.document);\n\n            if (canonicalUrl) {\n              bestCanonicalUrl = canonicalUrl;\n            }\n          }\n        }\n\n        if (currentWindow.context && currentWindow.context.sourceUrl) {\n          inAmpFrame = true;\n        }\n      }\n\n      stack.push(foundLocation);\n      level++;\n    } while (currentWindow !== win.top && level < maxNestedIframes);\n\n    stack.reverse();\n\n    let ref;\n    try {\n      ref = win.top.document.referrer;\n    } catch (e) {}\n\n    const location = reachedTop || hasTopLocation ? bestLocation : null;\n    const canonicalUrl = config.getConfig('pageUrl') || bestCanonicalUrl || null;\n    let page = config.getConfig('pageUrl') || location || ensureProtocol(canonicalUrl, win);\n\n    if (location && location.indexOf('?') > -1 && page.indexOf('?') === -1) {\n      page = `${page}${location.substring(location.indexOf('?'))}`;\n    }\n\n    return {\n      reachedTop,\n      isAmp: valuesFromAmp,\n      numIframes: level - 1,\n      stack,\n      topmostLocation: bestLocation || null,\n      location,\n      canonicalUrl,\n      page,\n      domain: parseDomain(page) || null,\n      ref: ref || null,\n      // TODO: the \"legacy\" refererInfo object is provided here, for now, to accomodate\n      // adapters that decided to just send it verbatim to their backend.\n      legacy: {\n        reachedTop,\n        isAmp: valuesFromAmp,\n        numIframes: level - 1,\n        stack,\n        referer: bestLocation || null,\n        canonicalUrl\n      }\n    };\n  }\n\n  return refererInfo;\n}\n\n// cache result of fn (= referer info) as long as:\n// - we are the top window\n// - canonical URL tag and window location have not changed\nexport function cacheWithLocation(fn, win = window) {\n  if (win.top !== win) return fn;\n  let canonical, href, value;\n  return function () {\n    const newCanonical = getCanonicalUrl(win.document);\n    const newHref = win.location.href;\n    if (canonical !== newCanonical || newHref !== href) {\n      canonical = newCanonical;\n      href = newHref;\n      value = fn();\n    }\n    return value;\n  }\n}\n\n/**\n * @type {function(): refererInfo}\n */\nexport const getRefererInfo = cacheWithLocation(detectReferer(window));\n","import {checkCookieSupport, hasDeviceAccess, logError} from './utils.js';\nimport {bidderSettings} from './bidderSettings.js';\nimport {MODULE_TYPE_BIDDER, MODULE_TYPE_PREBID} from './activities/modules.js';\nimport {isActivityAllowed, registerActivityControl} from './activities/rules.js';\nimport {\n  ACTIVITY_PARAM_ADAPTER_CODE,\n  ACTIVITY_PARAM_COMPONENT_TYPE,\n  ACTIVITY_PARAM_STORAGE_TYPE\n} from './activities/params.js';\n\nimport {ACTIVITY_ACCESS_DEVICE} from './activities/activities.js';\nimport {config} from './config.js';\nimport adapterManager from './adapterManager.js';\nimport {activityParams} from './activities/activityParams.js';\n\nexport const STORAGE_TYPE_LOCALSTORAGE = 'html5';\nexport const STORAGE_TYPE_COOKIES = 'cookie';\n\nexport let storageCallbacks = [];\n\n/* eslint-disable no-restricted-properties */\n\n/*\n *  Storage manager constructor. Consumers should prefer one of `getStorageManager` or `getCoreStorageManager`.\n */\nexport function newStorageManager({moduleName, moduleType} = {}, {isAllowed = isActivityAllowed} = {}) {\n  function isValid(cb, storageType) {\n    let mod = moduleName;\n    const curBidder = config.getCurrentBidder();\n    if (curBidder && moduleType === MODULE_TYPE_BIDDER && adapterManager.aliasRegistry[curBidder] === moduleName) {\n      mod = curBidder;\n    }\n    const result = {\n      valid: isAllowed(ACTIVITY_ACCESS_DEVICE, activityParams(moduleType, mod, {\n        [ACTIVITY_PARAM_STORAGE_TYPE]: storageType\n      }))\n    };\n    return cb(result);\n  }\n\n  function schedule(operation, storageType, done) {\n    if (done && typeof done === 'function') {\n      storageCallbacks.push(function() {\n        let result = isValid(operation, storageType);\n        done(result);\n      });\n    } else {\n      return isValid(operation, storageType);\n    }\n  }\n\n  /**\n   * @param {string} key\n   * @param {string} value\n   * @param {string} [expires='']\n   * @param {string} [sameSite='/']\n   * @param {string} [domain] domain (e.g., 'example.com' or 'subdomain.example.com').\n   * If not specified, defaults to the host portion of the current document location.\n   * If a domain is specified, subdomains are always included.\n   * Domain must match the domain of the JavaScript origin. Setting cookies to foreign domains will be silently ignored.\n   * @param {function} [done]\n   */\n  const setCookie = function (key, value, expires, sameSite, domain, done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        const domainPortion = (domain && domain !== '') ? ` ;domain=${encodeURIComponent(domain)}` : '';\n        const expiresPortion = (expires && expires !== '') ? ` ;expires=${expires}` : '';\n        const isNone = (sameSite != null && sameSite.toLowerCase() == 'none')\n        const secure = (isNone) ? '; Secure' : '';\n        document.cookie = `${key}=${encodeURIComponent(value)}${expiresPortion}; path=/${domainPortion}${sameSite ? `; SameSite=${sameSite}` : ''}${secure}`;\n      }\n    }\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  };\n\n  /**\n   * @param {string} name\n   * @param {function} [done]\n   * @returns {(string|null)}\n   */\n  const getCookie = function(name, done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        let m = window.document.cookie.match('(^|;)\\\\s*' + name + '\\\\s*=\\\\s*([^;]*)\\\\s*(;|$)');\n        return m ? decodeURIComponent(m[2]) : null;\n      }\n      return null;\n    }\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  };\n\n  /**\n   * @param {function} [done]\n   * @returns {boolean}\n   */\n  const cookiesAreEnabled = function (done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        return checkCookieSupport();\n      }\n      return false;\n    }\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  }\n\n  function storageMethods(name) {\n    const capName = name.charAt(0).toUpperCase() + name.substring(1);\n    const backend = () => window[name];\n\n    const hasStorage = function (done) {\n      let cb = function (result) {\n        if (result && result.valid) {\n          try {\n            return !!backend();\n          } catch (e) {\n            logError(`${name} api disabled`);\n          }\n        }\n        return false;\n      }\n      return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n    }\n\n    return {\n      [`has${capName}`]: hasStorage,\n      [`${name}IsEnabled`](done) {\n        let cb = function (result) {\n          if (result && result.valid) {\n            try {\n              backend().setItem('prebid.cookieTest', '1');\n              return backend().getItem('prebid.cookieTest') === '1';\n            } catch (error) {\n            } finally {\n              try {\n                backend().removeItem('prebid.cookieTest');\n              } catch (error) {}\n            }\n          }\n          return false;\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      },\n      [`setDataIn${capName}`](key, value, done) {\n        let cb = function (result) {\n          if (result && result.valid && hasStorage()) {\n            backend().setItem(key, value);\n          }\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      },\n      [`getDataFrom${capName}`](key, done) {\n        let cb = function (result) {\n          if (result && result.valid && hasStorage()) {\n            return backend().getItem(key);\n          }\n          return null;\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      },\n      [`removeDataFrom${capName}`](key, done) {\n        let cb = function (result) {\n          if (result && result.valid && hasStorage()) {\n            backend().removeItem(key);\n          }\n        }\n        return schedule(cb, STORAGE_TYPE_LOCALSTORAGE, done);\n      }\n    }\n  }\n\n  /**\n   * Returns all cookie values from the jar whose names contain the `keyLike`\n   * Needs to exist in `utils.js` as it follows the StorageHandler interface defined in live-connect-js. If that module were to be removed, this function can go as well.\n   * @param {string} keyLike\n   * @param {function} [done]\n   * @returns {string[]}\n   */\n  const findSimilarCookies = function(keyLike, done) {\n    let cb = function (result) {\n      if (result && result.valid) {\n        const all = [];\n        if (hasDeviceAccess()) {\n          const cookies = document.cookie.split(';');\n          while (cookies.length) {\n            const cookie = cookies.pop();\n            let separatorIndex = cookie.indexOf('=');\n            separatorIndex = separatorIndex < 0 ? cookie.length : separatorIndex;\n            const cookieName = decodeURIComponent(cookie.slice(0, separatorIndex).replace(/^\\s+/, ''));\n            if (cookieName.indexOf(keyLike) >= 0) {\n              all.push(decodeURIComponent(cookie.slice(separatorIndex + 1)));\n            }\n          }\n        }\n        return all;\n      }\n    }\n\n    return schedule(cb, STORAGE_TYPE_COOKIES, done);\n  }\n\n  return {\n    setCookie,\n    getCookie,\n    cookiesAreEnabled,\n    ...storageMethods('localStorage'),\n    ...storageMethods('sessionStorage'),\n    findSimilarCookies\n  }\n}\n\n/**\n * Get a storage manager for a particular module.\n *\n * Either bidderCode or a combination of moduleType + moduleName must be provided. The former is a shorthand\n *  for `{moduleType: 'bidder', moduleName: bidderCode}`.\n *\n */\nexport function getStorageManager({moduleType, moduleName, bidderCode} = {}) {\n  function err() {\n    throw new Error(`Invalid invocation for getStorageManager: must set either bidderCode, or moduleType + moduleName`)\n  }\n  if (bidderCode) {\n    if ((moduleType && moduleType !== MODULE_TYPE_BIDDER) || moduleName) err()\n    moduleType = MODULE_TYPE_BIDDER;\n    moduleName = bidderCode;\n  } else if (!moduleName || !moduleType) {\n    err()\n  }\n  return newStorageManager({moduleType, moduleName});\n}\n\n/**\n * Get a storage manager for \"core\" (vendorless, or first-party) modules. Shorthand for `getStorageManager({moduleName, moduleType: 'core'})`.\n *\n * @param {string} moduleName Module name\n */\nexport function getCoreStorageManager(moduleName) {\n  return newStorageManager({moduleName: moduleName, moduleType: MODULE_TYPE_PREBID});\n}\n\n/**\n * Block all access to storage when deviceAccess = false\n */\nexport function deviceAccessRule() {\n  if (!hasDeviceAccess()) {\n    return {allow: false}\n  }\n}\nregisterActivityControl(ACTIVITY_ACCESS_DEVICE, 'deviceAccess config', deviceAccessRule);\n\n/**\n * By default, deny bidders accessDevice unless they enable it through bidderSettings\n *\n * // TODO: for backwards compat, the check is done on the adapter - rather than bidder's code.\n */\nexport function storageAllowedRule(params, bs = bidderSettings) {\n  if (params[ACTIVITY_PARAM_COMPONENT_TYPE] !== MODULE_TYPE_BIDDER) return;\n  let allow = bs.get(params[ACTIVITY_PARAM_ADAPTER_CODE], 'storageAllowed');\n  if (!allow || allow === true) {\n    allow = !!allow\n  } else {\n    const storageType = params[ACTIVITY_PARAM_STORAGE_TYPE];\n    allow = Array.isArray(allow) ? allow.some((e) => e === storageType) : allow === storageType;\n  }\n  if (!allow) {\n    return {allow};\n  }\n}\n\nregisterActivityControl(ACTIVITY_ACCESS_DEVICE, 'bidderSettings.*.storageAllowed', storageAllowedRule);\n\nexport function resetData() {\n  storageCallbacks = [];\n}\n","import { auctionManager } from './auctionManager.js';\nimport { getBufferedTTL } from './bidTTL.js';\nimport { bidderSettings } from './bidderSettings.js';\nimport { config } from './config.js';\nimport {\n  BID_STATUS,\n  DEFAULT_TARGETING_KEYS,\n  EVENTS,\n  JSON_MAPPING,\n  NATIVE_KEYS,\n  STATUS,\n  TARGETING_KEYS\n} from './constants.js';\nimport * as events from './events.js';\nimport { hook } from './hook.js';\nimport { ADPOD } from './mediaTypes.js';\nimport { NATIVE_TARGETING_KEYS } from './native.js';\nimport { find, includes } from './polyfill.js';\nimport {\n  deepAccess,\n  deepClone,\n  groupBy,\n  isAdUnitCodeMatchingSlot,\n  isArray,\n  isFn,\n  isGptPubadsDefined,\n  isStr,\n  logError,\n  logInfo,\n  logMessage,\n  logWarn,\n  sortByHighestCpm,\n  timestamp,\n  uniques,\n} from './utils.js';\nimport { getHighestCpm, getOldestHighestCpmBid } from './utils/reducers.js';\n\nvar pbTargetingKeys = [];\n\nconst MAX_DFP_KEYLENGTH = 20;\n\nconst CFG_ALLOW_TARGETING_KEYS = `targetingControls.allowTargetingKeys`;\nconst CFG_ADD_TARGETING_KEYS = `targetingControls.addTargetingKeys`;\nconst TARGETING_KEY_CONFIGURATION_ERROR_MSG = `Only one of \"${CFG_ALLOW_TARGETING_KEYS}\" or \"${CFG_ADD_TARGETING_KEYS}\" can be set`;\n\nexport const TARGETING_KEYS_ARR = Object.keys(TARGETING_KEYS).map(\n  key => TARGETING_KEYS[key]\n);\n\n// return unexpired bids\nconst isBidNotExpired = (bid) => (bid.responseTimestamp + getBufferedTTL(bid) * 1000) > timestamp();\n\n// return bids whose status is not set. Winning bids can only have a status of `rendered`.\nconst isUnusedBid = (bid) => bid && ((bid.status && !includes([BID_STATUS.RENDERED], bid.status)) || !bid.status);\n\nexport let filters = {\n  isActualBid(bid) {\n    return bid.getStatusCode() === STATUS.GOOD\n  },\n  isBidNotExpired,\n  isUnusedBid\n};\n\nexport function isBidUsable(bid) {\n  return !Object.values(filters).some((predicate) => !predicate(bid));\n}\n\n// If two bids are found for same adUnitCode, we will use the highest one to take part in auction\n// This can happen in case of concurrent auctions\n// If adUnitBidLimit is set above 0 return top N number of bids\nexport const getHighestCpmBidsFromBidPool = hook('sync', function(bidsReceived, winReducer, adUnitBidLimit = 0, hasModified = false, winSorter = sortByHighestCpm) {\n  if (!hasModified) {\n    const bids = [];\n    const dealPrioritization = config.getConfig('sendBidsControl.dealPrioritization');\n    // bucket by adUnitcode\n    let buckets = groupBy(bidsReceived, 'adUnitCode');\n    // filter top bid for each bucket by bidder\n    Object.keys(buckets).forEach(bucketKey => {\n      let bucketBids = [];\n      let bidsByBidder = groupBy(buckets[bucketKey], 'bidderCode')\n      Object.keys(bidsByBidder).forEach(key => { bucketBids.push(bidsByBidder[key].reduce(winReducer)) });\n      // if adUnitBidLimit is set, pass top N number bids\n      if (adUnitBidLimit) {\n        bucketBids = dealPrioritization ? bucketBids.sort(sortByDealAndPriceBucketOrCpm(true)) : bucketBids.sort((a, b) => b.cpm - a.cpm);\n        bids.push(...bucketBids.slice(0, adUnitBidLimit));\n      } else {\n        bucketBids = bucketBids.sort(winSorter)\n        bids.push(...bucketBids);\n      }\n    });\n\n    return bids;\n  }\n\n  return bidsReceived;\n});\n\n/**\n * A descending sort function that will sort the list of objects based on the following two dimensions:\n *  - bids with a deal are sorted before bids w/o a deal\n *  - then sort bids in each grouping based on the hb_pb value\n * eg: the following list of bids would be sorted like:\n *  [{\n *    \"hb_adid\": \"vwx\",\n *    \"hb_pb\": \"28\",\n *    \"hb_deal\": \"7747\"\n *  }, {\n *    \"hb_adid\": \"jkl\",\n *    \"hb_pb\": \"10\",\n *    \"hb_deal\": \"9234\"\n *  }, {\n *    \"hb_adid\": \"stu\",\n *    \"hb_pb\": \"50\"\n *  }, {\n *    \"hb_adid\": \"def\",\n *    \"hb_pb\": \"2\"\n *  }]\n */\nexport function sortByDealAndPriceBucketOrCpm(useCpm = false) {\n  return function(a, b) {\n    if (a.adserverTargeting.hb_deal !== undefined && b.adserverTargeting.hb_deal === undefined) {\n      return -1;\n    }\n\n    if ((a.adserverTargeting.hb_deal === undefined && b.adserverTargeting.hb_deal !== undefined)) {\n      return 1;\n    }\n\n    // assuming both values either have a deal or don't have a deal - sort by the hb_pb param\n    if (useCpm) {\n      return b.cpm - a.cpm;\n    }\n\n    return b.adserverTargeting.hb_pb - a.adserverTargeting.hb_pb;\n  }\n}\n\n/**\n * Return a map where each code in `adUnitCodes` maps to a list of GPT slots that match it.\n *\n * @param {Array<String>} adUnitCodes\n * @param customSlotMatching\n * @param getSlots\n * @return {Object.<string,any>}\n */\nexport function getGPTSlotsForAdUnits(adUnitCodes, customSlotMatching, getSlots = () => window.googletag.pubads().getSlots()) {\n  return getSlots().reduce((auToSlots, slot) => {\n    const customMatch = isFn(customSlotMatching) && customSlotMatching(slot);\n    Object.keys(auToSlots).filter(isFn(customMatch) ? customMatch : isAdUnitCodeMatchingSlot(slot)).forEach(au => auToSlots[au].push(slot));\n    return auToSlots;\n  }, Object.fromEntries(adUnitCodes.map(au => [au, []])));\n}\n\n/**\n * Clears targeting for bids\n */\nfunction clearTargeting(slot) {\n  pbTargetingKeys.forEach(key => {\n    if (slot.getTargeting(key)) {\n      slot.clearTargeting(key)\n    }\n  })\n}\n\n/**\n * @typedef {Object.<string,string>} targeting\n * @property {string} targeting_key\n */\n\n/**\n * @typedef {Object.<string,Object.<string,string[]>[]>[]} targetingArray\n */\n\nexport function newTargeting(auctionManager) {\n  let targeting = {};\n  let latestAuctionForAdUnit = {};\n\n  targeting.setLatestAuctionForAdUnit = function(adUnitCode, auctionId) {\n    latestAuctionForAdUnit[adUnitCode] = auctionId;\n  };\n\n  targeting.resetPresetTargeting = function(adUnitCode, customSlotMatching) {\n    if (isGptPubadsDefined()) {\n      const adUnitCodes = getAdUnitCodes(adUnitCode);\n      Object.values(getGPTSlotsForAdUnits(adUnitCodes, customSlotMatching)).forEach((slots) => {\n        slots.forEach(slot => {\n          clearTargeting(slot)\n        })\n      })\n    }\n  };\n\n  targeting.resetPresetTargetingAST = function(adUnitCode) {\n    const adUnitCodes = getAdUnitCodes(adUnitCode);\n    adUnitCodes.forEach(function(unit) {\n      const astTag = window.apntag.getTag(unit);\n      if (astTag && astTag.keywords) {\n        const currentKeywords = Object.keys(astTag.keywords);\n        const newKeywords = {};\n        currentKeywords.forEach((key) => {\n          if (!includes(pbTargetingKeys, key.toLowerCase())) {\n            newKeywords[key] = astTag.keywords[key];\n          }\n        })\n        window.apntag.modifyTag(unit, { keywords: newKeywords })\n      }\n    });\n  };\n\n  function addBidToTargeting(bids, enableSendAllBids = false, deals = false) {\n    const standardKeys = FEATURES.NATIVE ? TARGETING_KEYS_ARR.concat(NATIVE_TARGETING_KEYS) : TARGETING_KEYS_ARR.slice();\n    const allowSendAllBidsTargetingKeys = config.getConfig('targetingControls.allowSendAllBidsTargetingKeys');\n\n    const allowedSendAllBidTargeting = allowSendAllBidsTargetingKeys\n      ? allowSendAllBidsTargetingKeys.map((key) => TARGETING_KEYS[key])\n      : standardKeys;\n\n    return bids.reduce((result, bid) => {\n      if (enableSendAllBids || (deals && bid.dealId)) {\n        const targetingValue = getTargetingMap(bid, standardKeys.filter(\n          key => typeof bid.adserverTargeting[key] !== 'undefined' &&\n            (deals || allowedSendAllBidTargeting.indexOf(key) !== -1)));\n\n        if (targetingValue) {\n          result.push({[bid.adUnitCode]: targetingValue})\n        }\n      }\n      return result;\n    }, []);\n  }\n\n  function getBidderTargeting(bids) {\n    const alwaysIncludeDeals = config.getConfig('targetingControls.alwaysIncludeDeals');\n    const enableSendAllBids = config.getConfig('enableSendAllBids');\n    return addBidToTargeting(bids, enableSendAllBids, alwaysIncludeDeals);\n  }\n\n  /**\n   * Returns filtered ad server targeting for custom and allowed keys.\n   * @param {targetingArray} targeting\n   * @param {string[]} allowedKeys\n   * @return {targetingArray} filtered targeting\n   */\n  function getAllowedTargetingKeyValues(targeting, allowedKeys) {\n    const defaultKeyring = Object.assign({}, TARGETING_KEYS, NATIVE_KEYS);\n    const defaultKeys = Object.keys(defaultKeyring);\n    const keyDispositions = {};\n    logInfo(`allowTargetingKeys - allowed keys [ ${allowedKeys.map(k => defaultKeyring[k]).join(', ')} ]`);\n    targeting.map(adUnit => {\n      const adUnitCode = Object.keys(adUnit)[0];\n      const keyring = adUnit[adUnitCode];\n      const keys = keyring.filter(kvPair => {\n        const key = Object.keys(kvPair)[0];\n        // check if key is in default keys, if not, it's custom, we won't remove it.\n        const isCustom = defaultKeys.filter(defaultKey => key.indexOf(defaultKeyring[defaultKey]) === 0).length === 0;\n        // check if key explicitly allowed, if not, we'll remove it.\n        const found = isCustom || find(allowedKeys, allowedKey => {\n          const allowedKeyName = defaultKeyring[allowedKey];\n          // we're looking to see if the key exactly starts with one of our default keys.\n          // (which hopefully means it's not custom)\n          const found = key.indexOf(allowedKeyName) === 0;\n          return found;\n        });\n        keyDispositions[key] = !found;\n        return found;\n      });\n      adUnit[adUnitCode] = keys;\n    });\n    const removedKeys = Object.keys(keyDispositions).filter(d => keyDispositions[d]);\n    logInfo(`allowTargetingKeys - removed keys [ ${removedKeys.join(', ')} ]`);\n    // remove any empty targeting objects, as they're unnecessary.\n    const filteredTargeting = targeting.filter(adUnit => {\n      const adUnitCode = Object.keys(adUnit)[0];\n      const keyring = adUnit[adUnitCode];\n      return keyring.length > 0;\n    });\n    return filteredTargeting\n  }\n\n  /**\n   * Returns all ad server targeting for all ad units.\n   * @param {string=} adUnitCode\n   * @return {Object.<string,targeting>} targeting\n   */\n  targeting.getAllTargeting = function(adUnitCode, bidLimit, bidsReceived, winReducer = getHighestCpm, winSorter = sortByHighestCpm) {\n    bidsReceived ||= getBidsReceived(winReducer, winSorter);\n    const adUnitCodes = getAdUnitCodes(adUnitCode);\n    const sendAllBids = config.getConfig('enableSendAllBids');\n    const bidLimitConfigValue = config.getConfig('sendBidsControl.bidLimit');\n    const adUnitBidLimit = (sendAllBids && (bidLimit || bidLimitConfigValue)) || 0;\n    const { customKeysByUnit, filteredBids } = getfilteredBidsAndCustomKeys(adUnitCodes, bidsReceived);\n    const bidsSorted = getHighestCpmBidsFromBidPool(filteredBids, winReducer, adUnitBidLimit, undefined, winSorter);\n    let targeting = getTargetingLevels(bidsSorted, customKeysByUnit, adUnitCodes);\n\n    const defaultKeys = Object.keys(Object.assign({}, DEFAULT_TARGETING_KEYS, NATIVE_KEYS));\n    let allowedKeys = config.getConfig(CFG_ALLOW_TARGETING_KEYS);\n    const addedKeys = config.getConfig(CFG_ADD_TARGETING_KEYS);\n\n    if (addedKeys != null && allowedKeys != null) {\n      throw new Error(TARGETING_KEY_CONFIGURATION_ERROR_MSG);\n    } else if (addedKeys != null) {\n      allowedKeys = defaultKeys.concat(addedKeys);\n    } else {\n      allowedKeys = allowedKeys || defaultKeys;\n    }\n\n    if (Array.isArray(allowedKeys) && allowedKeys.length > 0) {\n      targeting = getAllowedTargetingKeyValues(targeting, allowedKeys);\n    }\n\n    targeting = flattenTargeting(targeting);\n\n    const auctionKeysThreshold = config.getConfig('targetingControls.auctionKeyMaxChars');\n    if (auctionKeysThreshold) {\n      logInfo(`Detected 'targetingControls.auctionKeyMaxChars' was active for this auction; set with a limit of ${auctionKeysThreshold} characters.  Running checks on auction keys...`);\n      targeting = filterTargetingKeys(targeting, auctionKeysThreshold);\n    }\n\n    // make sure at least there is a entry per adUnit code in the targetingSet so receivers of SET_TARGETING call's can know what ad units are being invoked\n    adUnitCodes.forEach(code => {\n      if (!targeting[code]) {\n        targeting[code] = {};\n      }\n    });\n\n    return targeting;\n  };\n\n  function updatePBTargetingKeys(adUnitCode) {\n    (Object.keys(adUnitCode)).forEach(key => {\n      adUnitCode[key].forEach(targetKey => {\n        const targetKeys = Object.keys(targetKey);\n        if (pbTargetingKeys.indexOf(targetKeys[0]) === -1) {\n          pbTargetingKeys = targetKeys.concat(pbTargetingKeys);\n        }\n      });\n    });\n  }\n\n  function getTargetingLevels(bidsSorted, customKeysByUnit, adUnitCodes) {\n    const useAllBidsCustomTargeting = config.getConfig('targetingControls.allBidsCustomTargeting') !== false;\n\n    const targeting = getWinningBidTargeting(bidsSorted, adUnitCodes)\n      .concat(getBidderTargeting(bidsSorted))\n      .concat(getAdUnitTargeting(adUnitCodes));\n\n    if (useAllBidsCustomTargeting) {\n      targeting.push(...getCustomBidTargeting(bidsSorted, customKeysByUnit))\n    }\n\n    targeting.forEach(adUnitCode => {\n      updatePBTargetingKeys(adUnitCode);\n    });\n\n    return targeting;\n  }\n\n  function getfilteredBidsAndCustomKeys(adUnitCodes, bidsReceived) {\n    const filteredBids = [];\n    const customKeysByUnit = {};\n    const alwaysIncludeDeals = config.getConfig('targetingControls.alwaysIncludeDeals');\n\n    bidsReceived.forEach(bid => {\n      const adUnitIsEligible = includes(adUnitCodes, bid.adUnitCode);\n      const cpmAllowed = bidderSettings.get(bid.bidderCode, 'allowZeroCpmBids') === true ? bid.cpm >= 0 : bid.cpm > 0;\n      const isPreferredDeal = alwaysIncludeDeals && bid.dealId;\n\n      if (adUnitIsEligible && (isPreferredDeal || cpmAllowed)) {\n        filteredBids.push(bid);\n        Object.keys(bid.adserverTargeting)\n          .filter(getCustomKeys())\n          .forEach(key => {\n            const truncKey = key.substring(0, MAX_DFP_KEYLENGTH);\n            const data = customKeysByUnit[bid.adUnitCode] || {};\n            const value = [bid.adserverTargeting[key]];\n\n            if (data[truncKey]) {\n              data[truncKey] = data[truncKey].concat(value).filter(uniques);\n            } else {\n              data[truncKey] = value;\n            }\n\n            customKeysByUnit[bid.adUnitCode] = data;\n          })\n      }\n    });\n\n    return {filteredBids, customKeysByUnit};\n  }\n\n  // warn about conflicting configuration\n  config.getConfig('targetingControls', function (config) {\n    if (deepAccess(config, CFG_ALLOW_TARGETING_KEYS) != null && deepAccess(config, CFG_ADD_TARGETING_KEYS) != null) {\n      logError(TARGETING_KEY_CONFIGURATION_ERROR_MSG);\n    }\n  });\n\n  // create an encoded string variant based on the keypairs of the provided object\n  //  - note this will encode the characters between the keys (ie = and &)\n  function convertKeysToQueryForm(keyMap) {\n    return Object.keys(keyMap).reduce(function (queryString, key) {\n      let encodedKeyPair = `${key}%3d${encodeURIComponent(keyMap[key])}%26`;\n      return queryString += encodedKeyPair;\n    }, '');\n  }\n\n  function filterTargetingKeys(targeting, auctionKeysThreshold) {\n    // read each targeting.adUnit object and sort the adUnits into a list of adUnitCodes based on priorization setting (eg CPM)\n    let targetingCopy = deepClone(targeting);\n\n    let targetingMap = Object.keys(targetingCopy).map(adUnitCode => {\n      return {\n        adUnitCode,\n        adserverTargeting: targetingCopy[adUnitCode]\n      };\n    }).sort(sortByDealAndPriceBucketOrCpm());\n\n    // iterate through the targeting based on above list and transform the keys into the query-equivalent and count characters\n    return targetingMap.reduce(function (accMap, currMap, index, arr) {\n      let adUnitQueryString = convertKeysToQueryForm(currMap.adserverTargeting);\n\n      // for the last adUnit - trim last encoded ampersand from the converted query string\n      if ((index + 1) === arr.length) {\n        adUnitQueryString = adUnitQueryString.slice(0, -3);\n      }\n\n      // if under running threshold add to result\n      let code = currMap.adUnitCode;\n      let querySize = adUnitQueryString.length;\n      if (querySize <= auctionKeysThreshold) {\n        auctionKeysThreshold -= querySize;\n        logInfo(`AdUnit '${code}' auction keys comprised of ${querySize} characters.  Deducted from running threshold; new limit is ${auctionKeysThreshold}`, targetingCopy[code]);\n\n        accMap[code] = targetingCopy[code];\n      } else {\n        logWarn(`The following keys for adUnitCode '${code}' exceeded the current limit of the 'auctionKeyMaxChars' setting.\\nThe key-set size was ${querySize}, the current allotted amount was ${auctionKeysThreshold}.\\n`, targetingCopy[code]);\n      }\n\n      if ((index + 1) === arr.length && Object.keys(accMap).length === 0) {\n        logError('No auction targeting keys were permitted due to the setting in setConfig(targetingControls.auctionKeyMaxChars).  Please review setup and consider adjusting.');\n      }\n      return accMap;\n    }, {});\n  }\n\n  /**\n   * Converts targeting array and flattens to make it easily iteratable\n   * e.g: Sample input to this function\n   * ```\n   * [\n   *    {\n   *      \"div-gpt-ad-1460505748561-0\": [{\"hb_bidder\": [\"appnexusAst\"]}]\n   *    },\n   *    {\n   *      \"div-gpt-ad-1460505748561-0\": [{\"hb_bidder_appnexusAs\": [\"appnexusAst\", \"other\"]}]\n   *    }\n   * ]\n   * ```\n   * Resulting array\n   * ```\n   * {\n   *  \"div-gpt-ad-1460505748561-0\": {\n   *    \"hb_bidder\": \"appnexusAst\",\n   *    \"hb_bidder_appnexusAs\": \"appnexusAst,other\"\n   *  }\n   * }\n   * ```\n   *\n   * @param {targetingArray}  targeting\n   * @return {Object.<string,targeting>}  targeting\n   */\n  function flattenTargeting(targeting) {\n    let targetingObj = targeting.map(targeting => {\n      return {\n        [Object.keys(targeting)[0]]: targeting[Object.keys(targeting)[0]]\n          .map(target => {\n            return {\n              [Object.keys(target)[0]]: target[Object.keys(target)[0]].join(',')\n            };\n          }).reduce((p, c) => Object.assign(c, p), {})\n      };\n    })\n\n    targetingObj = targetingObj.reduce(function (accumulator, targeting) {\n      var key = Object.keys(targeting)[0];\n      accumulator[key] = Object.assign({}, accumulator[key], targeting[key]);\n      return accumulator;\n    }, {});\n\n    return targetingObj;\n  }\n\n  targeting.setTargetingForGPT = hook('sync', function (adUnit, customSlotMatching) {\n  // get our ad unit codes\n    let targetingSet = targeting.getAllTargeting(adUnit);\n\n    let resetMap = Object.fromEntries(pbTargetingKeys.map(key => [key, null]));\n\n    Object.entries(getGPTSlotsForAdUnits(Object.keys(targetingSet), customSlotMatching)).forEach(([targetId, slots]) => {\n      slots.forEach(slot => {\n      // now set new targeting keys\n        Object.keys(targetingSet[targetId]).forEach(key => {\n          let value = targetingSet[targetId][key];\n          if (typeof value === 'string' && value.indexOf(',') !== -1) {\n          // due to the check the array will be formed only if string has ',' else plain string will be assigned as value\n            value = value.split(',');\n          }\n          targetingSet[targetId][key] = value;\n        });\n        logMessage(`Attempting to set targeting-map for slot: ${slot.getSlotElementId()} with targeting-map:`, targetingSet[targetId]);\n        slot.updateTargetingFromMap(Object.assign({}, resetMap, targetingSet[targetId]))\n      })\n    })\n\n    Object.keys(targetingSet).forEach((adUnitCode) => {\n      Object.keys(targetingSet[adUnitCode]).forEach((targetingKey) => {\n        if (targetingKey === 'hb_adid') {\n          auctionManager.setStatusForBids(targetingSet[adUnitCode][targetingKey], BID_STATUS.BID_TARGETING_SET);\n        }\n      });\n    });\n\n    targeting.targetingDone(targetingSet);\n\n    // emit event\n    events.emit(EVENTS.SET_TARGETING, targetingSet);\n  }, 'setTargetingForGPT');\n\n  targeting.targetingDone = hook('sync', function (targetingSet) {\n    return targetingSet;\n  }, 'targetingDone');\n\n  /**\n   * normlizes input to a `adUnit.code` array\n   * @param  {(string|string[])} adUnitCode [description]\n   * @return {string[]}     AdUnit code array\n   */\n  function getAdUnitCodes(adUnitCode) {\n    if (typeof adUnitCode === 'string') {\n      return [adUnitCode];\n    } else if (isArray(adUnitCode)) {\n      return adUnitCode;\n    }\n    return auctionManager.getAdUnitCodes() || [];\n  }\n\n  function getBidsReceived(winReducer = getOldestHighestCpmBid, winSorter = undefined) {\n    let bidsReceived = auctionManager.getBidsReceived().reduce((bids, bid) => {\n      const bidCacheEnabled = config.getConfig('useBidCache');\n      const filterFunction = config.getConfig('bidCacheFilterFunction');\n      const isBidFromLastAuction = latestAuctionForAdUnit[bid.adUnitCode] === bid.auctionId;\n      const filterFunctionResult = bidCacheEnabled && !isBidFromLastAuction && typeof filterFunction === 'function' ? !!filterFunction(bid) : true;\n      const cacheFilter = bidCacheEnabled || isBidFromLastAuction;\n      const bidFilter = cacheFilter && filterFunctionResult;\n\n      if (bidFilter && deepAccess(bid, 'video.context') !== ADPOD && isBidUsable(bid)) {\n        bid.latestTargetedAuctionId = latestAuctionForAdUnit[bid.adUnitCode];\n        bids.push(bid)\n      }\n\n      return bids;\n    }, []);\n\n    return getHighestCpmBidsFromBidPool(bidsReceived, winReducer, undefined, undefined, undefined, winSorter);\n  }\n\n  /**\n   * Returns top bids for a given adUnit or set of adUnits.\n   * @param  {(string|string[])} adUnitCode adUnitCode or array of adUnitCodes\n   * @param  {(Array|undefined)} bids - The received bids, defaulting to the result of getBidsReceived().\n   * @param  {function(Array<Object>): Array<Object>} [winReducer = getHighestCpm] - reducer method\n   * @param  {function(Array<Object>): Array<Object>} [winSorter = sortByHighestCpm] - sorter method\n   * @return {Array<Object>} - An array of winning bids.\n   */\n  targeting.getWinningBids = function(adUnitCode, bids, winReducer = getHighestCpm, winSorter = sortByHighestCpm) {\n    const bidsReceived = bids || getBidsReceived(winReducer, winSorter);\n    const adUnitCodes = getAdUnitCodes(adUnitCode);\n\n    return bidsReceived\n      .filter(bid => includes(adUnitCodes, bid.adUnitCode))\n      .filter(bid => (bidderSettings.get(bid.bidderCode, 'allowZeroCpmBids') === true) ? bid.cpm >= 0 : bid.cpm > 0)\n      .map(bid => bid.adUnitCode)\n      .filter(uniques)\n      .map(adUnitCode => bidsReceived\n        .filter(bid => bid.adUnitCode === adUnitCode ? bid : null)\n        .reduce(getHighestCpm));\n  };\n\n  /**\n   * @param  {(string|string[])} adUnitCodes adUnitCode or array of adUnitCodes\n   * Sets targeting for AST\n   */\n  targeting.setTargetingForAst = function(adUnitCodes) {\n    let astTargeting = targeting.getAllTargeting(adUnitCodes);\n\n    try {\n      targeting.resetPresetTargetingAST(adUnitCodes);\n    } catch (e) {\n      logError('unable to reset targeting for AST' + e)\n    }\n\n    Object.keys(astTargeting).forEach(targetId =>\n      Object.keys(astTargeting[targetId]).forEach(key => {\n        logMessage(`Attempting to set targeting for targetId: ${targetId} key: ${key} value: ${astTargeting[targetId][key]}`);\n        // setKeywords supports string and array as value\n        if (isStr(astTargeting[targetId][key]) || isArray(astTargeting[targetId][key])) {\n          let keywordsObj = {};\n          let regex = /pt[0-9]/;\n          if (key.search(regex) < 0) {\n            keywordsObj[key.toUpperCase()] = astTargeting[targetId][key];\n          } else {\n            // pt${n} keys should not be uppercased\n            keywordsObj[key] = astTargeting[targetId][key];\n          }\n          window.apntag.setKeywords(targetId, keywordsObj, { overrideKeyValue: true });\n        }\n      })\n    );\n  };\n\n  /**\n   * Get targeting key value pairs for winning bid.\n   * @param {Array<Object>} bidsReceived code array\n   * @param {string[]} adUnitCodes code array\n   * @return {targetingArray} winning bids targeting\n   */\n  function getWinningBidTargeting(bidsReceived, adUnitCodes) {\n    let winners = targeting.getWinningBids(adUnitCodes, bidsReceived);\n    let standardKeys = getStandardKeys();\n\n    winners = winners.map(winner => {\n      return {\n        [winner.adUnitCode]: Object.keys(winner.adserverTargeting)\n          .filter(key =>\n            typeof winner.sendStandardTargeting === 'undefined' ||\n            winner.sendStandardTargeting ||\n            standardKeys.indexOf(key) === -1)\n          .reduce((acc, key) => {\n            const targetingValue = [winner.adserverTargeting[key]];\n            const targeting = { [key.substring(0, MAX_DFP_KEYLENGTH)]: targetingValue };\n            if (key === TARGETING_KEYS.DEAL) {\n              const bidderCodeTargetingKey = `${key}_${winner.bidderCode}`.substring(0, MAX_DFP_KEYLENGTH);\n              const bidderCodeTargeting = { [bidderCodeTargetingKey]: targetingValue };\n              return [...acc, targeting, bidderCodeTargeting];\n            }\n            return [...acc, targeting];\n          }, [])\n      };\n    });\n\n    return winners;\n  }\n\n  function getStandardKeys() {\n    return auctionManager.getStandardBidderAdServerTargeting() // in case using a custom standard key set\n      .map(targeting => targeting.key)\n      .concat(TARGETING_KEYS_ARR).filter(uniques); // standard keys defined in the library.\n  }\n\n  function getCustomKeys() {\n    let standardKeys = getStandardKeys();\n    if (FEATURES.NATIVE) {\n      standardKeys = standardKeys.concat(NATIVE_TARGETING_KEYS);\n    }\n    return function(key) {\n      return standardKeys.indexOf(key) === -1;\n    }\n  }\n\n  /**\n   * Get custom targeting key value pairs for bids.\n   * @param {Array<Object>} bidsSorted code array\n   * @param {Object} customKeysByUnit code array\n   * @return {targetingArray} bids with custom targeting defined in bidderSettings\n   */\n  function getCustomBidTargeting(bidsSorted, customKeysByUnit) {\n    return bidsSorted\n      .reduce((acc, bid) => {\n        const newBid = Object.assign({}, bid);\n        const customKeysForUnit = customKeysByUnit[newBid.adUnitCode];\n        const targeting = [];\n\n        if (customKeysForUnit) {\n          Object.keys(customKeysForUnit).forEach(key => {\n            if (key && customKeysForUnit[key]) targeting.push({[key]: customKeysForUnit[key]});\n          })\n        }\n\n        acc.push({[newBid.adUnitCode]: targeting});\n\n        return acc;\n      }, []);\n  }\n\n  function getTargetingMap(bid, keys) {\n    return keys.reduce((targeting, key) => {\n      const value = bid.adserverTargeting[key];\n      if (value) {\n        targeting.push({[`${key}_${bid.bidderCode}`.substring(0, MAX_DFP_KEYLENGTH)]: [bid.adserverTargeting[key]]})\n      }\n      return targeting;\n    }, []);\n  }\n\n  function getAdUnitTargeting(adUnitCodes) {\n    function getTargetingObj(adUnit) {\n      return adUnit?.[JSON_MAPPING.ADSERVER_TARGETING];\n    }\n\n    function getTargetingValues(adUnit) {\n      const aut = getTargetingObj(adUnit);\n\n      return Object.keys(aut)\n        .map(function(key) {\n          if (isStr(aut[key])) aut[key] = aut[key].split(',').map(s => s.trim());\n          if (!isArray(aut[key])) aut[key] = [ aut[key] ];\n          return { [key]: aut[key] };\n        });\n    }\n\n    return auctionManager.getAdUnits()\n      .filter(adUnit => adUnitCodes.includes(adUnit.code) && getTargetingObj(adUnit))\n      .reduce((result, adUnit) => {\n        const targetingValues = getTargetingValues(adUnit);\n\n        if (targetingValues)result.push({[adUnit.code]: targetingValues});\n        return result;\n      }, []);\n  }\n\n  targeting.isApntagDefined = function() {\n    if (window.apntag && isFn(window.apntag.setKeywords)) {\n      return true;\n    }\n  };\n\n  return targeting;\n}\n\nexport const targeting = newTargeting(auctionManager);\n","import {\n  deepClone, isPlainObject, logError, shuffle, logMessage, triggerPixel, insertUserSyncIframe, isArray,\n  logWarn, isStr, isSafariBrowser\n} from './utils.js';\nimport { config } from './config.js';\nimport {includes} from './polyfill.js';\nimport { getCoreStorageManager } from './storageManager.js';\nimport {isActivityAllowed, registerActivityControl} from './activities/rules.js';\nimport {ACTIVITY_SYNC_USER} from './activities/activities.js';\nimport {\n  ACTIVITY_PARAM_COMPONENT_NAME,\n  ACTIVITY_PARAM_COMPONENT_TYPE,\n  ACTIVITY_PARAM_SYNC_TYPE, ACTIVITY_PARAM_SYNC_URL\n} from './activities/params.js';\nimport {MODULE_TYPE_BIDDER} from './activities/modules.js';\nimport {activityParams} from './activities/activityParams.js';\n\nexport const USERSYNC_DEFAULT_CONFIG = {\n  syncEnabled: true,\n  filterSettings: {\n    image: {\n      bidders: '*',\n      filter: 'include'\n    }\n  },\n  syncsPerBidder: 5,\n  syncDelay: 3000,\n  auctionDelay: 500\n};\n\n// Set userSync default values\nconfig.setDefaults({\n  'userSync': deepClone(USERSYNC_DEFAULT_CONFIG)\n});\n\nconst storage = getCoreStorageManager('usersync');\n\n/**\n * Factory function which creates a new UserSyncPool.\n *\n * @param {} deps Configuration options and dependencies which the\n *   UserSync object needs in order to behave properly.\n */\nexport function newUserSync(deps) {\n  let publicApi = {};\n  // A queue of user syncs for each adapter\n  // Let getDefaultQueue() set the defaults\n  let queue = getDefaultQueue();\n\n  // Whether or not user syncs have been trigger on this page load for a specific bidder\n  let hasFiredBidder = new Set();\n  // How many bids for each adapter\n  let numAdapterBids = {};\n\n  // for now - default both to false in case filterSettings config is absent/misconfigured\n  let permittedPixels = {\n    image: true,\n    iframe: false\n  };\n\n  // Use what is in config by default\n  let usConfig = deps.config;\n  // Update if it's (re)set\n  config.getConfig('userSync', (conf) => {\n    // Added this logic for https://github.com/prebid/Prebid.js/issues/4864\n    // if userSync.filterSettings does not contain image/all configs, merge in default image config to ensure image pixels are fired\n    if (conf.userSync) {\n      let fs = conf.userSync.filterSettings;\n      if (isPlainObject(fs)) {\n        if (!fs.image && !fs.all) {\n          conf.userSync.filterSettings.image = {\n            bidders: '*',\n            filter: 'include'\n          };\n        }\n      }\n    }\n\n    usConfig = Object.assign(usConfig, conf.userSync);\n  });\n\n  deps.regRule(ACTIVITY_SYNC_USER, 'userSync config', (params) => {\n    if (!usConfig.syncEnabled) {\n      return {allow: false, reason: 'syncs are disabled'}\n    }\n    if (params[ACTIVITY_PARAM_COMPONENT_TYPE] === MODULE_TYPE_BIDDER) {\n      const syncType = params[ACTIVITY_PARAM_SYNC_TYPE];\n      const bidder = params[ACTIVITY_PARAM_COMPONENT_NAME];\n      if (!publicApi.canBidderRegisterSync(syncType, bidder)) {\n        return {allow: false, reason: `${syncType} syncs are not enabled for ${bidder}`}\n      }\n    }\n  });\n\n  /**\n   * @function getDefaultQueue\n   * @summary Returns the default empty queue\n   * @private\n   * @return {object} A queue with no syncs\n   */\n  function getDefaultQueue() {\n    return {\n      image: [],\n      iframe: []\n    };\n  }\n\n  /**\n   * @function fireSyncs\n   * @summary Trigger all user syncs in the queue\n   * @private\n   */\n  function fireSyncs() {\n    if (!usConfig.syncEnabled || !deps.browserSupportsCookies) {\n      return;\n    }\n\n    try {\n      // Iframe syncs\n      loadIframes();\n      // Image pixels\n      fireImagePixels();\n    } catch (e) {\n      return logError('Error firing user syncs', e);\n    }\n    // Reset the user sync queue\n    queue = getDefaultQueue();\n  }\n\n  function forEachFire(queue, fn) {\n    // Randomize the order of the pixels before firing\n    // This is to avoid giving any bidder who has registered multiple syncs\n    // any preferential treatment and balancing them out\n    shuffle(queue).forEach(fn);\n  }\n\n  /**\n   * @function fireImagePixels\n   * @summary Loops through user sync pixels and fires each one\n   * @private\n   */\n  function fireImagePixels() {\n    if (!permittedPixels.image) {\n      return;\n    }\n    forEachFire(queue.image, (sync) => {\n      let [bidderName, trackingPixelUrl] = sync;\n      logMessage(`Invoking image pixel user sync for bidder: ${bidderName}`);\n      // Create image object and add the src url\n      triggerPixel(trackingPixelUrl);\n    });\n  }\n\n  /**\n   * @function loadIframes\n   * @summary Loops through iframe syncs and loads an iframe element into the page\n   * @private\n   */\n  function loadIframes() {\n    if (!(permittedPixels.iframe)) {\n      return;\n    }\n\n    forEachFire(queue.iframe, (sync) => {\n      let [bidderName, iframeUrl] = sync;\n      logMessage(`Invoking iframe user sync for bidder: ${bidderName}`);\n      // Insert iframe into DOM\n      insertUserSyncIframe(iframeUrl);\n      // for a bidder, if iframe sync is present then remove image pixel\n      removeImagePixelsForBidder(queue, bidderName);\n    });\n  }\n\n  function removeImagePixelsForBidder(queue, iframeSyncBidderName) {\n    queue.image = queue.image.filter(imageSync => {\n      let imageSyncBidderName = imageSync[0];\n      return imageSyncBidderName !== iframeSyncBidderName\n    });\n  }\n\n  /**\n   * @function incrementAdapterBids\n   * @summary Increment the count of user syncs queue for the adapter\n   * @private\n   * @param {object} numAdapterBids The object contain counts for all adapters\n   * @param {string} bidder The name of the bidder adding a sync\n   * @returns {object} The updated version of numAdapterBids\n   */\n  function incrementAdapterBids(numAdapterBids, bidder) {\n    if (!numAdapterBids[bidder]) {\n      numAdapterBids[bidder] = 1;\n    } else {\n      numAdapterBids[bidder] += 1;\n    }\n    return numAdapterBids;\n  }\n\n  /**\n   * @function registerSync\n   * @summary Add sync for this bidder to a queue to be fired later\n   * @public\n   * @param {string} type The type of the sync including image, iframe\n   * @param {string} bidder The name of the adapter. e.g. \"rubicon\"\n   * @param {string} url Either the pixel url or iframe url depending on the type\n   * @example <caption>Using Image Sync</caption>\n   * // registerSync(type, adapter, pixelUrl)\n   * userSync.registerSync('image', 'rubicon', 'http://example.com/pixel')\n   */\n  publicApi.registerSync = (type, bidder, url) => {\n    if (hasFiredBidder.has(bidder)) {\n      return logMessage(`already fired syncs for \"${bidder}\", ignoring registerSync call`);\n    }\n    if (!usConfig.syncEnabled || !isArray(queue[type])) {\n      return logWarn(`User sync type \"${type}\" not supported`);\n    }\n    if (!bidder) {\n      return logWarn(`Bidder is required for registering sync`);\n    }\n    if (usConfig.syncsPerBidder !== 0 && Number(numAdapterBids[bidder]) >= usConfig.syncsPerBidder) {\n      return logWarn(`Number of user syncs exceeded for \"${bidder}\"`);\n    }\n\n    if (deps.isAllowed(ACTIVITY_SYNC_USER, activityParams(MODULE_TYPE_BIDDER, bidder, {\n      [ACTIVITY_PARAM_SYNC_TYPE]: type,\n      [ACTIVITY_PARAM_SYNC_URL]: url\n    }))) {\n      // the bidder's pixel has passed all checks and is allowed to register\n      queue[type].push([bidder, url]);\n      numAdapterBids = incrementAdapterBids(numAdapterBids, bidder);\n    }\n  };\n\n  /**\n   * Mark a bidder as done with its user syncs - no more will be accepted from them in this session.\n   * @param {string} bidderCode\n   */\n  publicApi.bidderDone = hasFiredBidder.add.bind(hasFiredBidder);\n\n  /**\n   * @function shouldBidderBeBlocked\n   * @summary Check filterSettings logic to determine if the bidder should be prevented from registering their userSync tracker\n   * @private\n   * @param {string} type The type of the sync; either image or iframe\n   * @param {string} bidder The name of the adapter. e.g. \"rubicon\"\n   * @returns {boolean} true => bidder is not allowed to register; false => bidder can register\n   */\n  function shouldBidderBeBlocked(type, bidder) {\n    let filterConfig = usConfig.filterSettings;\n\n    // apply the filter check if the config object is there (eg filterSettings.iframe exists) and if the config object is properly setup\n    if (isFilterConfigValid(filterConfig, type)) {\n      permittedPixels[type] = true;\n\n      let activeConfig = (filterConfig.all) ? filterConfig.all : filterConfig[type];\n      let biddersToFilter = (activeConfig.bidders === '*') ? [bidder] : activeConfig.bidders;\n      let filterType = activeConfig.filter || 'include'; // set default if undefined\n\n      // return true if the bidder is either: not part of the include (ie outside the whitelist) or part of the exclude (ie inside the blacklist)\n      const checkForFiltering = {\n        'include': (bidders, bidder) => !includes(bidders, bidder),\n        'exclude': (bidders, bidder) => includes(bidders, bidder)\n      }\n      return checkForFiltering[filterType](biddersToFilter, bidder);\n    }\n    return !permittedPixels[type];\n  }\n\n  /**\n   * @function isFilterConfigValid\n   * @summary Check if the filterSettings object in the userSync config is setup properly\n   * @private\n   * @param {object} filterConfig sub-config object taken from filterSettings\n   * @param {string} type The type of the sync; either image or iframe\n   * @returns {boolean} true => config is setup correctly, false => setup incorrectly or filterConfig[type] is not present\n   */\n  function isFilterConfigValid(filterConfig, type) {\n    if (filterConfig.all && filterConfig[type]) {\n      logWarn(`Detected presence of the \"filterSettings.all\" and \"filterSettings.${type}\" in userSync config.  You cannot mix \"all\" with \"iframe/image\" configs; they are mutually exclusive.`);\n      return false;\n    }\n\n    let activeConfig = (filterConfig.all) ? filterConfig.all : filterConfig[type];\n    let activeConfigName = (filterConfig.all) ? 'all' : type;\n\n    // if current pixel type isn't part of the config's logic, skip rest of the config checks...\n    // we return false to skip subsequent filter checks in shouldBidderBeBlocked() function\n    if (!activeConfig) {\n      return false;\n    }\n\n    let filterField = activeConfig.filter;\n    let biddersField = activeConfig.bidders;\n\n    if (filterField && filterField !== 'include' && filterField !== 'exclude') {\n      logWarn(`UserSync \"filterSettings.${activeConfigName}.filter\" setting '${filterField}' is not a valid option; use either 'include' or 'exclude'.`);\n      return false;\n    }\n\n    if (biddersField !== '*' && !(Array.isArray(biddersField) && biddersField.length > 0 && biddersField.every(bidderInList => isStr(bidderInList) && bidderInList !== '*'))) {\n      logWarn(`Detected an invalid setup in userSync \"filterSettings.${activeConfigName}.bidders\"; use either '*' (to represent all bidders) or an array of bidders.`);\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * @function syncUsers\n   * @summary Trigger all the user syncs based on publisher-defined timeout\n   * @public\n   * @param {number} timeout The delay in ms before syncing data - default 0\n   */\n  publicApi.syncUsers = (timeout = 0) => {\n    if (timeout) {\n      return setTimeout(fireSyncs, Number(timeout));\n    }\n    fireSyncs();\n  };\n\n  /**\n   * @function triggerUserSyncs\n   * @summary A `syncUsers` wrapper for determining if enableOverride has been turned on\n   * @public\n   */\n  publicApi.triggerUserSyncs = () => {\n    if (usConfig.enableOverride) {\n      publicApi.syncUsers();\n    }\n  };\n\n  publicApi.canBidderRegisterSync = (type, bidder) => {\n    if (usConfig.filterSettings) {\n      if (shouldBidderBeBlocked(type, bidder)) {\n        return false;\n      }\n    }\n    return true;\n  };\n  return publicApi;\n}\n\nexport const userSync = newUserSync(Object.defineProperties({\n  config: config.getConfig('userSync'),\n  isAllowed: isActivityAllowed,\n  regRule: registerActivityControl,\n}, {\n  browserSupportsCookies: {\n    get: function() {\n      // call storage lazily to give time for consent data to be available\n      return !isSafariBrowser() && storage.cookiesAreEnabled();\n    }\n  }\n}));\n\n/**\n * @typedef {Object} UserSyncConfig\n *\n * @property {boolean} enableOverride\n * @property {boolean} syncEnabled\n * @property {number} syncsPerBidder\n * @property {string[]} enabledBidders\n * @property {Object} filterSettings\n */\n","import {config} from './config.js';\nimport {klona} from 'klona/json';\nimport {includes} from './polyfill.js';\nimport {EVENTS} from './constants.js';\nimport {PbPromise} from './utils/promise.js';\nimport {getGlobal} from './prebidGlobal.js';\nimport { default as deepAccess } from 'dlv/index.js';\n\nexport { deepAccess };\nexport { dset as deepSetValue } from 'dset';\n\nvar tStr = 'String';\nvar tFn = 'Function';\nvar tNumb = 'Number';\nvar tObject = 'Object';\nvar tBoolean = 'Boolean';\nvar toString = Object.prototype.toString;\nlet consoleExists = Boolean(window.console);\nlet consoleLogExists = Boolean(consoleExists && window.console.log);\nlet consoleInfoExists = Boolean(consoleExists && window.console.info);\nlet consoleWarnExists = Boolean(consoleExists && window.console.warn);\nlet consoleErrorExists = Boolean(consoleExists && window.console.error);\n\nlet eventEmitter;\nlet windowDimensions;\n\nconst pbjsInstance = getGlobal();\n\nexport function _setEventEmitter(emitFn) {\n  // called from events.js - this hoop is to avoid circular imports\n  eventEmitter = emitFn;\n}\n\nfunction emitEvent(...args) {\n  if (eventEmitter != null) {\n    eventEmitter(...args);\n  }\n}\n\nexport const getWinDimensions = (function() {\n  let lastCheckTimestamp;\n  const CHECK_INTERVAL_MS = 20;\n  return () => {\n    if (!windowDimensions || !lastCheckTimestamp || (Date.now() - lastCheckTimestamp > CHECK_INTERVAL_MS)) {\n      internal.resetWinDimensions();\n      lastCheckTimestamp = Date.now();\n    }\n    return windowDimensions;\n  }\n})();\n\nexport function resetWinDimensions() {\n  const top = canAccessWindowTop() ? internal.getWindowTop() : internal.getWindowSelf();\n\n  windowDimensions = {\n    screen: {\n      width: top.screen?.width,\n      height: top.screen?.height,\n      availWidth: top.screen?.availWidth,\n      availHeight: top.screen?.availHeight,\n      colorDepth: top.screen?.colorDepth,\n    },\n    innerHeight: top.innerHeight,\n    innerWidth: top.innerWidth,\n    outerWidth: top.outerWidth,\n    outerHeight: top.outerHeight,\n    visualViewport: {\n      height: top.visualViewport?.height,\n      width: top.visualViewport?.width,\n    },\n    document: {\n      documentElement: {\n        clientWidth: top.document?.documentElement?.clientWidth,\n        clientHeight: top.document?.documentElement?.clientHeight,\n        scrollTop: top.document?.documentElement?.scrollTop,\n        scrollLeft: top.document?.documentElement?.scrollLeft,\n      },\n      body: {\n        scrollTop: document.body?.scrollTop,\n        scrollLeft: document.body?.scrollLeft,\n        clientWidth: document.body?.clientWidth,\n        clientHeight: document.body?.clientHeight,\n      },\n    }\n  };\n}\n\n// this allows stubbing of utility functions that are used internally by other utility functions\nexport const internal = {\n  checkCookieSupport,\n  createTrackPixelIframeHtml,\n  getWindowSelf,\n  getWindowTop,\n  canAccessWindowTop,\n  getWindowLocation,\n  insertUserSyncIframe,\n  insertElement,\n  isFn,\n  triggerPixel,\n  logError,\n  logWarn,\n  logMessage,\n  logInfo,\n  parseQS,\n  formatQS,\n  deepEqual,\n  resetWinDimensions\n};\n\nlet prebidInternal = {};\n/**\n * Returns object that is used as internal prebid namespace\n */\nexport function getPrebidInternal() {\n  return prebidInternal;\n}\n\n/* utility method to get incremental integer starting from 1 */\nvar getIncrementalInteger = (function () {\n  var count = 0;\n  return function () {\n    count++;\n    return count;\n  };\n})();\n\n// generate a random string (to be used as a dynamic JSONP callback)\nexport function getUniqueIdentifierStr() {\n  return getIncrementalInteger() + Math.random().toString(16).substr(2);\n}\n\n/**\n * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n * where each x is replaced with a random hexadecimal digit from 0 to f,\n * and y is replaced with a random hexadecimal digit from 8 to b.\n * https://gist.github.com/jed/982883 via node-uuid\n */\nexport function generateUUID(placeholder) {\n  return placeholder\n    ? (placeholder ^ _getRandomData() >> placeholder / 4).toString(16)\n    : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, generateUUID);\n}\n\n/**\n * Returns random data using the Crypto API if available and Math.random if not\n * Method is from https://gist.github.com/jed/982883 like generateUUID, direct link https://gist.github.com/jed/982883#gistcomment-45104\n */\nfunction _getRandomData() {\n  if (window && window.crypto && window.crypto.getRandomValues) {\n    return crypto.getRandomValues(new Uint8Array(1))[0] % 16;\n  } else {\n    return Math.random() * 16;\n  }\n}\n\nexport function getBidIdParameter(key, paramsObj) {\n  return paramsObj?.[key] || '';\n}\n\n// parse a query string object passed in bid params\n// bid params should be an object such as {key: \"value\", key1 : \"value1\"}\n// aliases to formatQS\nexport function parseQueryStringParameters(queryObj) {\n  let result = '';\n  for (var k in queryObj) {\n    if (queryObj.hasOwnProperty(k)) { result += k + '=' + encodeURIComponent(queryObj[k]) + '&'; }\n  }\n  result = result.replace(/&$/, '');\n  return result;\n}\n\n// transform an AdServer targeting bids into a query string to send to the adserver\nexport function transformAdServerTargetingObj(targeting) {\n  // we expect to receive targeting for a single slot at a time\n  if (targeting && Object.getOwnPropertyNames(targeting).length > 0) {\n    return Object.keys(targeting)\n      .map(key => `${key}=${encodeURIComponent(targeting[key])}`).join('&');\n  } else {\n    return '';\n  }\n}\n\n/**\n * Parse a GPT-Style general size Array like `[[300, 250]]` or `\"300x250,970x90\"` into an array of width, height tuples `[[300, 250]]` or '[[300,250], [970,90]]'\n */\nexport function sizesToSizeTuples(sizes) {\n  if (typeof sizes === 'string') {\n    // multiple sizes will be comma-separated\n    return sizes\n      .split(/\\s*,\\s*/)\n      .map(sz => sz.match(/^(\\d+)x(\\d+)$/i))\n      .filter(match => match)\n      .map(([_, w, h]) => [parseInt(w, 10), parseInt(h, 10)])\n  } else if (Array.isArray(sizes)) {\n    if (isValidGPTSingleSize(sizes)) {\n      return [sizes]\n    }\n    return sizes.filter(isValidGPTSingleSize);\n  }\n  return [];\n}\n\n/**\n * Parse a GPT-Style general size Array like `[[300, 250]]` or `\"300x250,970x90\"` into an array of sizes `[\"300x250\"]` or '['300x250', '970x90']'\n * @param  {(Array.<number[]>|Array.<number>)} sizeObj Input array or double array [300,250] or [[300,250], [728,90]]\n * @return {Array.<string>}  Array of strings like `[\"300x250\"]` or `[\"300x250\", \"728x90\"]`\n */\nexport function parseSizesInput(sizeObj) {\n  return sizesToSizeTuples(sizeObj).map(sizeTupleToSizeString);\n}\n\nexport function sizeTupleToSizeString(size) {\n  return size[0] + 'x' + size[1]\n}\n\n// Parse a GPT style single size array, (i.e [300, 250])\n// into an AppNexus style string, (i.e. 300x250)\nexport function parseGPTSingleSizeArray(singleSize) {\n  if (isValidGPTSingleSize(singleSize)) {\n    return sizeTupleToSizeString(singleSize);\n  }\n}\n\nexport function sizeTupleToRtbSize(size) {\n  return {w: size[0], h: size[1]};\n}\n\n// Parse a GPT style single size array, (i.e [300, 250])\n// into OpenRTB-compatible (imp.banner.w/h, imp.banner.format.w/h, imp.video.w/h) object(i.e. {w:300, h:250})\nexport function parseGPTSingleSizeArrayToRtbSize(singleSize) {\n  if (isValidGPTSingleSize(singleSize)) {\n    return sizeTupleToRtbSize(singleSize)\n  }\n}\n\nfunction isValidGPTSingleSize(singleSize) {\n  // if we aren't exactly 2 items in this array, it is invalid\n  return isArray(singleSize) && singleSize.length === 2 && (!isNaN(singleSize[0]) && !isNaN(singleSize[1]));\n}\n\nexport function getWindowTop() {\n  return window.top;\n}\n\nexport function getWindowSelf() {\n  return window.self;\n}\n\nexport function getWindowLocation() {\n  return window.location;\n}\n\nexport function getDocument() {\n  return document;\n}\n\nexport function canAccessWindowTop() {\n  try {\n    if (internal.getWindowTop().location.href) {\n      return true;\n    }\n  } catch (e) {\n    return false;\n  }\n}\n\n/**\n * Wrappers to console.(log | info | warn | error). Takes N arguments, the same as the native methods\n */\nexport function logMessage() {\n  if (debugTurnedOn() && consoleLogExists) {\n    // eslint-disable-next-line no-console\n    console.log.apply(console, decorateLog(arguments, 'MESSAGE:'));\n  }\n}\n\nexport function logInfo() {\n  if (debugTurnedOn() && consoleInfoExists) {\n    // eslint-disable-next-line no-console\n    console.info.apply(console, decorateLog(arguments, 'INFO:'));\n  }\n}\n\nexport function logWarn() {\n  if (debugTurnedOn() && consoleWarnExists) {\n    // eslint-disable-next-line no-console\n    console.warn.apply(console, decorateLog(arguments, 'WARNING:'));\n  }\n  emitEvent(EVENTS.AUCTION_DEBUG, { type: 'WARNING', arguments: arguments });\n}\n\nexport function logError() {\n  if (debugTurnedOn() && consoleErrorExists) {\n    // eslint-disable-next-line no-console\n    console.error.apply(console, decorateLog(arguments, 'ERROR:'));\n  }\n  emitEvent(EVENTS.AUCTION_DEBUG, { type: 'ERROR', arguments: arguments });\n}\n\nexport function prefixLog(prefix) {\n  function decorate(fn) {\n    return function (...args) {\n      fn(prefix, ...args);\n    }\n  }\n  return {\n    logError: decorate(logError),\n    logWarn: decorate(logWarn),\n    logMessage: decorate(logMessage),\n    logInfo: decorate(logInfo),\n  }\n}\n\nfunction decorateLog(args, prefix) {\n  args = [].slice.call(args);\n  let bidder = config.getCurrentBidder();\n\n  prefix && args.unshift(prefix);\n  if (bidder) {\n    args.unshift(label('#aaa'));\n  }\n  args.unshift(label('#3b88c3'));\n  args.unshift('%cPrebid' + (bidder ? `%c${bidder}` : ''));\n  return args;\n\n  function label(color) {\n    return `display: inline-block; color: #fff; background: ${color}; padding: 1px 4px; border-radius: 3px;`\n  }\n}\n\nexport function hasConsoleLogger() {\n  return consoleLogExists;\n}\n\nexport function debugTurnedOn() {\n  return !!config.getConfig('debug');\n}\n\nexport const createIframe = (() => {\n  const DEFAULTS = {\n    border: '0px',\n    hspace: '0',\n    vspace: '0',\n    marginWidth: '0',\n    marginHeight: '0',\n    scrolling: 'no',\n    frameBorder: '0',\n    allowtransparency: 'true'\n  }\n  return (doc, attrs, style = {}) => {\n    const f = doc.createElement('iframe');\n    Object.assign(f, Object.assign({}, DEFAULTS, attrs));\n    Object.assign(f.style, style);\n    return f;\n  }\n})();\n\nexport function createInvisibleIframe() {\n  return createIframe(document, {\n    id: getUniqueIdentifierStr(),\n    width: 0,\n    height: 0,\n    src: 'about:blank'\n  }, {\n    display: 'none',\n    height: '0px',\n    width: '0px',\n    border: '0px'\n  });\n}\n\n/*\n *   Check if a given parameter name exists in query string\n *   and if it does return the value\n */\nexport function getParameterByName(name) {\n  return parseQS(getWindowLocation().search)[name] || '';\n}\n\n/**\n * Return if the object is of the\n * given type.\n * @param {*} object to test\n * @param {String} _t type string (e.g., Array)\n * @return {Boolean} if object is of type _t\n */\nexport function isA(object, _t) {\n  return toString.call(object) === '[object ' + _t + ']';\n}\n\nexport function isFn(object) {\n  return isA(object, tFn);\n}\n\nexport function isStr(object) {\n  return isA(object, tStr);\n}\n\nexport const isArray = Array.isArray.bind(Array);\n\nexport function isNumber(object) {\n  return isA(object, tNumb);\n}\n\nexport function isPlainObject(object) {\n  return isA(object, tObject);\n}\n\nexport function isBoolean(object) {\n  return isA(object, tBoolean);\n}\n\n/**\n * Return if the object is \"empty\";\n * this includes falsey, no keys, or no items at indices\n * @param {*} object object to test\n * @return {Boolean} if object is empty\n */\nexport function isEmpty(object) {\n  if (!object) return true;\n  if (isArray(object) || isStr(object)) {\n    return !(object.length > 0);\n  }\n  return Object.keys(object).length <= 0;\n}\n\n/**\n * Return if string is empty, null, or undefined\n * @param str string to test\n * @returns {boolean} if string is empty\n */\nexport function isEmptyStr(str) {\n  return isStr(str) && (!str || str.length === 0);\n}\n\n/**\n * Iterate object with the function\n * falls back to es5 `forEach`\n * @param {Array|Object} object\n * @param {Function} fn - The function to execute for each element. It receives three arguments: value, key, and the original object.\n * @returns {void}\n */\nexport function _each(object, fn) {\n  if (isFn(object?.forEach)) return object.forEach(fn, this);\n  Object.entries(object || {}).forEach(([k, v]) => fn.call(this, v, k));\n}\n\nexport function contains(a, obj) {\n  return isFn(a?.includes) && a.includes(obj);\n}\n\n/**\n * Map an array or object into another array\n * given a function\n * @param {Array|Object} object\n * @param {Function} callback - The function to execute for each element. It receives three arguments: value, key, and the original object.\n * @return {Array}\n */\nexport function _map(object, callback) {\n  if (isFn(object?.map)) return object.map(callback);\n  return Object.entries(object || {}).map(([k, v]) => callback(v, k, object))\n}\n\n/*\n* Inserts an element(elm) as targets child, by default as first child\n* @param {HTMLElement} elm\n* @param {HTMLElement} [doc]\n* @param {HTMLElement} [target]\n* @param {Boolean} [asLastChildChild]\n* @return {HTML Element}\n*/\nexport function insertElement(elm, doc, target, asLastChildChild) {\n  doc = doc || document;\n  let parentEl;\n  if (target) {\n    parentEl = doc.getElementsByTagName(target);\n  } else {\n    parentEl = doc.getElementsByTagName('head');\n  }\n  try {\n    parentEl = parentEl.length ? parentEl : doc.getElementsByTagName('body');\n    if (parentEl.length) {\n      parentEl = parentEl[0];\n      let insertBeforeEl = asLastChildChild ? null : parentEl.firstChild;\n      return parentEl.insertBefore(elm, insertBeforeEl);\n    }\n  } catch (e) {}\n}\n\n/**\n * Returns a promise that completes when the given element triggers a 'load' or 'error' DOM event, or when\n * `timeout` milliseconds have elapsed.\n *\n * @param {HTMLElement} element\n * @param {Number} [timeout]\n * @returns {Promise}\n */\nexport function waitForElementToLoad(element, timeout) {\n  let timer = null;\n  return new PbPromise((resolve) => {\n    const onLoad = function() {\n      element.removeEventListener('load', onLoad);\n      element.removeEventListener('error', onLoad);\n      if (timer != null) {\n        window.clearTimeout(timer);\n      }\n      resolve();\n    };\n    element.addEventListener('load', onLoad);\n    element.addEventListener('error', onLoad);\n    if (timeout != null) {\n      timer = window.setTimeout(onLoad, timeout);\n    }\n  });\n}\n\n/**\n * Inserts an image pixel with the specified `url` for cookie sync\n * @param {string} url URL string of the image pixel to load\n * @param  {function} [done] an optional exit callback, used when this usersync pixel is added during an async process\n * @param  {Number} [timeout] an optional timeout in milliseconds for the image to load before calling `done`\n */\nexport function triggerPixel(url, done, timeout) {\n  const img = new Image();\n  if (done && internal.isFn(done)) {\n    waitForElementToLoad(img, timeout).then(done);\n  }\n  img.src = url;\n}\n\n/**\n * Inserts an empty iframe with the specified `html`, primarily used for tracking purposes\n * (though could be for other purposes)\n * @param {string} htmlCode snippet of HTML code used for tracking purposes\n */\nexport function insertHtmlIntoIframe(htmlCode) {\n  if (!htmlCode) {\n    return;\n  }\n  const iframe = createInvisibleIframe();\n  internal.insertElement(iframe, document, 'body');\n\n  ((doc) => {\n    doc.open();\n    doc.write(htmlCode);\n    doc.close();\n  })(iframe.contentWindow.document);\n}\n\n/**\n * Inserts empty iframe with the specified `url` for cookie sync\n * @param  {string} url URL to be requested\n * @param  {function} [done] an optional exit callback, used when this usersync pixel is added during an async process\n * @param  {Number} [timeout] an optional timeout in milliseconds for the iframe to load before calling `done`\n */\nexport function insertUserSyncIframe(url, done, timeout) {\n  let iframeHtml = internal.createTrackPixelIframeHtml(url, false, 'allow-scripts allow-same-origin');\n  let div = document.createElement('div');\n  div.innerHTML = iframeHtml;\n  let iframe = div.firstChild;\n  if (done && internal.isFn(done)) {\n    waitForElementToLoad(iframe, timeout).then(done);\n  }\n  internal.insertElement(iframe, document, 'html', true);\n}\n\n/**\n * Creates a snippet of HTML that retrieves the specified `url`\n * @param  {string} url URL to be requested\n * @param encode\n * @return {string}     HTML snippet that contains the img src = set to `url`\n */\nexport function createTrackPixelHtml(url, encode = encodeURI) {\n  if (!url) {\n    return '';\n  }\n\n  let escapedUrl = encode(url);\n  let img = '<div style=\"position:absolute;left:0px;top:0px;visibility:hidden;\">';\n  img += '<img src=\"' + escapedUrl + '\"></div>';\n  return img;\n};\n\n/**\n * encodeURI, but preserves macros of the form '${MACRO}' (e.g. '${AUCTION_PRICE}')\n * @param url\n * @return {string}\n */\nexport function encodeMacroURI(url) {\n  const macros = Array.from(url.matchAll(/\\$({[^}]+})/g)).map(match => match[1]);\n  return macros.reduce((str, macro) => {\n    return str.replace('$' + encodeURIComponent(macro), '$' + macro)\n  }, encodeURI(url))\n}\n\n/**\n * Creates a snippet of Iframe HTML that retrieves the specified `url`\n * @param  {string} url plain URL to be requested\n * @param  {string} encodeUri boolean if URL should be encoded before inserted. Defaults to true\n * @param  {string} sandbox string if provided the sandbox attribute will be included with the given value\n * @return {string}     HTML snippet that contains the iframe src = set to `url`\n */\nexport function createTrackPixelIframeHtml(url, encodeUri = true, sandbox = '') {\n  if (!url) {\n    return '';\n  }\n  if (encodeUri) {\n    url = encodeURI(url);\n  }\n  if (sandbox) {\n    sandbox = `sandbox=\"${sandbox}\"`;\n  }\n\n  return `<iframe ${sandbox} id=\"${getUniqueIdentifierStr()}\"\n      frameborder=\"0\"\n      allowtransparency=\"true\"\n      marginheight=\"0\" marginwidth=\"0\"\n      width=\"0\" hspace=\"0\" vspace=\"0\" height=\"0\"\n      style=\"height:0px;width:0px;display:none;\"\n      scrolling=\"no\"\n      src=\"${url}\">\n    </iframe>`;\n}\n\nexport function uniques(value, index, arry) {\n  return arry.indexOf(value) === index;\n}\n\nexport function flatten(a, b) {\n  return a.concat(b);\n}\n\nexport function getBidRequest(id, bidderRequests) {\n  if (!id) {\n    return;\n  }\n  return bidderRequests.flatMap(br => br.bids)\n    .find(bid => ['bidId', 'adId', 'bid_id'].some(prop => bid[prop] === id))\n}\n\nexport function getValue(obj, key) {\n  return obj[key];\n}\n\nexport function getBidderCodes(adUnits = pbjsInstance.adUnits) {\n  // this could memoize adUnits\n  return adUnits.map(unit => unit.bids.map(bid => bid.bidder)\n    .reduce(flatten, [])).reduce(flatten, []).filter((bidder) => typeof bidder !== 'undefined').filter(uniques);\n}\n\nexport function isGptPubadsDefined() {\n  if (window.googletag && isFn(window.googletag.pubads) && isFn(window.googletag.pubads().getSlots)) {\n    return true;\n  }\n}\n\nexport function isApnGetTagDefined() {\n  if (window.apntag && isFn(window.apntag.getTag)) {\n    return true;\n  }\n}\n\nexport const sortByHighestCpm = (a, b) => {\n  return b.cpm - a.cpm;\n}\n\n/**\n * FisherYates shuffle\n * http://stackoverflow.com/a/6274398\n * https://bost.ocks.org/mike/shuffle/\n * istanbul ignore next\n */\nexport function shuffle(array) {\n  let counter = array.length;\n\n  // while there are elements in the array\n  while (counter > 0) {\n    // pick a random index\n    let index = Math.floor(Math.random() * counter);\n\n    // decrease counter by 1\n    counter--;\n\n    // and swap the last element with it\n    let temp = array[counter];\n    array[counter] = array[index];\n    array[index] = temp;\n  }\n\n  return array;\n}\n\nexport function deepClone(obj) {\n  return klona(obj) || {};\n}\n\nexport function inIframe() {\n  try {\n    return internal.getWindowSelf() !== internal.getWindowTop();\n  } catch (e) {\n    return true;\n  }\n}\n\n/**\n * https://iabtechlab.com/wp-content/uploads/2016/03/SafeFrames_v1.1_final.pdf\n */\nexport function isSafeFrameWindow() {\n  if (!inIframe()) {\n    return false;\n  }\n\n  const ws = internal.getWindowSelf();\n  return !!(ws.$sf && ws.$sf.ext);\n}\n\n/**\n * Returns the result of calling the function $sf.ext.geom() if it exists\n * @see https://iabtechlab.com/wp-content/uploads/2016/03/SafeFrames_v1.1_final.pdf  5.4 Function $sf.ext.geom\n * @returns {Object | undefined} geometric information about the container\n */\nexport function getSafeframeGeometry() {\n  try {\n    const ws = getWindowSelf();\n    return (typeof ws.$sf.ext.geom === 'function') ? ws.$sf.ext.geom() : undefined;\n  } catch (e) {\n    logError('Error getting SafeFrame geometry', e);\n    return undefined;\n  }\n}\n\nexport function isSafariBrowser() {\n  return /^((?!chrome|android|crios|fxios).)*safari/i.test(navigator.userAgent);\n}\n\nexport function replaceMacros(str, subs) {\n  if (!str) return;\n  return Object.entries(subs).reduce((str, [key, val]) => {\n    return str.replace(new RegExp('\\\\$\\\\{' + key + '\\\\}', 'g'), val || '');\n  }, str);\n}\n\nexport function replaceAuctionPrice(str, cpm) {\n  return replaceMacros(str, {AUCTION_PRICE: cpm})\n}\n\nexport function replaceClickThrough(str, clicktag) {\n  if (!str || !clicktag || typeof clicktag !== 'string') return;\n  return str.replace(/\\${CLICKTHROUGH}/g, clicktag);\n}\n\nexport function timestamp() {\n  return new Date().getTime();\n}\n\n/**\n * The returned value represents the time elapsed since the time origin. @see https://developer.mozilla.org/en-US/docs/Web/API/Performance/now\n * @returns {number}\n */\nexport function getPerformanceNow() {\n  return (window.performance && window.performance.now && window.performance.now()) || 0;\n}\n\n/**\n * Retuns the difference between `timing.domLoading` and `timing.navigationStart`.\n * This function uses the deprecated `Performance.timing` API and should be removed in future.\n * It has not been updated yet because it is still used in some modules.\n * @deprecated\n * @param {Window} w The window object used to perform the api call. default to window.self\n * @returns {number}\n */\nexport function getDomLoadingDuration(w) {\n  let domLoadingDuration = -1;\n\n  w = w || getWindowSelf();\n\n  const performance = w.performance;\n\n  if (w.performance?.timing) {\n    if (w.performance.timing.navigationStart > 0) {\n      const val = performance.timing.domLoading - performance.timing.navigationStart;\n      if (val > 0) {\n        domLoadingDuration = val;\n      }\n    }\n  }\n\n  return domLoadingDuration;\n}\n\n/**\n * When the deviceAccess flag config option is false, no cookies should be read or set\n * @returns {boolean}\n */\nexport function hasDeviceAccess() {\n  return config.getConfig('deviceAccess') !== false;\n}\n\n/**\n * @returns {(boolean|undefined)}\n */\nexport function checkCookieSupport() {\n  // eslint-disable-next-line no-restricted-properties\n  if (window.navigator.cookieEnabled || !!document.cookie.length) {\n    return true;\n  }\n}\n\n/**\n * Given a function, return a function which only executes the original after\n * it's been called numRequiredCalls times.\n *\n * Note that the arguments from the previous calls will *not* be forwarded to the original function.\n * Only the final call's arguments matter.\n *\n * @param {function} func The function which should be executed, once the returned function has been executed\n *   numRequiredCalls times.\n * @param {number} numRequiredCalls The number of times which the returned function needs to be called before\n *   func is.\n */\nexport function delayExecution(func, numRequiredCalls) {\n  if (numRequiredCalls < 1) {\n    throw new Error(`numRequiredCalls must be a positive number. Got ${numRequiredCalls}`);\n  }\n  let numCalls = 0;\n  return function () {\n    numCalls++;\n    if (numCalls === numRequiredCalls) {\n      func.apply(this, arguments);\n    }\n  }\n}\n\n/**\n * https://stackoverflow.com/a/34890276/428704\n * @param {Array} xs\n * @param {string} key\n * @returns {Object} {${key_value}: ${groupByArray}, key_value: {groupByArray}}\n */\nexport function groupBy(xs, key) {\n  return xs.reduce(function(rv, x) {\n    (rv[x[key]] = rv[x[key]] || []).push(x);\n    return rv;\n  }, {});\n}\n\n/**\n * Build an object consisting of only defined parameters to avoid creating an\n * object with defined keys and undefined values.\n * @param {Object} object The object to pick defined params out of\n * @param {string[]} params An array of strings representing properties to look for in the object\n * @returns {Object} An object containing all the specified values that are defined\n */\nexport function getDefinedParams(object, params) {\n  return params\n    .filter(param => object[param])\n    .reduce((bid, param) => Object.assign(bid, { [param]: object[param] }), {});\n}\n\n/**\n * @typedef {Object} MediaTypes\n * @property {Object} banner banner configuration\n * @property {Object} native native configuration\n * @property {Object} video video configuration\n */\n\n/**\n * Validates an adunit's `mediaTypes` parameter\n * @param {MediaTypes} mediaTypes mediaTypes parameter to validate\n * @return {boolean} If object is valid\n */\nexport function isValidMediaTypes(mediaTypes) {\n  const SUPPORTED_MEDIA_TYPES = ['banner', 'native', 'video'];\n  const SUPPORTED_STREAM_TYPES = ['instream', 'outstream', 'adpod'];\n\n  const types = Object.keys(mediaTypes);\n\n  if (!types.every(type => includes(SUPPORTED_MEDIA_TYPES, type))) {\n    return false;\n  }\n\n  if (FEATURES.VIDEO && mediaTypes.video && mediaTypes.video.context) {\n    return includes(SUPPORTED_STREAM_TYPES, mediaTypes.video.context);\n  }\n\n  return true;\n}\n\n/**\n * Returns user configured bidder params from adunit\n * @param {Object} adUnits\n * @param {string} adUnitCode code\n * @param {string} bidder code\n * @return {Array} user configured param for the given bidder adunit configuration\n */\nexport function getUserConfiguredParams(adUnits, adUnitCode, bidder) {\n  return adUnits\n    .filter(adUnit => adUnit.code === adUnitCode)\n    .flatMap((adUnit) => adUnit.bids)\n    .filter((bidderData) => bidderData.bidder === bidder)\n    .map((bidderData) => bidderData.params || {});\n}\n\n/**\n * Returns Do Not Track state\n */\nexport function getDNT() {\n  return navigator.doNotTrack === '1' || window.doNotTrack === '1' || navigator.msDoNotTrack === '1' || navigator.doNotTrack === 'yes';\n}\n\nexport const compareCodeAndSlot = (slot, adUnitCode) => slot.getAdUnitPath() === adUnitCode || slot.getSlotElementId() === adUnitCode;\n\n/**\n * Returns filter function to match adUnitCode in slot\n * @param {Object} slot GoogleTag slot\n * @return {function} filter function\n */\nexport function isAdUnitCodeMatchingSlot(slot) {\n  return (adUnitCode) => compareCodeAndSlot(slot, adUnitCode);\n}\n\n/**\n * Constructs warning message for when unsupported bidders are dropped from an adunit\n * @param {Object} adUnit ad unit from which the bidder is being dropped\n * @param {string} bidder bidder code that is not compatible with the adUnit\n * @return {string} warning message to display when condition is met\n */\nexport function unsupportedBidderMessage(adUnit, bidder) {\n  const mediaType = Object.keys(adUnit.mediaTypes || {'banner': 'banner'}).join(', ');\n\n  return `\n    ${adUnit.code} is a ${mediaType} ad unit\n    containing bidders that don't support ${mediaType}: ${bidder}.\n    This bidder won't fetch demand.\n  `;\n}\n\n/**\n * Checks input is integer or not\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\n * @param {*} value\n */\nexport const isInteger = Number.isInteger.bind(Number);\n\n/**\n * Returns a new object with undefined properties removed from given object\n * @param obj the object to clean\n */\nexport function cleanObj(obj) {\n  return Object.fromEntries(Object.entries(obj).filter(([_, v]) => typeof v !== 'undefined'))\n}\n\n/**\n * Create a new object with selected properties.  Also allows property renaming and transform functions.\n * @param obj the original object\n * @param properties An array of desired properties\n */\nexport function pick(obj, properties) {\n  if (typeof obj !== 'object') {\n    return {};\n  }\n  return properties.reduce((newObj, prop, i) => {\n    if (typeof prop === 'function') {\n      return newObj;\n    }\n\n    let newProp = prop;\n    let match = prop.match(/^(.+?)\\sas\\s(.+?)$/i);\n\n    if (match) {\n      prop = match[1];\n      newProp = match[2];\n    }\n\n    let value = obj[prop];\n    if (typeof properties[i + 1] === 'function') {\n      value = properties[i + 1](value, newObj);\n    }\n    if (typeof value !== 'undefined') {\n      newObj[newProp] = value;\n    }\n\n    return newObj;\n  }, {});\n}\n\nexport function isArrayOfNums(val, size) {\n  return (isArray(val)) && ((size) ? val.length === size : true) && (val.every(v => isInteger(v)));\n}\n\nexport function parseQS(query) {\n  return !query ? {} : query\n    .replace(/^\\?/, '')\n    .split('&')\n    .reduce((acc, criteria) => {\n      let [k, v] = criteria.split('=');\n      if (/\\[\\]$/.test(k)) {\n        k = k.replace('[]', '');\n        acc[k] = acc[k] || [];\n        acc[k].push(v);\n      } else {\n        acc[k] = v || '';\n      }\n      return acc;\n    }, {});\n}\n\nexport function formatQS(query) {\n  return Object\n    .keys(query)\n    .map(k => Array.isArray(query[k])\n      ? query[k].map(v => `${k}[]=${v}`).join('&')\n      : `${k}=${query[k]}`)\n    .join('&');\n}\n\nexport function parseUrl(url, options) {\n  let parsed = document.createElement('a');\n  if (options && 'noDecodeWholeURL' in options && options.noDecodeWholeURL) {\n    parsed.href = url;\n  } else {\n    parsed.href = decodeURIComponent(url);\n  }\n  // in window.location 'search' is string, not object\n  let qsAsString = (options && 'decodeSearchAsString' in options && options.decodeSearchAsString);\n  return {\n    href: parsed.href,\n    protocol: (parsed.protocol || '').replace(/:$/, ''),\n    hostname: parsed.hostname,\n    port: +parsed.port,\n    pathname: parsed.pathname.replace(/^(?!\\/)/, '/'),\n    search: (qsAsString) ? parsed.search : internal.parseQS(parsed.search || ''),\n    hash: (parsed.hash || '').replace(/^#/, ''),\n    host: parsed.host || window.location.host\n  };\n}\n\nexport function buildUrl(obj) {\n  return (obj.protocol || 'http') + '://' +\n    (obj.host ||\n      obj.hostname + (obj.port ? `:${obj.port}` : '')) +\n    (obj.pathname || '') +\n    (obj.search ? `?${internal.formatQS(obj.search || '')}` : '') +\n    (obj.hash ? `#${obj.hash}` : '');\n}\n\n/**\n * This function deeply compares two objects checking for their equivalence.\n * @param {Object} obj1\n * @param {Object} obj2\n * @param {Object} [options] - Options for comparison.\n * @param {boolean} [options.checkTypes=false] - If set, two objects with identical properties but different constructors will *not* be considered equivalent.\n * @returns {boolean} - Returns `true` if the objects are equivalent, `false` otherwise.\n */\nexport function deepEqual(obj1, obj2, { checkTypes = false } = {}) {\n  // Quick reference check\n  if (obj1 === obj2) return true;\n\n  // If either is null or not an object, do a direct equality check\n  if (\n    typeof obj1 !== 'object' || obj1 === null ||\n    typeof obj2 !== 'object' || obj2 === null\n  ) {\n    return false;\n  }\n  // Cache the Array checks\n  const isArr1 = Array.isArray(obj1);\n  const isArr2 = Array.isArray(obj2);\n  // Special case: both are arrays\n  if (isArr1 && isArr2) {\n    if (obj1.length !== obj2.length) return false;\n    for (let i = 0; i < obj1.length; i++) {\n      if (!deepEqual(obj1[i], obj2[i], { checkTypes })) {\n        return false;\n      }\n    }\n    return true;\n  } else if (isArr1 || isArr2) {\n    return false;\n  }\n\n  // If were checking types, compare constructors (e.g., plain object vs. Date)\n  if (checkTypes && obj1.constructor !== obj2.constructor) {\n    return false;\n  }\n\n  // Compare object keys. Cache keys for both to avoid repeated calls.\n  const keys1 = Object.keys(obj1);\n  const keys2 = Object.keys(obj2);\n\n  if (keys1.length !== keys2.length) return false;\n\n  for (const key of keys1) {\n    // If `obj2` doesn't have this key or sub-values aren't equal, bail out.\n    if (!Object.prototype.hasOwnProperty.call(obj2, key)) {\n      return false;\n    }\n    if (!deepEqual(obj1[key], obj2[key], { checkTypes })) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nexport function mergeDeep(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const source = sources[i];\n    if (!isPlainObject(source)) {\n      continue;\n    }\n    mergeDeepHelper(target, source);\n  }\n  return target;\n}\n\nfunction mergeDeepHelper(target, source) {\n  // quick check\n  if (!isPlainObject(target) || !isPlainObject(source)) {\n    return;\n  }\n\n  const keys = Object.keys(source);\n  for (let i = 0; i < keys.length; i++) {\n    const key = keys[i];\n    if (key === '__proto__' || key === 'constructor') {\n      continue;\n    }\n    const val = source[key];\n\n    if (isPlainObject(val)) {\n      if (!target[key]) {\n        target[key] = {};\n      }\n      mergeDeepHelper(target[key], val);\n    } else if (Array.isArray(val)) {\n      if (!Array.isArray(target[key])) {\n        target[key] = [...val];\n      } else {\n        // deduplicate\n        val.forEach(obj => {\n          if (!target[key].some(item => deepEqual(item, obj))) {\n            target[key].push(obj);\n          }\n        });\n      }\n    } else {\n      // direct assignment\n      target[key] = val;\n    }\n  }\n}\n\n/**\n * returns a hash of a string using a fast algorithm\n * source: https://stackoverflow.com/a/52171480/845390\n * @param str\n * @param seed (optional)\n * @returns {string}\n */\nexport function cyrb53Hash(str, seed = 0) {\n  // IE doesn't support imul\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/imul#Polyfill\n  let imul = function(opA, opB) {\n    if (isFn(Math.imul)) {\n      return Math.imul(opA, opB);\n    } else {\n      opB |= 0; // ensure that opB is an integer. opA will automatically be coerced.\n      // floating points give us 53 bits of precision to work with plus 1 sign bit\n      // automatically handled for our convienence:\n      // 1. 0x003fffff /*opA & 0x000fffff*/ * 0x7fffffff /*opB*/ = 0x1fffff7fc00001\n      //    0x1fffff7fc00001 < Number.MAX_SAFE_INTEGER /*0x1fffffffffffff*/\n      var result = (opA & 0x003fffff) * opB;\n      // 2. We can remove an integer coersion from the statement above because:\n      //    0x1fffff7fc00001 + 0xffc00000 = 0x1fffffff800001\n      //    0x1fffffff800001 < Number.MAX_SAFE_INTEGER /*0x1fffffffffffff*/\n      if (opA & 0xffc00000) result += (opA & 0xffc00000) * opB | 0;\n      return result | 0;\n    }\n  };\n\n  let h1 = 0xdeadbeef ^ seed;\n  let h2 = 0x41c6ce57 ^ seed;\n  for (let i = 0, ch; i < str.length; i++) {\n    ch = str.charCodeAt(i);\n    h1 = imul(h1 ^ ch, 2654435761);\n    h2 = imul(h2 ^ ch, 1597334677);\n  }\n  h1 = imul(h1 ^ (h1 >>> 16), 2246822507) ^ imul(h2 ^ (h2 >>> 13), 3266489909);\n  h2 = imul(h2 ^ (h2 >>> 16), 2246822507) ^ imul(h1 ^ (h1 >>> 13), 3266489909);\n  return (4294967296 * (2097151 & h2) + (h1 >>> 0)).toString();\n}\n\n/**\n * returns the result of `JSON.parse(data)`, or undefined if that throws an error.\n * @param data\n * @returns {any}\n */\nexport function safeJSONParse(data) {\n  try {\n    return JSON.parse(data);\n  } catch (e) {}\n}\n\nexport function safeJSONEncode(data) {\n  try {\n    return JSON.stringify(data);\n  } catch (e) {\n    return '';\n  }\n}\n\n/**\n * Returns a memoized version of `fn`.\n *\n * @param fn\n * @param key cache key generator, invoked with the same arguments passed to `fn`.\n *        By default, the first argument is used as key.\n * @return {function(): any}\n */\nexport function memoize(fn, key = function (arg) { return arg; }) {\n  const cache = new Map();\n  const memoized = function () {\n    const cacheKey = key.apply(this, arguments);\n    if (!cache.has(cacheKey)) {\n      cache.set(cacheKey, fn.apply(this, arguments));\n    }\n    return cache.get(cacheKey);\n  }\n  memoized.clear = cache.clear.bind(cache);\n  return memoized;\n}\n\n/**\n * Returns a Unix timestamp for given time value and unit.\n * @param {number} timeValue numeric value, defaults to 0 (which means now)\n * @param {string} timeUnit defaults to days (or 'd'), use 'm' for minutes. Any parameter that isn't 'd' or 'm' will return Date.now().\n * @returns {number}\n */\nexport function getUnixTimestampFromNow(timeValue = 0, timeUnit = 'd') {\n  const acceptableUnits = ['m', 'd'];\n  if (acceptableUnits.indexOf(timeUnit) < 0) {\n    return Date.now();\n  }\n  const multiplication = timeValue / (timeUnit === 'm' ? 1440 : 1);\n  return Date.now() + (timeValue && timeValue > 0 ? (1000 * 60 * 60 * 24 * multiplication) : 0);\n}\n\n/**\n * Converts given object into an array, so {key: 1, anotherKey: 'fred', third: ['fred']} is turned\n * into [{key: 1}, {anotherKey: 'fred'}, {third: ['fred']}]\n * @param {Object} obj the object\n * @returns {Array}\n */\nexport function convertObjectToArray(obj) {\n  return Object.keys(obj).map(key => {\n    return {[key]: obj[key]};\n  });\n}\n\n/**\n * Sets dataset attributes on a script\n * @param {HTMLScriptElement} script\n * @param {object} attributes\n */\nexport function setScriptAttributes(script, attributes) {\n  Object.entries(attributes).forEach(([k, v]) => script.setAttribute(k, v))\n}\n\n/**\n * Perform a binary search for `el` on an ordered array `arr`.\n *\n * @returns the lowest nonnegative integer I that satisfies:\n *   key(arr[i]) >= key(el) for each i between I and arr.length\n *\n *   (if one or more matches are found for `el`, returns the index of the first;\n *   if the element is not found, return the index of the first element that's greater;\n *   if no greater element exists, return `arr.length`)\n */\nexport function binarySearch(arr, el, key = (el) => el) {\n  let left = 0;\n  let right = arr.length && arr.length - 1;\n  const target = key(el);\n  while (right - left > 1) {\n    const middle = left + Math.round((right - left) / 2);\n    if (target > key(arr[middle])) {\n      left = middle;\n    } else {\n      right = middle;\n    }\n  }\n  while (arr.length > left && target > key(arr[left])) {\n    left++;\n  }\n  return left;\n}\n\n/**\n * Checks if an object has non-serializable properties.\n * Non-serializable properties are functions and RegExp objects.\n *\n * @param {Object} obj - The object to check.\n * @param {Set} checkedObjects - A set of properties that have already been checked.\n * @returns {boolean} - Returns true if the object has non-serializable properties, false otherwise.\n */\nexport function hasNonSerializableProperty(obj, checkedObjects = new Set()) {\n  for (const key in obj) {\n    const value = obj[key];\n    const type = typeof value;\n\n    if (\n      value === undefined ||\n      type === 'function' ||\n      type === 'symbol' ||\n      value instanceof RegExp ||\n      value instanceof Map ||\n      value instanceof Set ||\n      value instanceof Date ||\n      (value !== null && type === 'object' && value.hasOwnProperty('toJSON'))\n    ) {\n      return true;\n    }\n    if (value !== null && type === 'object' && value.constructor === Object) {\n      if (checkedObjects.has(value)) {\n        // circular reference, means we have a non-serializable property\n        return true;\n      }\n      checkedObjects.add(value);\n      if (hasNonSerializableProperty(value, checkedObjects)) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\n/**\n * Returns the value of a nested property in an array of objects.\n *\n * @param {Array} collection - Array of objects.\n * @param {String} key - Key of nested property.\n * @returns {any|undefined} - Value of nested property.\n */\nexport function setOnAny(collection, key) {\n  for (let i = 0, result; i < collection.length; i++) {\n    result = deepAccess(collection[i], key);\n    if (result) {\n      return result;\n    }\n  }\n  return undefined;\n}\n\nexport function extractDomainFromHost(pageHost) {\n  let domain = null;\n  try {\n    let domains = /[-\\w]+\\.([-\\w]+|[-\\w]{3,}|[-\\w]{1,3}\\.[-\\w]{2})$/i.exec(pageHost);\n    if (domains != null && domains.length > 0) {\n      domain = domains[0];\n      for (let i = 1; i < domains.length; i++) {\n        if (domains[i].length > domain.length) {\n          domain = domains[i];\n        }\n      }\n    }\n  } catch (e) {\n    domain = null;\n  }\n  return domain;\n}\n\nexport function triggerNurlWithCpm(bid, cpm) {\n  if (isStr(bid.nurl) && bid.nurl !== '') {\n    bid.nurl = bid.nurl.replace(\n      /\\${AUCTION_PRICE}/,\n      cpm\n    );\n    triggerPixel(bid.nurl);\n  }\n}\n","import {auctionManager} from '../auctionManager.js';\nimport {bidderSettings} from '../bidderSettings.js';\nimport {logError} from '../utils.js';\n\nexport function adjustCpm(cpm, bidResponse, bidRequest, {index = auctionManager.index, bs = bidderSettings} = {}) {\n  bidRequest = bidRequest || index.getBidRequest(bidResponse);\n  const adapterCode = bidResponse?.adapterCode;\n  const bidderCode = bidResponse?.bidderCode || bidRequest?.bidder;\n  const adjustAlternateBids = bs.get(bidResponse?.adapterCode, 'adjustAlternateBids');\n  const bidCpmAdjustment = bs.getOwn(bidderCode, 'bidCpmAdjustment') || bs.get(adjustAlternateBids ? adapterCode : bidderCode, 'bidCpmAdjustment');\n\n  if (bidCpmAdjustment && typeof bidCpmAdjustment === 'function') {\n    try {\n      return bidCpmAdjustment(cpm, Object.assign({}, bidResponse), bidRequest);\n    } catch (e) {\n      logError('Error during bid adjustment', e);\n    }\n  }\n  return cpm;\n}\n","let outOfFocusStart = null; // enforce null otherwise it could be undefined and the callback wouldn't execute\nlet timeOutOfFocus = 0;\nlet suspendedTimeouts = [];\n\nfunction trackTimeOutOfFocus() {\n  if (document.hidden) {\n    outOfFocusStart = Date.now()\n  } else {\n    timeOutOfFocus += Date.now() - (outOfFocusStart ?? 0); // when the page is loaded in hidden state outOfFocusStart is undefined, which results in timeoutOffset being NaN\n    outOfFocusStart = null;\n    suspendedTimeouts.forEach(({ callback, startTime, setTimerId }) => setTimerId(setFocusTimeout(callback, timeOutOfFocus - startTime)()));\n    suspendedTimeouts = [];\n  }\n}\n\ndocument.addEventListener('visibilitychange', trackTimeOutOfFocus);\n\nexport function reset() {\n  outOfFocusStart = null;\n  timeOutOfFocus = 0;\n  suspendedTimeouts = [];\n  document.removeEventListener('visibilitychange', trackTimeOutOfFocus);\n  document.addEventListener('visibilitychange', trackTimeOutOfFocus);\n}\n\n/**\n * Wraps native setTimeout function in order to count time only when page is focused\n *\n * @param {function(*): ()} [callback] - A function that will be invoked after passed time\n * @param {number} [milliseconds] - Minimum duration (in milliseconds) that the callback will be executed after\n * @returns {function(*): (number)} - Getter function for current timer id\n */\nexport function setFocusTimeout(callback, milliseconds) {\n  const startTime = timeOutOfFocus;\n  let timerId = setTimeout(() => {\n    if (timeOutOfFocus === startTime && outOfFocusStart == null) {\n      callback();\n    } else if (outOfFocusStart != null) {\n      // case when timeout ended during page is out of focus\n      suspendedTimeouts.push({\n        callback,\n        startTime,\n        setTimerId(newId) {\n          timerId = newId;\n        }\n      })\n    } else {\n      timerId = setFocusTimeout(callback, timeOutOfFocus - startTime)();\n    }\n  }, milliseconds);\n  return () => timerId;\n}\n","export function scrubIPv4(ip) {\n  if (!ip) {\n    return null;\n  }\n\n  const ones = 24;\n\n  let ipParts = ip.split('.').map(Number)\n\n  if (ipParts.length != 4) {\n    return null;\n  }\n\n  let mask = [];\n  for (let i = 0; i < 4; i++) {\n    let n = Math.max(0, Math.min(8, ones - (i * 8)));\n    mask.push((0xff << (8 - n)) & 0xff);\n  }\n\n  let maskedIP = ipParts.map((part, i) => part & mask[i]);\n\n  return maskedIP.join('.');\n}\n\nexport function scrubIPv6(ip) {\n  if (!ip) {\n    return null;\n  }\n\n  const ones = 64;\n\n  let ipParts = ip.split(':').map(part => parseInt(part, 16));\n\n  ipParts = ipParts.map(part => isNaN(part) ? 0 : part);\n  while (ipParts.length < 8) {\n    ipParts.push(0);\n  }\n\n  if (ipParts.length != 8) {\n    return null;\n  }\n\n  let mask = [];\n  for (let i = 0; i < 8; i++) {\n    let n = Math.max(0, Math.min(16, ones - (i * 16)));\n    mask.push((0xffff << (16 - n)) & 0xffff);\n  }\n\n  let maskedIP = ipParts.map((part, i) => part & mask[i]);\n\n  return maskedIP.map(part => part.toString(16)).join(':');\n}\n","import {config} from '../config.js';\nexport const CONFIG_TOGGLE = 'performanceMetrics';\nconst getTime = window.performance && window.performance.now ? () => window.performance.now() : () => Date.now();\nconst NODES = new WeakMap();\n\nexport function metricsFactory({now = getTime, mkNode = makeNode, mkTimer = makeTimer, mkRenamer = (rename) => rename, nodes = NODES} = {}) {\n  return function newMetrics() {\n    function makeMetrics(self, rename = (n) => ({forEach(fn) { fn(n); }})) {\n      rename = mkRenamer(rename);\n\n      function accessor(slot) {\n        return function (name) {\n          return self.dfWalk({\n            visit(edge, node) {\n              const obj = node[slot];\n              if (obj.hasOwnProperty(name)) {\n                return obj[name];\n              }\n            }\n          });\n        };\n      }\n\n      const getTimestamp = accessor('timestamps');\n\n      /**\n       * Register a metric.\n       *\n       * @param name metric name\n       * @param value metric valiue\n       */\n      function setMetric(name, value) {\n        const names = rename(name);\n        self.dfWalk({\n          follow(inEdge, outEdge) {\n            return outEdge.propagate && (!inEdge || !inEdge.stopPropagation)\n          },\n          visit(edge, node) {\n            names.forEach(name => {\n              if (edge == null) {\n                node.metrics[name] = value;\n              } else {\n                if (!node.groups.hasOwnProperty(name)) {\n                  node.groups[name] = [];\n                }\n                node.groups[name].push(value);\n              }\n            })\n          }\n        });\n      }\n\n      /**\n       * Mark the current time as a checkpoint with the given name, to be referenced later\n       * by `timeSince` or `timeBetween`.\n       *\n       * @param name checkpoint name\n       */\n      function checkpoint(name) {\n        self.timestamps[name] = now();\n      }\n\n      /**\n       * Get the tame passed since `checkpoint`, and optionally save it as a metric.\n       *\n       * @param {string} checkpoint checkpoint name\n       * @param {string} [metric] - The name of the metric to save. Optional.\n       * @returns {number|null} - The time in milliseconds between now and the checkpoint, or `null` if the checkpoint is not found.\n       */\n      function timeSince(checkpoint, metric) {\n        const ts = getTimestamp(checkpoint);\n        const elapsed = ts != null ? now() - ts : null;\n        if (metric != null) {\n          setMetric(metric, elapsed);\n        }\n        return elapsed;\n      }\n\n      /**\n       * Get the time passed between `startCheckpoint` and `endCheckpoint`, optionally saving it as a metric.\n       *\n       * @param {string} startCheckpoint - The name of the starting checkpoint.\n       * @param {string} endCheckpoint - The name of the ending checkpoint.\n       * @param {string} [metric] - The name of the metric to save. Optional.\n       * @returns {number|null} - The time in milliseconds between `startCheckpoint` and `endCheckpoint`, or `null` if either checkpoint is not found.\n       */\n      function timeBetween(startCheckpoint, endCheckpoint, metric) {\n        const start = getTimestamp(startCheckpoint);\n        const end = getTimestamp(endCheckpoint);\n        const elapsed = start != null && end != null ? end - start : null;\n        if (metric != null) {\n          setMetric(metric, elapsed);\n        }\n        return elapsed;\n      }\n\n      /**\n       * A function that, when called, stops a time measure and saves it as a metric.\n       *\n       * @typedef {function(): void} MetricsTimer\n       * @template {function} F\n       * @property {function(F): F} stopBefore returns a wrapper around the given function that begins by\n       *   stopping this time measure.\n       * @property {function(F): F} stopAfter returns a wrapper around the given function that ends by\n       *   stopping this time measure.\n       */\n\n      /**\n       * Start measuring a time metric with the given name.\n       *\n       * @param name metric name\n       * @return {MetricsTimer}\n       */\n      function startTiming(name) {\n        return mkTimer(now, (val) => setMetric(name, val))\n      }\n\n      /**\n       * Run fn and measure the time spent in it.\n       *\n       * @template T\n       * @param name the name to use for the measured time metric\n       * @param {function(): T} fn\n       * @return {T} the return value of `fn`\n       */\n      function measureTime(name, fn) {\n        return startTiming(name).stopAfter(fn)();\n      }\n\n      /**\n       * @typedef {Function} HookFn\n       * @property {Function(T): void} bail\n       *\n       * @template T\n       * @typedef {HookFn} TimedHookFn\n       * @property {Function(): void} stopTiming\n       * @property {T} untimed\n       */\n\n      /**\n       * Convenience method for measuring time spent in a `.before` or `.after` hook.\n       *\n       * @template T\n       * @param {string} name - The metric name.\n       * @param {HookFn} next - The hook's `next` (first) argument.\n       * @param {function(TimedHookFn): T} fn - A function that will be run immediately; it takes `next`,\n       *    where both `next` and `next.bail` automatically\n       *    call `stopTiming` before continuing with the original hook.\n       * @return {T} - The return value of `fn`.\n       */\n      function measureHookTime(name, next, fn) {\n        const stopTiming = startTiming(name);\n        return fn((function (orig) {\n          const next = stopTiming.stopBefore(orig);\n          next.bail = orig.bail && stopTiming.stopBefore(orig.bail);\n          next.stopTiming = stopTiming;\n          next.untimed = orig;\n          return next;\n        })(next));\n      }\n\n      /**\n       * Get all registered metrics.\n       * @return {{}}\n       */\n      function getMetrics() {\n        let result = {}\n        self.dfWalk({\n          visit(edge, node) {\n            result = Object.assign({}, !edge || edge.includeGroups ? node.groups : null, node.metrics, result);\n          }\n        });\n        return result;\n      }\n\n      /**\n       * Create and return a new metrics object that starts as a view on all metrics registered here,\n       * and - by default - also propagates all new metrics here.\n       *\n       * Propagated metrics are grouped together, and intended for repeated operations. For example, with the following:\n       *\n       * ```\n       * const metrics = newMetrics();\n       * const requests = metrics.measureTime('buildRequests', buildRequests)\n       * requests.forEach((req) => {\n       *   const requestMetrics = metrics.fork();\n       *   requestMetrics.measureTime('processRequest', () => processRequest(req);\n       * })\n       * ```\n       *\n       * if `buildRequests` takes 10ms and returns 3 objects, which respectively take 100, 200, and 300ms in `processRequest`, then\n       * the final `metrics.getMetrics()` would be:\n       *\n       * ```\n       * {\n       *    buildRequests: 10,\n       *    processRequest: [100, 200, 300]\n       * }\n       * ```\n       *\n       * while the inner `requestMetrics.getMetrics()` would be:\n       *\n       * ```\n       * {\n       *   buildRequests: 10,\n       *   processRequest: 100 // or 200 for the 2nd loop, etc\n       * }\n       * ```\n       *\n       *\n       * @param {Object} [options={}] - Options for forking the metrics.\n       * @param {boolean} [options.propagate=true] - If false, the forked metrics will not be propagated here.\n       * @param {boolean} [options.stopPropagation=false] - If true, propagation from the new metrics is stopped here, instead of\n       *   continuing up the chain (if for example these metrics were themselves created through `.fork()`).\n       * @param {boolean} [options.includeGroups=false] - If true, the forked metrics will also replicate metrics that were propagated\n       *   here from elsewhere. For example:\n       *   ```\n       *   const metrics = newMetrics();\n       *   const op1 = metrics.fork();\n       *   const withoutGroups = metrics.fork();\n       *   const withGroups = metrics.fork({includeGroups: true});\n       *   op1.setMetric('foo', 'bar');\n       *   withoutGroups.getMetrics() // {}\n       *   withGroups.getMetrics() // {foo: ['bar']}\n       *   ```\n       * @returns {Object} - The new metrics object.\n       */\n      function fork({propagate = true, stopPropagation = false, includeGroups = false} = {}) {\n        return makeMetrics(mkNode([[self, {propagate, stopPropagation, includeGroups}]]), rename);\n      }\n\n      /**\n       * Join `otherMetrics` with these; all metrics from `otherMetrics` will (by default) be propagated here,\n       * and all metrics from here will be included in `otherMetrics`.\n       *\n       * `propagate`, `stopPropagation` and `includeGroups` have the same semantics as in `.fork()`.\n       */\n      function join(otherMetrics, {propagate = true, stopPropagation = false, includeGroups = false} = {}) {\n        const other = nodes.get(otherMetrics);\n        if (other != null) {\n          other.addParent(self, {propagate, stopPropagation, includeGroups});\n        }\n      }\n\n      /**\n       * return a version of these metrics where all new metrics are renamed according to `renameFn`.\n       *\n       * @param {function(String): Array[String]} renameFn\n       */\n      function renameWith(renameFn) {\n        return makeMetrics(self, renameFn);\n      }\n\n      /**\n       * Create a new metrics object that uses the same propagation and renaming rules as this one.\n       */\n      function newMetrics() {\n        return makeMetrics(self.newSibling(), rename);\n      }\n\n      const metrics = {\n        startTiming,\n        measureTime,\n        measureHookTime,\n        checkpoint,\n        timeSince,\n        timeBetween,\n        setMetric,\n        getMetrics,\n        fork,\n        join,\n        newMetrics,\n        renameWith,\n        toJSON() {\n          return getMetrics();\n        }\n      };\n      nodes.set(metrics, self);\n      return metrics;\n    }\n\n    return makeMetrics(mkNode([]));\n  }\n}\n\nfunction wrapFn(fn, before, after) {\n  return function () {\n    before && before();\n    try {\n      return fn.apply(this, arguments);\n    } finally {\n      after && after();\n    }\n  };\n}\n\nfunction makeTimer(now, cb) {\n  const start = now();\n  let done = false;\n  function stopTiming() {\n    if (!done) {\n      cb(now() - start);\n      done = true;\n    }\n  }\n  stopTiming.stopBefore = (fn) => wrapFn(fn, stopTiming);\n  stopTiming.stopAfter = (fn) => wrapFn(fn, null, stopTiming);\n  return stopTiming;\n}\n\nfunction makeNode(parents) {\n  return {\n    metrics: {},\n    timestamps: {},\n    groups: {},\n    addParent(node, edge) {\n      parents.push([node, edge]);\n    },\n    newSibling() {\n      return makeNode(parents.slice());\n    },\n    dfWalk({visit, follow = () => true, visited = new Set(), inEdge} = {}) {\n      let res;\n      if (!visited.has(this)) {\n        visited.add(this);\n        res = visit(inEdge, this);\n        if (res != null) return res;\n        for (const [parent, outEdge] of parents) {\n          if (follow(inEdge, outEdge)) {\n            res = parent.dfWalk({visit, follow, visited, inEdge: outEdge});\n            if (res != null) return res;\n          }\n        }\n      }\n    }\n  };\n}\n\nconst nullMetrics = (() => {\n  const nop = function () {};\n  const empty = () => ({});\n  const none = {forEach: nop};\n  const nullTimer = () => null;\n  nullTimer.stopBefore = (fn) => fn;\n  nullTimer.stopAfter = (fn) => fn;\n  const nullNode = Object.defineProperties(\n    {dfWalk: nop, newSibling: () => nullNode, addParent: nop},\n    Object.fromEntries(['metrics', 'timestamps', 'groups'].map(prop => [prop, {get: empty}])));\n  return metricsFactory({\n    now: () => 0,\n    mkNode: () => nullNode,\n    mkRenamer: () => () => none,\n    mkTimer: () => nullTimer,\n    nodes: {get: nop, set: nop}\n  })();\n})();\n\nlet enabled = true;\nconfig.getConfig(CONFIG_TOGGLE, (cfg) => { enabled = !!cfg[CONFIG_TOGGLE] });\n\n/**\n * convenience fallback function for metrics that may be undefined, especially during tests.\n */\nexport function useMetrics(metrics) {\n  return (enabled && metrics) || nullMetrics;\n}\n\nexport const newMetrics = (() => {\n  const makeMetrics = metricsFactory();\n  return function () {\n    return enabled ? makeMetrics() : nullMetrics;\n  }\n})();\n\nexport function hookTimer(prefix, getMetrics) {\n  return function(name, hookFn) {\n    return function (next, ...args) {\n      const that = this;\n      return useMetrics(getMetrics.apply(that, args)).measureHookTime(prefix + name, next, function (next) {\n        return hookFn.call(that, next, ...args);\n      });\n    }\n  }\n}\n\nexport const timedAuctionHook = hookTimer('requestBids.', (req) => req.metrics);\nexport const timedBidResponseHook = hookTimer('addBidResponse.', (_, bid) => bid.metrics)\n","import {GreedyPromise, greedySetTimeout} from '../../libraries/greedy/greedyPromise.js';\nimport {getGlobal} from '../prebidGlobal.js';\n\nexport const pbSetTimeout = getGlobal().setTimeout ?? (FEATURES.GREEDY ? greedySetTimeout : setTimeout)\nexport const PbPromise = getGlobal().Promise ?? (FEATURES.GREEDY ? GreedyPromise : Promise);\n\nexport function delay(delayMs = 0) {\n  return new PbPromise((resolve) => {\n    pbSetTimeout(resolve, delayMs);\n  });\n}\n\n/**\n * @returns a {promise, resolve, reject} trio where `promise` is resolved by calling `resolve` or `reject`.\n */\nexport function defer({promiseFactory = (resolver) => new PbPromise(resolver)} = {}) {\n  function invoker(delegate) {\n    return (val) => delegate(val);\n  }\n\n  let resolveFn, rejectFn;\n\n  return {\n    promise: promiseFactory((resolve, reject) => {\n      resolveFn = resolve;\n      rejectFn = reject;\n    }),\n    resolve: invoker(resolveFn),\n    reject: invoker(rejectFn)\n  }\n}\n","export function simpleCompare(a, b) {\n  if (a === b) return 0;\n  return a < b ? -1 : 1;\n}\n\nexport function keyCompare(key = (item) => item) {\n  return (a, b) => simpleCompare(key(a), key(b))\n}\n\nexport function reverseCompare(compare = simpleCompare) {\n  return (a, b) => -compare(a, b) || 0;\n}\n\nexport function tiebreakCompare(...compares) {\n  return function (a, b) {\n    for (const cmp of compares) {\n      const val = cmp(a, b);\n      if (val !== 0) return val;\n    }\n    return 0;\n  }\n}\n\nexport function minimum(compare = simpleCompare) {\n  return (min, item) => compare(item, min) < 0 ? item : min;\n}\n\nexport function maximum(compare = simpleCompare) {\n  return minimum(reverseCompare(compare));\n}\n\nconst cpmCompare = keyCompare((bid) => bid.cpm);\nconst timestampCompare = keyCompare((bid) => bid.responseTimestamp);\n\n// This function will get highest cpm value bid, in case of tie it will return the bid with lowest timeToRespond\nexport const getHighestCpm = maximum(tiebreakCompare(cpmCompare, reverseCompare(keyCompare((bid) => bid.timeToRespond))))\n\n// This function will get the oldest hightest cpm value bid, in case of tie it will return the bid which came in first\n// Use case for tie: https://github.com/prebid/Prebid.js/issues/2448\nexport const getOldestHighestCpmBid = maximum(tiebreakCompare(cpmCompare, reverseCompare(timestampCompare)))\n\n// This function will get the latest hightest cpm value bid, in case of tie it will return the bid which came in last\n// Use case for tie: https://github.com/prebid/Prebid.js/issues/2539\nexport const getLatestHighestCpmBid = maximum(tiebreakCompare(cpmCompare, timestampCompare))\n","import {PbPromise} from './promise.js';\nimport {binarySearch, logError, timestamp} from '../utils.js';\nimport {setFocusTimeout} from './focusTimeout.js';\n\n/**\n * Create a set-like collection that automatically forgets items after a certain time.\n *\n * @param {function(*): (number|Promise<number>)} [startTime=timestamp] - A function taking an item added to this collection,\n *   and returning (a promise to) a timestamp to be used as the starting time for the item\n *   (the item will be dropped after `ttl(item)` milliseconds have elapsed since this timestamp).\n *   Defaults to the time the item was added to the collection.\n * @param {function(*): (number|void|Promise<number|void>)} [ttl=() => null] - A function taking an item added to this collection,\n *   and returning (a promise to) the duration (in milliseconds) the item should be kept in it.\n *   May return null to indicate that the item should be persisted indefinitely.\n * @param {boolean} [monotonic=false] - Set to true for better performance, but only if, given any two items A and B in this collection:\n *   if A was added before B, then:\n *     - startTime(A) + ttl(A) <= startTime(B) + ttl(B)\n *     - Promise.all([startTime(A), ttl(A)]) never resolves later than Promise.all([startTime(B), ttl(B)])\n * @param {number} [slack=5000] - Maximum duration (in milliseconds) that an item is allowed to persist\n *   once past its TTL. This is also roughly the interval between \"garbage collection\" sweeps.\n * @returns {Object} A set-like collection with automatic TTL expiration.\n * @returns {function(*): void} return.add - Add an item to the collection.\n * @returns {function(): void} return.clear - Clear the collection.\n * @returns {function(): Array<*>} return.toArray - Get all the items in the collection, in insertion order.\n * @returns {function(): void} return.refresh - Refresh the TTL for each item in the collection.\n * @returns {function(function(*)): function(): void} return.onExpiry - Register a callback to be run when an item has expired and is about to be\n *   removed from the collection. Returns an un-registration function\n */\nexport function ttlCollection(\n  {\n    startTime = timestamp,\n    ttl = () => null,\n    monotonic = false,\n    slack = 5000\n  } = {}\n) {\n  const items = new Map();\n  const callbacks = [];\n  const pendingPurge = [];\n  const markForPurge = monotonic\n    ? (entry) => pendingPurge.push(entry)\n    : (entry) => pendingPurge.splice(binarySearch(pendingPurge, entry, (el) => el.expiry), 0, entry)\n  let nextPurge, task;\n\n  function reschedulePurge() {\n    task && clearTimeout(task);\n    if (pendingPurge.length > 0) {\n      const now = timestamp();\n      nextPurge = Math.max(now, pendingPurge[0].expiry + slack);\n      task = setFocusTimeout(() => {\n        const now = timestamp();\n        let cnt = 0;\n        for (const entry of pendingPurge) {\n          if (entry.expiry > now) break;\n          callbacks.forEach(cb => {\n            try {\n              cb(entry.item)\n            } catch (e) {\n              logError(e);\n            }\n          });\n          items.delete(entry.item)\n          cnt++;\n        }\n        pendingPurge.splice(0, cnt);\n        task = null;\n        reschedulePurge();\n      }, nextPurge - now);\n    } else {\n      task = null;\n    }\n  }\n\n  function mkEntry(item) {\n    const values = {};\n    const thisCohort = currentCohort;\n    let expiry;\n\n    function update() {\n      if (thisCohort === currentCohort && values.start != null && values.delta != null) {\n        expiry = values.start + values.delta;\n        markForPurge(entry);\n        if (task == null || nextPurge > expiry + slack) {\n          reschedulePurge();\n        }\n      }\n    }\n\n    const [init, refresh] = Object.entries({\n      start: startTime,\n      delta: ttl\n    }).map(([field, getter]) => {\n      let currentCall;\n      return function() {\n        const thisCall = currentCall = {};\n        PbPromise.resolve(getter(item)).then((val) => {\n          if (thisCall === currentCall) {\n            values[field] = val;\n            update();\n          }\n        });\n      }\n    })\n\n    const entry = {\n      item,\n      refresh,\n      get expiry() {\n        return expiry;\n      },\n    };\n\n    init();\n    refresh();\n    return entry;\n  }\n\n  let currentCohort = {};\n\n  return {\n    [Symbol.iterator]: () => items.keys(),\n    /**\n     * Add an item to this collection.\n     * @param item\n     */\n    add(item) {\n      !items.has(item) && items.set(item, mkEntry(item));\n    },\n    /**\n     * Clear this collection.\n     */\n    clear() {\n      pendingPurge.length = 0;\n      reschedulePurge();\n      items.clear();\n      currentCohort = {};\n    },\n    /**\n     * @returns {[]} all the items in this collection, in insertion order.\n     */\n    toArray() {\n      return Array.from(items.keys());\n    },\n    /**\n     * Refresh the TTL for each item in this collection.\n     */\n    refresh() {\n      pendingPurge.length = 0;\n      reschedulePurge();\n      for (const entry of items.values()) {\n        entry.refresh();\n      }\n    },\n    /**\n     * Register a callback to be run when an item has expired and is about to be\n     * removed the from the collection.\n     * @param cb a callback that takes the expired item as argument\n     * @return an unregistration function.\n     */\n    onExpiry(cb) {\n      callbacks.push(cb);\n      return () => {\n        const idx = callbacks.indexOf(cb);\n        if (idx >= 0) {\n          callbacks.splice(idx, 1);\n        }\n      }\n    }\n  };\n}\n","import {isArrayOfNums, isInteger, isNumber, isPlainObject, isStr, logError, logWarn} from './utils.js';\nimport {config} from '../src/config.js';\nimport {hook} from './hook.js';\nimport {auctionManager} from './auctionManager.js';\n\nexport const OUTSTREAM = 'outstream';\nexport const INSTREAM = 'instream';\n\n/**\n * List of OpenRTB 2.x video object properties with simple validators.\n * Not included: `companionad`, `durfloors`, `ext`\n * reference: https://github.com/InteractiveAdvertisingBureau/openrtb2.x/blob/main/2.6.md\n */\nexport const ORTB_VIDEO_PARAMS = new Map([\n  [ 'mimes', value => Array.isArray(value) && value.length > 0 && value.every(v => typeof v === 'string') ],\n  [ 'minduration', isInteger ],\n  [ 'maxduration', isInteger ],\n  [ 'startdelay', isInteger ],\n  [ 'maxseq', isInteger ],\n  [ 'poddur', isInteger ],\n  [ 'protocols', isArrayOfNums ],\n  [ 'w', isInteger ],\n  [ 'h', isInteger ],\n  [ 'podid', isStr ],\n  [ 'podseq', isInteger ],\n  [ 'rqddurs', isArrayOfNums ],\n  [ 'placement', isInteger ], // deprecated, see plcmt\n  [ 'plcmt', isInteger ],\n  [ 'linearity', isInteger ],\n  [ 'skip', value => [1, 0].includes(value) ],\n  [ 'skipmin', isInteger ],\n  [ 'skipafter', isInteger ],\n  [ 'sequence', isInteger ], // deprecated\n  [ 'slotinpod', isInteger ],\n  [ 'mincpmpersec', isNumber ],\n  [ 'battr', isArrayOfNums ],\n  [ 'maxextended', isInteger ],\n  [ 'minbitrate', isInteger ],\n  [ 'maxbitrate', isInteger ],\n  [ 'boxingallowed', isInteger ],\n  [ 'playbackmethod', isArrayOfNums ],\n  [ 'playbackend', isInteger ],\n  [ 'delivery', isArrayOfNums ],\n  [ 'pos', isInteger ],\n  [ 'api', isArrayOfNums ],\n  [ 'companiontype', isArrayOfNums ],\n  [ 'poddedupe', isArrayOfNums ]\n]);\n\nexport function fillVideoDefaults(adUnit) {\n  const video = adUnit?.mediaTypes?.video;\n  if (video != null && video.plcmt == null) {\n    if (video.context === OUTSTREAM || [2, 3, 4].includes(video.placement)) {\n      video.plcmt = 4;\n    } else if (video.context !== OUTSTREAM && [2, 6].includes(video.playbackmethod)) {\n      video.plcmt = 2;\n    }\n  }\n}\n\n/**\n * validateOrtbVideoFields mutates the `adUnit.mediaTypes.video` object by removing invalid ortb properties (default).\n * The onInvalidParam callback can be used to handle invalid properties differently.\n * Other properties are ignored and kept as is.\n *\n * @param {Object} adUnit - The adUnit object.\n * @param {Function} onInvalidParam - The callback function to be called with key, value, and adUnit.\n * @returns {void}\n */\nexport function validateOrtbVideoFields(adUnit, onInvalidParam) {\n  const videoParams = adUnit?.mediaTypes?.video;\n\n  if (!isPlainObject(videoParams)) {\n    logWarn(`validateOrtbVideoFields: videoParams must be an object.`);\n    return;\n  }\n\n  if (videoParams != null) {\n    Object.entries(videoParams)\n      .forEach(([key, value]) => {\n        if (!ORTB_VIDEO_PARAMS.has(key)) {\n          return\n        }\n        const isValid = ORTB_VIDEO_PARAMS.get(key)(value);\n        if (!isValid) {\n          if (typeof onInvalidParam === 'function') {\n            onInvalidParam(key, value, adUnit);\n          } else {\n            delete videoParams[key];\n            logWarn(`Invalid prop in adUnit \"${adUnit.code}\": Invalid value for mediaTypes.video.${key} ORTB property. The property has been removed.`);\n          }\n        }\n      });\n  }\n}\n\n/**\n * @typedef {object} VideoBid\n * @property {string} adId id of the bid\n */\n\n/**\n * Validate that the assets required for video context are present on the bid\n * @param {VideoBid} bid Video bid to validate\n * @param {Object} [options] - Options object\n * @param {Object} [options.index=auctionManager.index] - Index object, defaulting to `auctionManager.index`\n * @return {Boolean} If object is valid\n */\nexport function isValidVideoBid(bid, {index = auctionManager.index} = {}) {\n  const videoMediaType = index.getMediaTypes(bid)?.video;\n  const context = videoMediaType && videoMediaType?.context;\n  const useCacheKey = videoMediaType && videoMediaType?.useCacheKey;\n  const adUnit = index.getAdUnit(bid);\n\n  // if context not defined assume default 'instream' for video bids\n  // instream bids require a vast url or vast xml content\n  return checkVideoBidSetup(bid, adUnit, videoMediaType, context, useCacheKey);\n}\n\nexport const checkVideoBidSetup = hook('sync', function(bid, adUnit, videoMediaType, context, useCacheKey) {\n  if (videoMediaType && (useCacheKey || context !== OUTSTREAM)) {\n    // xml-only video bids require a prebid cache url\n    const { url, useLocal } = config.getConfig('cache') || {};\n    if ((!url && !useLocal) && bid.vastXml && !bid.vastUrl) {\n      logError(`\n        This bid contains only vastXml and will not work when a prebid cache url is not specified.\n        Try enabling either prebid cache with $$PREBID_GLOBAL$$.setConfig({ cache: {url: \"...\"} });\n        or local cache with $$PREBID_GLOBAL$$.setConfig({ cache: { useLocal: true }});\n      `);\n      return false;\n    }\n\n    return !!(bid.vastUrl || bid.vastXml);\n  }\n\n  // outstream bids require a renderer on the bid or pub-defined on adunit\n  if (context === OUTSTREAM && !useCacheKey) {\n    return !!(bid.renderer || (adUnit && adUnit.renderer) || videoMediaType.renderer);\n  }\n\n  return true;\n}, 'checkVideoBidSetup');\n","/**\n * This module interacts with the server used to cache video ad content to be restored later.\n * At a high level, the expected workflow goes like this:\n *\n *   - Request video ads from Bidders\n *   - Generate IDs for each valid bid, and cache the key/value pair on the server.\n *   - Return these IDs so that publishers can use them to fetch the bids later.\n *\n * This trickery helps integrate with ad servers, which set character limits on request params.\n */\n\nimport {ajaxBuilder} from './ajax.js';\nimport {config} from './config.js';\nimport {auctionManager} from './auctionManager.js';\nimport {generateUUID, logError, logWarn} from './utils.js';\nimport {addBidToAuction} from './auction.js';\n\n/**\n * Might be useful to be configurable in the future\n * Depending on publisher needs\n */\nconst ttlBufferInSeconds = 15;\n\nexport const vastLocalCache = new Map();\n\n/**\n * @typedef {object} CacheableUrlBid\n * @property {string} vastUrl A URL which loads some valid VAST XML.\n */\n\n/**\n * @typedef {object} CacheablePayloadBid\n * @property {string} vastXml Some VAST XML which loads an ad in a video player.\n */\n\n/**\n * A CacheableBid describes the types which the videoCache can store.\n *\n * @typedef {CacheableUrlBid|CacheablePayloadBid} CacheableBid\n */\n\n/**\n * Function which wraps a URI that serves VAST XML, so that it can be loaded.\n *\n * @param {string} uri The URI where the VAST content can be found.\n * @param {(string|string[])} impTrackerURLs An impression tracker URL for the delivery of the video ad\n * @return A VAST URL which loads XML from the given URI.\n */\nfunction wrapURI(uri, impTrackerURLs) {\n  impTrackerURLs = impTrackerURLs && (Array.isArray(impTrackerURLs) ? impTrackerURLs : [impTrackerURLs]);\n  // Technically, this is vulnerable to cross-script injection by sketchy vastUrl bids.\n  // We could make sure it's a valid URI... but since we're loading VAST XML from the\n  // URL they provide anyway, that's probably not a big deal.\n  let impressions = impTrackerURLs ? impTrackerURLs.map(trk => `<Impression><![CDATA[${trk}]]></Impression>`).join('') : '';\n  return `<VAST version=\"3.0\">\n    <Ad>\n      <Wrapper>\n        <AdSystem>prebid.org wrapper</AdSystem>\n        <VASTAdTagURI><![CDATA[${uri}]]></VASTAdTagURI>\n        ${impressions}\n        <Creatives></Creatives>\n      </Wrapper>\n    </Ad>\n  </VAST>`;\n}\n\n/**\n * Wraps a bid in the format expected by the prebid-server endpoints, or returns null if\n * the bid can't be converted cleanly.\n *\n * @param {CacheableBid} bid\n * @param {Object} [options] - Options object.\n * @param {Object} [options.index=auctionManager.index] - Index object, defaulting to `auctionManager.index`.\n * @return {Object|null} - The payload to be sent to the prebid-server endpoints, or null if the bid can't be converted cleanly.\n */\nfunction toStorageRequest(bid, {index = auctionManager.index} = {}) {\n  const vastValue = getVastXml(bid);\n  const auction = index.getAuction(bid);\n  const ttlWithBuffer = Number(bid.ttl) + ttlBufferInSeconds;\n  let payload = {\n    type: 'xml',\n    value: vastValue,\n    ttlseconds: ttlWithBuffer\n  };\n\n  if (config.getConfig('cache.vasttrack')) {\n    payload.bidder = bid.bidder;\n    payload.bidid = bid.requestId;\n    payload.aid = bid.auctionId;\n  }\n\n  if (auction != null) {\n    payload.timestamp = auction.getAuctionStart();\n  }\n\n  if (typeof bid.customCacheKey === 'string' && bid.customCacheKey !== '') {\n    payload.key = bid.customCacheKey;\n  }\n\n  return payload;\n}\n\n/**\n * A function which should be called with the results of the storage operation.\n *\n * @callback videoCacheStoreCallback\n *\n * @param {Error} [error] The error, if one occurred.\n * @param {?string[]} uuids An array of unique IDs. The array will have one element for each bid we were asked\n *   to store. It may include null elements if some of the bids were malformed, or an error occurred.\n *   Each non-null element in this array is a valid input into the retrieve function, which will fetch\n *   some VAST XML which can be used to render this bid's ad.\n */\n\n/**\n * A function which bridges the APIs between the videoCacheStoreCallback and our ajax function's API.\n *\n * @param {videoCacheStoreCallback} done A callback to the \"store\" function.\n * @return {Function} A callback which interprets the cache server's responses, and makes up the right\n *   arguments for our callback.\n */\nfunction shimStorageCallback(done) {\n  return {\n    success: function (responseBody) {\n      let ids;\n      try {\n        ids = JSON.parse(responseBody).responses\n      } catch (e) {\n        done(e, []);\n        return;\n      }\n\n      if (ids) {\n        done(null, ids);\n      } else {\n        done(new Error(\"The cache server didn't respond with a responses property.\"), []);\n      }\n    },\n    error: function (statusText, responseBody) {\n      done(new Error(`Error storing video ad in the cache: ${statusText}: ${JSON.stringify(responseBody)}`), []);\n    }\n  }\n}\n\nfunction getVastXml(bid) {\n  return bid.vastXml ? bid.vastXml : wrapURI(bid.vastUrl, bid.vastImpUrl);\n};\n\n/**\n * If the given bid is for a Video ad, generate a unique ID and cache it somewhere server-side.\n *\n * @param {CacheableBid[]} bids A list of bid objects which should be cached.\n * @param {videoCacheStoreCallback} [done] An optional callback which should be executed after\n * the data has been stored in the cache.\n */\nexport function store(bids, done, getAjax = ajaxBuilder) {\n  const requestData = {\n    puts: bids.map(toStorageRequest)\n  };\n  const ajax = getAjax(config.getConfig('cache.timeout'));\n  ajax(config.getConfig('cache.url'), shimStorageCallback(done), JSON.stringify(requestData), {\n    contentType: 'text/plain',\n    withCredentials: true\n  });\n}\n\nexport function getCacheUrl(id) {\n  return `${config.getConfig('cache.url')}?uuid=${id}`;\n}\n\nexport const storeLocally = (bid) => {\n  const vastXml = getVastXml(bid);\n  const bidVastUrl = URL.createObjectURL(new Blob([vastXml], { type: 'text/xml' }));\n\n  assignVastUrlAndCacheId(bid, bidVastUrl);\n\n  vastLocalCache.set(bid.videoCacheKey, bidVastUrl);\n};\n\nconst assignVastUrlAndCacheId = (bid, vastUrl, videoCacheKey) => {\n  bid.videoCacheKey = videoCacheKey || generateUUID();\n  if (!bid.vastUrl) {\n    bid.vastUrl = vastUrl;\n  }\n}\n\nexport const _internal = {\n  store\n}\n\nexport function storeBatch(batch) {\n  const bids = batch.map(entry => entry.bidResponse)\n  function err(msg) {\n    logError(`Failed to save to the video cache: ${msg}. Video bids will be discarded:`, bids)\n  }\n  _internal.store(bids, function (error, cacheIds) {\n    if (error) {\n      err(error)\n    } else if (batch.length !== cacheIds.length) {\n      logError(`expected ${batch.length} cache IDs, got ${cacheIds.length} instead`)\n    } else {\n      cacheIds.forEach((cacheId, i) => {\n        const {auctionInstance, bidResponse, afterBidAdded} = batch[i];\n        if (cacheId.uuid === '') {\n          logWarn(`Supplied video cache key was already in use by Prebid Cache; caching attempt was rejected. Video bid must be discarded.`);\n        } else {\n          assignVastUrlAndCacheId(bidResponse, getCacheUrl(bidResponse.videoCacheKey), cacheId.uuid);\n          addBidToAuction(auctionInstance, bidResponse);\n          afterBidAdded();\n        }\n      });\n    }\n  });\n};\n\nlet batchSize, batchTimeout, cleanupHandler;\nif (FEATURES.VIDEO) {\n  config.getConfig('cache', ({cache}) => {\n    batchSize = typeof cache.batchSize === 'number' && cache.batchSize > 0\n      ? cache.batchSize\n      : 1;\n    batchTimeout = typeof cache.batchTimeout === 'number' && cache.batchTimeout > 0\n      ? cache.batchTimeout\n      : 0;\n\n    // removing blobs that are not going to be used\n    if (cache.useLocal && !cleanupHandler) {\n      cleanupHandler = auctionManager.onExpiry((auction) => {\n        auction.getBidsReceived()\n          .forEach((bid) => {\n            const vastUrl = vastLocalCache.get(bid.videoCacheKey)\n            if (vastUrl && vastUrl.startsWith('blob')) {\n              URL.revokeObjectURL(vastUrl);\n            }\n            vastLocalCache.delete(bid.videoCacheKey);\n          })\n      });\n    }\n  });\n}\n\nexport const batchingCache = (timeout = setTimeout, cache = storeBatch) => {\n  let batches = [[]];\n  let debouncing = false;\n  const noTimeout = cb => cb();\n\n  return function (auctionInstance, bidResponse, afterBidAdded) {\n    const batchFunc = batchTimeout > 0 ? timeout : noTimeout;\n    if (batches[batches.length - 1].length >= batchSize) {\n      batches.push([]);\n    }\n\n    batches[batches.length - 1].push({auctionInstance, bidResponse, afterBidAdded});\n\n    if (!debouncing) {\n      debouncing = true;\n      batchFunc(() => {\n        batches.forEach(cache);\n        batches = [[]];\n        debouncing = false;\n      }, batchTimeout);\n    }\n  };\n};\n\nexport const batchAndStore = batchingCache();\n","export default function dlv(obj, key, def, p, undef) {\n\tkey = key.split ? key.split('.') : key;\n\tfor (p = 0; p < key.length; p++) {\n\t\tobj = obj ? obj[key[p]] : undef;\n\t}\n\treturn obj === undef ? def : obj;\n}\n","/*\n* @license MIT\n* Fun Hooks v0.9.10\n* (c) @snapwich\n*/\ncreate.SYNC = 1;\ncreate.ASYNC = 2;\ncreate.QUEUE = 4;\n\nvar packageName = \"fun-hooks\";\n\nfunction hasProxy() {\n  return !!(typeof Proxy === \"function\" && Proxy.revocable);\n}\n\nvar defaults = Object.freeze({\n  useProxy: true,\n  ready: 0\n});\n\nvar hookableMap = new WeakMap();\n\n// detect incorrectly implemented reduce and if found use polyfill\n// https://github.com/prebid/Prebid.js/issues/3576\n// polyfill from: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce\nvar reduce =\n  [1]\n    .reduce(function(a, b, c) {\n      return [a, b, c];\n    }, 2)\n    .toString() === \"2,1,0\"\n    ? Array.prototype.reduce\n    : function(callback, initial) {\n        var o = Object(this);\n        var len = o.length >>> 0;\n        var k = 0;\n        var value;\n        if (initial) {\n          value = initial;\n        } else {\n          while (k < len && !(k in o)) {\n            k++;\n          }\n          value = o[k++];\n        }\n        while (k < len) {\n          if (k in o) {\n            value = callback(value, o[k], k, o);\n          }\n          k++;\n        }\n        return value;\n      };\n\nfunction rest(args, skip) {\n  return Array.prototype.slice.call(args, skip);\n}\n\nvar assign =\n  Object.assign ||\n  function assign(target) {\n    return reduce.call(\n      rest(arguments, 1),\n      function(target, obj) {\n        if (obj) {\n          Object.keys(obj).forEach(function(prop) {\n            target[prop] = obj[prop];\n          });\n        }\n        return target;\n      },\n      target\n    );\n  };\n\nfunction runAll(queue) {\n  var queued;\n  // eslint-disable-next-line no-cond-assign\n  while ((queued = queue.shift())) {\n    queued();\n  }\n}\n\nfunction create(config) {\n  var hooks = {};\n  var postReady = [];\n\n  config = assign({}, defaults, config);\n\n  function dispatch(arg1, arg2) {\n    if (typeof arg1 === \"function\") {\n      return hookFn.call(null, \"sync\", arg1, arg2);\n    } else if (typeof arg1 === \"string\" && typeof arg2 === \"function\") {\n      return hookFn.apply(null, arguments);\n    } else if (typeof arg1 === \"object\") {\n      return hookObj.apply(null, arguments);\n    }\n  }\n\n  var ready;\n  if (config.ready) {\n    dispatch.ready = function() {\n      ready = true;\n      runAll(postReady);\n    };\n  } else {\n    ready = true;\n  }\n\n  function hookObj(obj, props, objName) {\n    var walk = true;\n    if (typeof props === \"undefined\") {\n      props = Object.getOwnPropertyNames(obj);\n      walk = false;\n    }\n    var objHooks = {};\n    var doNotHook = [\"constructor\"];\n    do {\n      props = props.filter(function(prop) {\n        return (\n          typeof obj[prop] === \"function\" &&\n          !(doNotHook.indexOf(prop) !== -1) &&\n          !prop.match(/^_/)\n        );\n      });\n      props.forEach(function(prop) {\n        var parts = prop.split(\":\");\n        var name = parts[0];\n        var type = parts[1] || \"sync\";\n        if (!objHooks[name]) {\n          var fn = obj[name];\n          objHooks[name] = obj[name] = hookFn(\n            type,\n            fn,\n            objName ? [objName, name] : undefined\n          );\n        }\n      });\n      obj = Object.getPrototypeOf(obj);\n    } while (walk && obj);\n    return objHooks;\n  }\n\n  /**\n   * Navigates a string path to return a hookable function.  If not found, creates a placeholder for hooks.\n   * @param {(Array<string> | string)} path\n   */\n  function get(path) {\n    var parts = Array.isArray(path) ? path : path.split(\".\");\n    return reduce.call(\n      parts,\n      function(memo, part, i) {\n        var item = memo[part];\n        var installed = false;\n        if (item) {\n          return item;\n        } else if (i === parts.length - 1) {\n          if (!ready) {\n            postReady.push(function() {\n              if (!installed) {\n                // eslint-disable-next-line no-console\n                console.warn(\n                  packageName +\n                    \": referenced '\" +\n                    path +\n                    \"' but it was never created\"\n                );\n              }\n            });\n          }\n          return (memo[part] = newHookable(function(fn) {\n            memo[part] = fn;\n            installed = true;\n          }));\n        }\n        return (memo[part] = {});\n      },\n      hooks\n    );\n  }\n\n  function newHookable(onInstall) {\n    var before = [];\n    var after = [];\n    var generateTrap = function() {};\n\n    var api = {\n      before: function(hook, priority) {\n        return add.call(this, before, \"before\", hook, priority);\n      },\n      after: function(hook, priority) {\n        return add.call(this, after, \"after\", hook, priority);\n      },\n      getHooks: function(match) {\n        var hooks = before.concat(after);\n        if (typeof match === \"object\") {\n          hooks = hooks.filter(function(entry) {\n            return Object.keys(match).every(function(prop) {\n              return entry[prop] === match[prop];\n            });\n          });\n        }\n        try {\n          assign(hooks, {\n            remove: function() {\n              hooks.forEach(function(entry) {\n                entry.remove();\n              });\n              return this;\n            }\n          });\n        } catch (e) {\n          console.error(\n            \"error adding `remove` to array, did you modify Array.prototype?\"\n          );\n        }\n        return hooks;\n      },\n      removeAll: function() {\n        return this.getHooks().remove();\n      }\n    };\n\n    var meta = {\n      install: function(type, fn, generate) {\n        this.type = type;\n        generateTrap = generate;\n        generate(before, after);\n        onInstall && onInstall(fn);\n      }\n    };\n\n    // store meta data related to hookable. use `api.after` since `api` reference is not available on our proxy.\n    hookableMap.set(api.after, meta);\n\n    return api;\n\n    function add(store, type, hook, priority) {\n      var entry = {\n        hook: hook,\n        type: type,\n        priority: priority || 10,\n        remove: function() {\n          var index = store.indexOf(entry);\n          if (index !== -1) {\n            store.splice(index, 1);\n            generateTrap(before, after);\n          }\n        }\n      };\n      store.push(entry);\n      store.sort(function(a, b) {\n        return b.priority - a.priority;\n      });\n      generateTrap(before, after);\n      return this;\n    }\n  }\n\n  function hookFn(type, fn, name) {\n    // check if function has already been wrapped\n    var meta = fn.after && hookableMap.get(fn.after);\n    if (meta) {\n      if (meta.type !== type) {\n        throw packageName + \": recreated hookable with different type\";\n      } else {\n        return fn;\n      }\n    }\n\n    var hookable = name ? get(name) : newHookable();\n\n    var trap;\n    var hookedFn;\n    var handlers = {\n      get: function(target, prop) {\n        return hookable[prop] || Reflect.get.apply(Reflect, arguments);\n      }\n    };\n\n    if (!ready) {\n      postReady.push(setTrap);\n    }\n\n    if (config.useProxy && hasProxy()) {\n      hookedFn = new Proxy(fn, handlers);\n    } else {\n      hookedFn = function() {\n        return handlers.apply\n          ? handlers.apply(fn, this, rest(arguments))\n          : fn.apply(this, arguments);\n      };\n      assign(hookedFn, hookable);\n    }\n\n    hookableMap.get(hookedFn.after).install(type, hookedFn, generateTrap);\n\n    return hookedFn;\n\n    // eslint-disable-next-line no-redeclare\n    function generateTrap(before, after) {\n      var order = [];\n      var targetIndex;\n      if (before.length || after.length) {\n        before.forEach(addToOrder);\n        // placeholder for target function wrapper\n        targetIndex = order.push(undefined) - 1;\n        after.forEach(addToOrder);\n        trap = function(target, thisArg, args) {\n          var curr = 0;\n          var result;\n          var callback =\n            type === \"async\" &&\n            typeof args[args.length - 1] === \"function\" &&\n            args.pop();\n          function bail(value) {\n            if (type === \"sync\") {\n              result = value;\n            } else if (callback) {\n              callback.apply(null, arguments);\n            }\n          }\n          function next(value) {\n            if (order[curr]) {\n              var args = rest(arguments);\n              next.bail = bail;\n              args.unshift(next);\n              return order[curr++].apply(thisArg, args);\n            }\n            if (type === \"sync\") {\n              result = value;\n            } else if (callback) {\n              callback.apply(null, arguments);\n            }\n          }\n          order[targetIndex] = function() {\n            var args = rest(arguments, 1);\n            if (type === \"async\" && callback) {\n              delete next.bail;\n              args.push(next);\n            }\n            var result = target.apply(thisArg, args);\n            if (type === \"sync\") {\n              next(result);\n            }\n          };\n          next.apply(null, args);\n          return result;\n        };\n      } else {\n        trap = undefined;\n      }\n      setTrap();\n\n      function addToOrder(entry) {\n        order.push(entry.hook);\n      }\n    }\n\n    function setTrap() {\n      if (\n        ready ||\n        (type === \"sync\" && !(config.ready & create.SYNC)) ||\n        (type === \"async\" && !(config.ready & create.ASYNC))\n      ) {\n        handlers.apply = trap;\n      } else if (type === \"sync\" || !(config.ready & create.QUEUE)) {\n        handlers.apply = function() {\n          throw packageName + \": hooked function not ready\";\n        };\n      } else {\n        handlers.apply = function() {\n          var args = arguments;\n          postReady.push(function() {\n            hookedFn.apply(args[1], args[2]);\n          });\n        };\n      }\n    }\n  }\n\n  dispatch.get = get;\n  return dispatch;\n}\n\n/* global module */\nmodule.exports = create;\n","export function dset(obj, keys, val) {\n\tkeys.split && (keys=keys.split('.'));\n\tvar i=0, l=keys.length, t=obj, x, k;\n\twhile (i < l) {\n\t\tk = ''+keys[i++];\n\t\tif (k === '__proto__' || k === 'constructor' || k === 'prototype') break;\n\t\tt = t[k] = (i === l) ? val : (typeof(x=t[k])===typeof(keys)) ? x : (keys[i]*0 !== 0 || !!~(''+keys[i]).indexOf('.')) ? {} : [];\n\t}\n}\n","export function klona(val) {\n\tvar k, out, tmp;\n\n\tif (Array.isArray(val)) {\n\t\tout = Array(k=val.length);\n\t\twhile (k--) out[k] = (tmp=val[k]) && typeof tmp === 'object' ? klona(tmp) : tmp;\n\t\treturn out;\n\t}\n\n\tif (Object.prototype.toString.call(val) === '[object Object]') {\n\t\tout = {}; // null\n\t\tfor (k in val) {\n\t\t\tif (k === '__proto__') {\n\t\t\t\tObject.defineProperty(out, k, {\n\t\t\t\t\tvalue: klona(val[k]),\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\twritable: true,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tout[k] = (tmp=val[k]) && typeof tmp === 'object' ? klona(tmp) : tmp;\n\t\t\t}\n\t\t}\n\t\treturn out;\n\t}\n\n\treturn val;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {install} from './debugging.js';\n\nwindow._pbjsGlobals.forEach((name) => {\n  if (window[name] && window[name]._installDebugging === true) {\n    window[name]._installDebugging = install;\n  }\n})\n"],"names":["RENDERER","CLIENT_SECTIONS","find","compareCodeAndSlot","deepAccess","isGptPubadsDefined","uniques","isSlotMatchingAdUnitCode","adUnitCode","slot","setKeyValue","key","value","window","googletag","cmd","push","pubads","setTargeting","getGptSlotForAdUnitCode","matchingSlot","getSlots","getGptSlotInfoForAdUnitCode","gptSlot","getAdUnitPath","divId","getSlotElementId","taxonomies","getSignals","fpd","signals","Object","entries","getSegments","map","section","_ref","taxonomy","values","length","filter","ob","sections","segtax","flatMap","datum","ext","segment","seg","id","subscribeToGamEvent","event","callback","register","addEventListener","subscribeToGamSlotRenderEndedEvent","SUCCESS","FAIL","GreedyPromise","result","callbacks","constructor","resolver","Error","resolve","reject","type","then","shift","e","onSuccess","onError","continuation","handler","resolveFn","catch","finally","onFinally","val","v","collect","#collect","promises","collector","done","cnt","clt","apply","arguments","forEach","p","i","err","race","success","all","res","allSettled","status","reason","error","greedySetTimeout","fn","delayMs","undefined","setTimeout","BANNER","VIDEO","deepClone","delayExecution","hasNonSerializableProperty","mergeDeep","responseResolvers","BidInterceptor","opts","bind","logger","rules","assign","prototype","DEFAULT_RULE_OPTIONS","delay","serializeConfig","ruleDefs","isSerializable","ruleDef","serializable","logWarn","updateConfig","config","intercept","rule","ruleNo","no","match","matcher","when","replace","replacer","options","paapi","paapiReplacer","matchDef","logError","matches","candidate","ref","args","_ref2","cVal","RegExp","exec","every","_len","Array","_key","replDef","_this","replFn","_ref3","_ref4","isArray","_ref5","bid","response","responseDefaults","_len2","_key2","mediaType","isDebug","paapiDef","wrap","configs","keys","some","k","includes","requestId","bidId","cpm","currency","ttl","creativeId","netRevenue","meta","mediaTypes","size","banner","sizes","video","playerSize","width","height","_len3","_key3","matchAll","bids","bidRequest","remainder","_ref6","addBid","addPaapiConfig","callDone","mockResponse","mockPaapi","logMessage","cfg","makePbsInterceptor","addHooks","removeHooks","interceptorHooks","bidInterceptor","enabled","enableDebugging","debugConfig","fromSession","hook","setConfig","debug","resetHooks","disableDebugging","saveDebuggingConfig","sessionStorage","DEBUG_KEY","removeItem","setItem","JSON","stringify","getConfig","debugging","getStorage","sessionLoader","storage","overrides","parse","getItem","enable","getHookFn","interceptor","getHooks","remove","before","registerBidInterceptor","interceptBids","next","bidderBidInterceptor","spec","ajax","wrapCallback","cbs","onCompletion","onBid","onPaapi","onResponse","install","createBid","pbsBidInterceptor","get","_ref7","init","addBidResponseBound","addBidderRequestsBound","addBidResponseHook","addBidderRequestsHook","bidExcluded","overrideObj","bidderCode","bidder","bidderExcluded","bidders","indexOf","applyBidOverrides","bidObj","bidType","reduce","overrideBid","bidderRequests","includedBidderRequests","bidderRequest","bidRequests","STATUS","s2sBidRequest","onFledge","responseArgs","signalResponse","adUnit","GOOD","requestBidder","req","ortb2","ortb2Imp","bidIds","Set","add","ad_units","unit","has","bid_id","NATIVE","Renderer","ORTB_NATIVE_ASSET_TYPES","bidResponse","hasOwnProperty","repeat","wratio","hratio","ad","vastXml","renderer","url","setRender","doc","parentId","div","createElement","getElementById","appendChild","player","jwplayer","setup","advertising","client","outstream","endstate","on","vastUrl","loadAdTag","loadAdXml","native","ortb","link","clicktrackers","assets","nativeOrtbRequest","mapDefaultNativeOrtbAsset","asset","assetType","img","w","h","vasttag","data","title","text","loadExternalScript","getGlobal","MODULE_TYPE_PREBID","pbjsInstance","moduleCode","loaded","renderNow","handlers","func","call","process","render","renderArgs","runRender","_render","isRendererPreferredFromAdUnit","unshift","documentContext","setEventHandlers","handleVideoEvent","eventName","isRendererRequired","executeRenderer","docContext","documentResolver","document","adUnits","code","adUnitRenderer","hasValidAdUnitRenderer","mediaTypeRenderer","hasValidMediaTypeRenderer","backupOnly","ACTIVITY_ACCESS_DEVICE","ACTIVITY_SYNC_USER","ACTIVITY_ENRICH_UFPD","ACTIVITY_ENRICH_EIDS","ACTIVITY_FETCH_BIDS","ACTIVITY_REPORT_ANALYTICS","ACTIVITY_TRANSMIT_EIDS","ACTIVITY_TRANSMIT_UFPD","ACTIVITY_TRANSMIT_PRECISE_GEO","ACTIVITY_TRANSMIT_TID","LOAD_EXTERNAL_SCRIPT","adapterManager","activityParamsBuilder","activityParams","alias","resolveAlias","MODULE_TYPE_BIDDER","MODULE_TYPE_UID","MODULE_TYPE_RTD","MODULE_TYPE_ANALYTICS","ACTIVITY_PARAM_COMPONENT","ACTIVITY_PARAM_COMPONENT_TYPE","ACTIVITY_PARAM_COMPONENT_NAME","ACTIVITY_PARAM_ADAPTER_CODE","ACTIVITY_PARAM_STORAGE_TYPE","ACTIVITY_PARAM_S2S_NAME","ACTIVITY_PARAM_SYNC_TYPE","ACTIVITY_PARAM_SYNC_URL","ACTIVITY_PARAM_ANL_CONFIG","moduleType","moduleName","params","defaults","buildActivityParams","isActivityAllowed","registerActivityControl","scrubIPv4","scrubIPv6","ORTB_UFPD_PATHS","f","concat","ORTB_EIDS_PATHS","ORTB_GEO_PATHS","ORTB_IPV4_PATHS","ORTB_IPV6_PATHS","redactRule","run","root","path","object","property","applies","isData","repl","objectTransformer","paths","parts","split","tail","pop","join","applyTransform","session","obj","sessionedApplies","name","head","parent","el","appliesWhenActivityDenied","activity","isAllowed","bidRequestTransmitRules","ortb2TransmitRules","Math","round","Number","EPSILON","redactorFactory","redactOrtb2","redactBidRequest","redactor","allow","prefixLog","ruleRegistry","registry","getRules","runRule","component","dupes","DEDUPE_INTERVAL","logResult","msg","deduping","clearTimeout","logInfo","ruleName","priority","pos","findIndex","itemPriority","entry","splice","idx","lastPriority","foundAllow","ruleResult","createIframe","createInvisibleIframe","inIframe","insertElement","replaceMacros","triggerPixel","events","AD_RENDER_FAILED_REASON","BID_STATUS","EVENTS","MESSAGES","PB_LOCATOR","auctionManager","getCreativeRenderer","fireNativeTrackers","PbPromise","useMetrics","filters","EVENT_TYPE_WIN","parseEventTrackers","TRACKER_METHOD_IMG","AD_RENDER_FAILED","AD_RENDER_SUCCEEDED","STALE_RENDER","BID_WON","EXPIRED_RENDER","EXCEPTION","getBidToRender","adId","forRender","override","findBidByAdId","markWinningBid","eventtrackers","emit","addWinningBid","emitAdRenderFail","message","emitAdRenderSucceeded","callAdRenderSucceededBidder","adapterCode","handleCreativeEvent","info","handleNativeMessage","resizeFn","fireTrackers","action","HANDLERS","EVENT","creativeMessageHandler","deps","getRenderingData","adUrl","originalCpm","instl","AUCTION_PRICE","CLICKTHROUGH","clickUrl","doRender","renderFn","isMainDocument","videoBid","PREVENT_WRITING_ON_MAIN_DOCUMENT","bail","handleRender","deferRendering","CANNOT_FIND_AD","RENDERED","suppressStaleRender","isBidNotExpired","suppressExpiredRender","markBidAsRendered","metrics","checkpoint","timeBetween","DEFERRED_RENDER","WeakMap","WINNERS","WeakSet","set","renderIfDeferred","markWinner","delete","renderAdDirect","fail","frame","defaultView","frameElement","style","messageHandler","adData","write","close","sendMessage","mkFrame","stack","creativeComment","createComment","MISSING_DOC_OR_ADID","clickThrough","insertLocatorFrame","frames","body","requestAnimationFrame","reset","ensureAdUnit","adunit","incrementAdUnitCount","counter","incrementRequestsCounter","incrementBidderRequestsCounter","incrementBidderWinsCounter","incrementAuctionsCounter","getRequestsCounter","requestsCounter","getBidderRequestsCounter","getBidderWinsCounter","winsCounter","getAuctionsCounter","auctionsCounter","Adapter","setBidderCode","getBidderCode","callBids","flatten","generateUUID","getBidderCodes","getDefinedParams","getUniqueIdentifierStr","getUserConfiguredParams","groupBy","internal","isPlainObject","isValidMediaTypes","shuffle","timestamp","decorateAdUnitsWithNativeParams","nativeAdapters","newBidder","ajaxBuilder","RANDOM","getRefererInfo","GDPR_GVLIDS","gdprDataHandler","gppDataHandler","uspDataHandler","S2S","EVENT_TYPE_IMPRESSION","coppaDataHandler","PBS_ADAPTER_NAME","PARTITIONS","CLIENT","SERVER","dep","redact","_bidderRegistry","bidderRegistry","_aliasRegistry","aliasRegistry","_s2sConfigs","s2sConfig","_analyticsRegistry","s2sActivityParams","configName","getBids","auctionId","bidderRequestId","src","s2sBid","transactionId","adUnitId","auctionsCount","bidRequestsCount","bidderRequestsCount","bidderWinsCount","deferBilling","hookedGetBids","_filterBidsForAdUnit","getS2SBidders","getS2SBidderSet","serverBidders","filterBidsForAdUnit","getAdUnitCopyForPrebidServer","adUnitsCopy","hasModuleBids","s2sBids","b","module","getAdUnitCopyForClientAdapters","adUnitsClientCopy","setupAdUnitMediaTypes","labels","s2sConfigs","s2s","_partitionBidders","memo","partition","partitionBidders","makeBidRequests","auctionStart","cbTimeout","ortb2Fragments","auctionMetrics","BEFORE_REQUEST_BIDS","au","clientBidders","refererInfo","global","bidderOrtb2","addOrtb2","freeze","source","tid","s2sParams","adUnitsS2SCopy","uniquePbsTid","fork","SRC","timeout","adUnitCopy","validBids","adUnitBid","request","reqBid","adapter","getConsentData","addBidResponse","doneCb","requestCallbacks","requestBidsTimeout","onTimelyResponse","clientBidderRequests","serverBidderRequests","partitions","uniqueServerBidRequests","serverBidRequest","index","s2sAjax","adaptersServerSide","s2sAdapter","uniqueServerRequests","doneCbs","start","timedOut","BID_REQUESTED","runWithBidder","adapterDone","callbackWithBidder","getSupportedMediaTypes","supportedMediaTypes","videoAdapters","registerBidAdapter","bidAdapter","getSpec","gvlid","aliasBidAdapter","existingAlias","nonS2SAlias","s2sBidders","newAdapter","useBaseGvlid","skipPbsAliasing","visited","registerAnalyticsAdapter","enableAnalytics","adapterConfig","provider","getBidAdapter","getAnalyticsAdapter","getBidderMethod","method","invokeBidderMethod","tryCallBidderMethod","param","target","callTimedOutBidders","timedOutBidders","timedOutBidder","callBidWonBidder","triggerBilling","BILLED","callSetTargetingBidder","callBidViewableBidder","callBidderError","seen","callDataDeletionRequest","getBidsRequested","br","userSync","nativeBidIsValid","isValidVideoBid","REJECTION_REASON","memoize","parseQueryStringParameters","parseSizesInput","pick","bidderSettings","COMMON_BID_RESPONSE_KEYS","TIDS","registerBidder","putBidder","aliases","aliasCode","guardTids","prop","receiver","Reflect","privateAccessProxy","proxy","Proxy","_","arg","registerSyncs","configEnabledCallback","tidGuard","adUnitCodesHandled","addBidWithCode","measureTime","isValid","INVALID","responses","afterAllResponses","BIDDER_DONE","gdprConsent","uspConsent","gppConsent","validBidRequests","adapterMetrics","filterAndWarn","bidRequestMap","placementCode","processBidderRequests","onRequest","requestObject","BEFORE_BIDDER_HTTP","resp","paapiConfig","errorMessage","BIDDER_ERROR","isInvalidAlternateBidder","BIDDER_DISALLOWED","originalCurrency","onBidBillable","prebidBid","INVALID_REQUEST_ID","responseBidder","allowAlternateBidderCodes","alternateBiddersList","trim","toLowerCase","registerSyncInner","isBidRequestValid","RESPONSE_PROPS","startTiming","stopBefore","requests","buildRequests","requestDone","requestMetrics","renameWith","responseObj","networkDone","headers","headerParser","interpretResponse","paapiConfigs","xmlHttpResponse","getResponseHeader","onFailure","getOptions","ro","browsingTopics","formatGetParameters","withCredentials","contentType","aliasSyncEnabled","getUserSyncs","syncs","iframeEnabled","canBidderRegisterSync","pixelEnabled","sync","registerSync","bidderDone","validBidSize","parseInt","getBidRequest","getMediaTypes","parsedSizes","hasValidKeys","bidKeys","n","setScriptAttributes","_requestCache","_approvedLoadExternalJSList","attributes","storedCachedObject","getCacheObject","tag","cachedDocObj","cacheObject","requestResource","tagSrc","jptScript","async","readyState","onreadystatechange","onload","buildUrl","parseUrl","fetch","makeRequest","r","o","Request","resource","ctl","AbortController","cancelTimer","abort","signal","GET","POST","CTYPE","toFetchRequest","urlInfo","search","Headers","customHeaders","rqOpts","credentials","isSecureContext","opt","keepalive","fetcherFactory","fetcher","to","pm","origin","URL","location","toXHR","responseText","statusText","xml","getXML","DOMParser","parseFromString","XMLHttpRequest","DONE","responseType","responseURL","responseXML","header","toJSON","attachCallbacks","fetchPm","x","xhr","ok","sendBeacon","navigator","isEmpty","isEmptyStr","isFn","getPriceBucketString","getNativeTargeting","isNativeResponse","setNativeResponseProperties","batchAndStore","storeLocally","OUTSTREAM","GRANULARITY_OPTIONS","JSON_MAPPING","TARGETING_KEYS","defer","adjustCpm","ttlCollection","getMinBidCacheTTL","onMinBidCacheTTLChange","syncUsers","AUCTION_STARTED","AUCTION_IN_PROGRESS","AUCTION_COMPLETED","BID_ADJUSTMENT","adjustBids","MAX_REQUESTS_PER_ORIGIN","outstandingRequests","sourceInfo","queuedCalls","resetAuctionState","newAuction","adUnitCodes","_adUnits","_labels","_adUnitCodes","_auctionId","_timeout","_timelyRequests","requestsDone","_bidsRejected","_callback","_bidderRequests","_bidsReceived","startTime","responseTimestamp","max","_noBids","_winningBids","_auctionStart","_auctionEnd","_timeoutTimer","_auctionStatus","_nonBids","refresh","addBidRequests","addBidReceived","addBidRejected","bidsRejected","addNoBid","noBid","addNonBids","seatnonbids","getProperties","auctionEnd","auctionStatus","noBids","bidsReceived","toArray","winningBids","seatNonBids","startAuctionTimer","executeCallback","AUCTION_TIMEOUT","timedOutRequests","rq","BID_TIMEOUT","Date","now","AUCTION_END","bidsBackCallback","groupByPlacement","userSyncConfig","enableOverride","syncDelay","auctionDone","resetBidder","addBidderRequests","dispatch","addBidderRequestsCallback","context","AUCTION_INIT","auctionCallbacks","increment","SRA","runIfOriginHasCapacity","hasCapacity","maxRequests","min","winningBid","setBidTargeting","SEAT_NON_BID","seatnonbid","getWinningBids","getAuctionStart","getAuctionEnd","getTimeout","getAuctionId","getAuctionStatus","getAdUnits","getAdUnitCodes","getBidRequests","getBidsReceived","getNoBids","getNonBids","getFPD","getMetrics","end","promise","isValidPrice","PRICE_TOO_HIGH","responsesReady","ready","auctionInstance","outstandingBidsAdded","allAdapterCalledDone","bidderRequestsDone","bidResponseMap","afterBidAdded","handleBidResponse","addCommonResponseProperties","acceptBidResponse","getPreparedBidForAuction","BID_ACCEPTED","tryAddVideoBid","getAdUnit","addBidToAuction","rejectBidResponse","rejectionReason","BID_REJECTED","auctionOptionsConfig","secondaryBidders","NO_BID","rejected","setupBidTargeting","timeSince","BID_RESPONSE","videoMediaType","originalRequestId","useCacheKey","useLocal","cacheUrl","ignoreBidderCacheKey","videoCacheKey","callPrebidCache","getBidderRequest","requestTimestamp","parseFloat","ttlBuffer","timeToRespond","bidRenderer","bidObjectMediaType","bidMediaType","mediaTypeGranularity","getMediaTypeGranularity","priceStringsObj","pbLg","low","pbMg","med","pbHg","high","pbAg","auto","pbDg","dense","pbCg","custom","bidObject","keyValues","cpmCheck","dealId","getKeyValueTargetingPairs","adserverTargeting","mediaTypePriceGranularity","getPriceGranularity","granularity","getPriceByGranularity","bidGranularity","AUTO","DENSE","LOW","MEDIUM","HIGH","CUSTOM","getCreativeId","getAdvertiserDomain","advertiserDomains","flat","getDSP","networkId","networkName","getPrimaryCatId","primaryCatId","createKeyVal","bidReq","defaultAdserverTargeting","BIDDER","AD_ID","PRICE_BUCKET","SIZE","DEAL","SOURCE","FORMAT","ADOMAIN","ACAT","DSP","CRID","getStandardBidderSettings","standardSettings","settingsFor","ADSERVER_TARGETING","slice","UUID","CACHE_ID","targetingKeyVal","kvPair","CACHE_HOST","hostname","custBidObj","setKeys","getOwn","ownSettingsFor","sendStandardTargeting","targeting","getSize","suppressEmptyKeys","bidPriceAdjusted","bidsByPlacement","maxBidValue","AuctionIndex","getAuctions","getAuction","auction","a","bers","ber","getOrtb2","newAuctionManager","_auctions","onExpiry","getAllWinningBids","pre","post","mgrMethod","mapper","items","allBidsReceived","getAllBidsForAdUnitCode","createAuction","_addAuction","getStandardBidderAdServerTargeting","setStatusForBids","BID_TARGETING_SET","getLastAuctionId","auctions","clearAllAuctions","clear","CACHE_TTL_SETTING","TTL_BUFFER","minCacheTTL","listeners","getBufferedTTL","prev","l","listener","ScopedSettings","getSettings","defaultScope","scope","resolveScope","getScopes","#resolveScope","BD_SETTING_STANDARD","Bid","statusCode","_bidSrc","_statusCode","statusMessage","_getStatus","getStatusCode","getIdentifiers","identifiers","isValidPriceConfig","arrayFrom","from","getParameterByName","isBoolean","isStr","DEBUG_MODE","DEFAULT_DEBUG","toUpperCase","DEFAULT_BIDDER_TIMEOUT","DEFAULT_ENABLE_SEND_ALL_BIDS","DEFAULT_DISABLE_AJAX_TIMEOUT","DEFAULT_BID_CACHE","DEFAULT_DEVICE_ACCESS","DEFAULT_MAX_NESTED_IFRAMES","DEFAULT_MAXBID_VALUE","DEFAULT_IFRAMES_CONFIG","FIXED","VALID_ORDERS","DEFAULT_BIDDER_SEQUENCE","ALL_TOPICS","attachProperties","useDefaultValues","priceGranularity","customPriceBucket","bidderSequence","auctionOptions","getProp","setProp","defineProperty","enumerable","props","publisherDomain","validatePriceGranularity","hasGranularity","aggregate","item","validateauctionOptions","defineProperties","fromEntries","def","configurable","option","newConfig","bidderConfig","currBidder","resetConfig","bidderTimeout","enableSendAllBids","useBidCache","deviceAccess","disableAjaxTimeout","maxNestedIframes","maxBid","topics","callSubscribers","topic","_getConfig","currBidderConfig","configTopicSet","_getRestrictedConfig","conf","getAnyConfig","accessor","subscribe","readConfig","readAnyConfig","wrapee","getBidderConfig","topicalConfig","setDefaults","nl","unsubscribe","TOPICS","setBidderConfig","mergeFlag","check","currentConfig","mergeConfig","mergedConfig","mergeBidderConfig","cb","getCurrentBidder","cyrb53Hash","VENDORLESS_GVLID","ConsentHandler","dirty","hash","generatedTime","hashFields","#resolve","setConsentData","time","UspConsentHandler","getConsentMeta","consentData","generatedAt","GdprConsentHandler","vendorData","gdprApplies","consentStringSize","tcString","apiVersion","GppConsentHandler","gvlidRegistry","none","modules","getCoppa","ALL_HANDLERS","gdpr","usp","gpp","coppa","multiHandler","allConsent","PL_CODE","PL_SIZE","PL_BIDS","BD_BIDDER","BD_ID","BD_PL_ID","SET_TARGETING","REQUEST_BIDS","ADD_AD_UNITS","TCF2_ENFORCEMENT","AUCTION_DEBUG","BID_VIEWABLE","BILLABLE_EVENT","RUN_PAAPI_AUCTION","PBS_ANALYTICS","PAAPI_BID","PAAPI_NO_BID","PAAPI_ERROR","BEFORE_PBS_HTTP","BROWSI_INIT","BROWSI_DATA","NO_AD","EVENT_ID_PATHS","bidWon","DEFAULT_TARGETING_KEYS","NATIVE_KEYS","body2","privacyLink","privacyIcon","sponsoredBy","image","icon","displayUrl","cta","rating","address","downloads","likes","phone","price","salePrice","rendererUrl","adTemplate","DEFAULT_ENDPOINT","SYNCED_BIDDERS_KEY","FLOOR_NOT_MET","CANNOT_CONVERT_CURRENCY","DSA_REQUIRED","DSA_MISMATCH","PREBID_NATIVE_DATA_KEYS_TO_ORTB","NATIVE_ASSET_TYPES","sponsored","desc","saleprice","desc2","displayurl","ctatext","NATIVE_IMAGE_TYPES","ICON","MAIN","NATIVE_KEYS_THAT_ARE_NOT_ASSETS","REQUEST","RESPONSE","_defaultPrecision","_lgPriceConfig","_mgPriceConfig","_hgPriceConfig","_densePriceConfig","_autoPriceConfig","customConfig","granularityMultiplier","cpmFloat","isNaN","getCpmStringValue","cpmStr","cap","buckets","curr","bucketFloor","bucket","precision","toFixed","getCpmTarget","bucketMin","roundingFunction","floor","customRoundingFunction","pow","cpmToRound","cpmTarget","invalidRounding","PUC_MIN_VERSION","getCreativeRendererSource","renderers","iframe","srcdoc","contentWindow","TRACKER_METHOD_JS","eventTrackers","tally","trackersForType","trackersForMethod","utils","TTL_CONFIG","eventTTL","eventsFired","monotonic","previous","allEvents","idPaths","_public","_handlers","_dispatch","eventString","eventPayload","idPath","que","eventKeys","eventType","elapsedTime","getPerformanceNow","_checkAvailableEvent","off","_handler","addEvents","getEvents","_setEventEmitter","clearEvents","clientSectionChecker","logPrefix","onlyOneClientSection","found","hasSection","funHooks","SYNC","ASYNC","QUEUE","readyCtl","getHook","setupBeforeHookFnOnce","baseFn","hookFn","submoduleInstallMap","postInstallAllowed","submodules","submodule","wrapHook","wrapper","m","ADPOD","ALL_MEDIATYPES","insertHtmlIntoIframe","isInteger","isNumber","NATIVE_TARGETING_KEYS","IMAGE","ver","required","wmin","hmin","len","SUPPORTED_TYPES","PREBID_NATIVE_DATA_KEYS_TO_ORTB_INVERSE","inverse","NATIVE_ASSET_TYPES_INVERSE","processNativeAdUnitParams","typeIsSupported","isOpenRTBBidRequestValid","nativeParams","toOrtbNativeRequest","ids","isOpenRTBAssetValid","mimes","protocols","minduration","maxduration","nativeAdUnit","nativeBidder","hasNonNativeBidder","ortbRequest","ortbResponse","toOrtbNativeResponse","isNativeOpenRTBBidValid","bidORTB","bidRequestORTB","requiredAssetIds","returnedAssetIds","assetId","nativeResponse","legacyPropertiesToOrtbNative","fireClickTrackers","fireImpressionTrackers","runMarkup","mkup","fetchURL","js","imptrackers","jstracker","assetIdLinkMap","masterClickTrackers","assetLink","clickTrackers","nativeOrtbResponse","legacyResponse","toLegacyResponse","getAssetValue","globalSendTargetingKeys","sendTargetingKeys","nativeKeys","getNativeKeys","flatBidNativeKeys","sendPlaceholder","sendId","placeholder","assetSendTargetingKeys","sendTargeting","getNativeAssets","nativeProps","getNativeRenderingData","assetsMessage","adObject","renderData","rendererVersion","NATIVE_KEYS_INVERTED","getAssetMessage","getAllAssetsMessage","extraNativeKeys","extKey","legacyNativeAssets","privacy","ortbAsset","aspect_ratios","min_width","minWidth","min_height","minHeight","aspectRatios","ar","ratio_width","ratio_height","ratio","aspectratios","gcd","fromOrtbNativeRequest","openRTBRequest","oldNativeObject","Boolean","scale","prebidAssetName","convertOrtbRequestToProprietaryNative","bidRequestsCopy","legacyNative","useRequestAsset","predicate","titleAsset","imageType","imageAsset","dataAsset","requestAssets","requestAsset","reqAsset","impressionTrackers","jsTrackers","eventTracker","javascriptTrackers","retobj","elem","arr","pred","thisArg","true","pbjs","_pbjsGlobals","registerModule","installedModules","ensureProtocol","win","windowProto","protocol","top","parseDomain","noLeadingWww","noPort","host","startsWith","substring","getCanonicalUrl","element","querySelector","href","detectReferer","getAncestorOrigins","ancestorOrigins","ancestors","currentWindow","bestLocation","bestCanonicalUrl","reachedTop","level","valuesFromAmp","inAmpFrame","hasTopLocation","previousWindow","wasInAmpFrame","currentLocation","crossOrigin","foundLocation","sourceUrl","canonicalUrl","referrer","reverse","page","isAmp","numIframes","topmostLocation","domain","legacy","referer","cacheWithLocation","canonical","newCanonical","newHref","checkCookieSupport","hasDeviceAccess","STORAGE_TYPE_LOCALSTORAGE","STORAGE_TYPE_COOKIES","storageCallbacks","newStorageManager","storageType","mod","curBidder","valid","schedule","operation","setCookie","expires","sameSite","domainPortion","encodeURIComponent","expiresPortion","isNone","secure","cookie","getCookie","decodeURIComponent","cookiesAreEnabled","storageMethods","capName","charAt","backend","hasStorage","findSimilarCookies","keyLike","cookies","separatorIndex","cookieName","getStorageManager","getCoreStorageManager","deviceAccessRule","storageAllowedRule","bs","resetData","isAdUnitCodeMatchingSlot","sortByHighestCpm","getHighestCpm","getOldestHighestCpmBid","pbTargetingKeys","MAX_DFP_KEYLENGTH","CFG_ALLOW_TARGETING_KEYS","CFG_ADD_TARGETING_KEYS","TARGETING_KEY_CONFIGURATION_ERROR_MSG","TARGETING_KEYS_ARR","isUnusedBid","isActualBid","isBidUsable","getHighestCpmBidsFromBidPool","winReducer","adUnitBidLimit","hasModified","winSorter","dealPrioritization","bucketKey","bucketBids","bidsByBidder","sort","sortByDealAndPriceBucketOrCpm","useCpm","hb_deal","hb_pb","getGPTSlotsForAdUnits","customSlotMatching","auToSlots","customMatch","clearTargeting","getTargeting","newTargeting","latestAuctionForAdUnit","setLatestAuctionForAdUnit","resetPresetTargeting","slots","resetPresetTargetingAST","astTag","apntag","getTag","keywords","currentKeywords","newKeywords","modifyTag","addBidToTargeting","deals","standardKeys","allowSendAllBidsTargetingKeys","allowedSendAllBidTargeting","targetingValue","getTargetingMap","getBidderTargeting","alwaysIncludeDeals","getAllowedTargetingKeyValues","allowedKeys","defaultKeyring","defaultKeys","keyDispositions","keyring","isCustom","defaultKey","allowedKey","allowedKeyName","removedKeys","d","filteredTargeting","getAllTargeting","bidLimit","sendAllBids","bidLimitConfigValue","customKeysByUnit","filteredBids","getfilteredBidsAndCustomKeys","bidsSorted","getTargetingLevels","addedKeys","flattenTargeting","auctionKeysThreshold","filterTargetingKeys","updatePBTargetingKeys","targetKey","targetKeys","useAllBidsCustomTargeting","getWinningBidTargeting","getAdUnitTargeting","getCustomBidTargeting","adUnitIsEligible","cpmAllowed","isPreferredDeal","getCustomKeys","truncKey","convertKeysToQueryForm","keyMap","queryString","encodedKeyPair","targetingCopy","targetingMap","accMap","currMap","adUnitQueryString","querySize","targetingObj","c","accumulator","setTargetingForGPT","targetingSet","resetMap","targetId","updateTargetingFromMap","targetingKey","targetingDone","bidCacheEnabled","filterFunction","isBidFromLastAuction","filterFunctionResult","cacheFilter","bidFilter","latestTargetedAuctionId","setTargetingForAst","astTargeting","keywordsObj","regex","setKeywords","overrideKeyValue","winners","getStandardKeys","winner","acc","bidderCodeTargetingKey","bidderCodeTargeting","newBid","customKeysForUnit","getTargetingObj","getTargetingValues","aut","s","targetingValues","isApntagDefined","insertUserSyncIframe","isSafariBrowser","USERSYNC_DEFAULT_CONFIG","syncEnabled","filterSettings","syncsPerBidder","auctionDelay","newUserSync","publicApi","queue","getDefaultQueue","hasFiredBidder","numAdapterBids","permittedPixels","usConfig","fs","regRule","syncType","fireSyncs","browserSupportsCookies","loadIframes","fireImagePixels","forEachFire","bidderName","trackingPixelUrl","iframeUrl","removeImagePixelsForBidder","iframeSyncBidderName","imageSync","imageSyncBidderName","incrementAdapterBids","shouldBidderBeBlocked","filterConfig","isFilterConfigValid","activeConfig","biddersToFilter","filterType","checkForFiltering","include","exclude","activeConfigName","filterField","biddersField","bidderInList","triggerUserSyncs","klona","default","dset","deepSetValue","tStr","tFn","tNumb","tObject","tBoolean","toString","consoleExists","console","consoleLogExists","log","consoleInfoExists","consoleWarnExists","warn","consoleErrorExists","eventEmitter","windowDimensions","emitFn","emitEvent","getWinDimensions","lastCheckTimestamp","CHECK_INTERVAL_MS","resetWinDimensions","canAccessWindowTop","getWindowTop","getWindowSelf","screen","availWidth","availHeight","colorDepth","innerHeight","innerWidth","outerWidth","outerHeight","visualViewport","documentElement","clientWidth","clientHeight","scrollTop","scrollLeft","createTrackPixelIframeHtml","getWindowLocation","parseQS","formatQS","deepEqual","prebidInternal","getPrebidInternal","getIncrementalInteger","count","random","substr","_getRandomData","crypto","getRandomValues","Uint8Array","getBidIdParameter","paramsObj","queryObj","transformAdServerTargetingObj","getOwnPropertyNames","sizesToSizeTuples","sz","isValidGPTSingleSize","sizeObj","sizeTupleToSizeString","parseGPTSingleSizeArray","singleSize","sizeTupleToRtbSize","parseGPTSingleSizeArrayToRtbSize","self","getDocument","debugTurnedOn","decorateLog","prefix","decorate","label","color","hasConsoleLogger","DEFAULTS","border","hspace","vspace","marginWidth","marginHeight","scrolling","frameBorder","allowtransparency","attrs","display","isA","_t","str","_each","contains","_map","elm","asLastChildChild","parentEl","getElementsByTagName","insertBeforeEl","firstChild","insertBefore","waitForElementToLoad","timer","onLoad","removeEventListener","Image","htmlCode","open","iframeHtml","innerHTML","createTrackPixelHtml","encode","encodeURI","escapedUrl","encodeMacroURI","macros","macro","encodeUri","sandbox","arry","getValue","isApnGetTagDefined","array","temp","isSafeFrameWindow","ws","$sf","getSafeframeGeometry","geom","test","userAgent","subs","replaceAuctionPrice","replaceClickThrough","clicktag","getTime","performance","getDomLoadingDuration","domLoadingDuration","timing","navigationStart","domLoading","cookieEnabled","numRequiredCalls","numCalls","xs","rv","SUPPORTED_MEDIA_TYPES","SUPPORTED_STREAM_TYPES","types","bidderData","getDNT","doNotTrack","msDoNotTrack","unsupportedBidderMessage","cleanObj","properties","newObj","newProp","isArrayOfNums","query","criteria","parsed","noDecodeWholeURL","qsAsString","decodeSearchAsString","port","pathname","obj1","obj2","checkTypes","isArr1","isArr2","keys1","keys2","mergeDeepHelper","seed","imul","opA","opB","h1","h2","ch","charCodeAt","safeJSONParse","safeJSONEncode","cache","Map","memoized","cacheKey","getUnixTimestampFromNow","timeValue","timeUnit","acceptableUnits","multiplication","convertObjectToArray","script","setAttribute","binarySearch","left","right","middle","checkedObjects","setOnAny","collection","extractDomainFromHost","pageHost","domains","triggerNurlWithCpm","nurl","adjustAlternateBids","bidCpmAdjustment","outOfFocusStart","timeOutOfFocus","suspendedTimeouts","trackTimeOutOfFocus","hidden","setTimerId","setFocusTimeout","milliseconds","timerId","newId","ip","ones","ipParts","mask","maskedIP","part","CONFIG_TOGGLE","NODES","metricsFactory","mkNode","makeNode","mkTimer","makeTimer","mkRenamer","rename","nodes","newMetrics","makeMetrics","dfWalk","visit","edge","node","getTimestamp","setMetric","names","follow","inEdge","outEdge","propagate","stopPropagation","groups","timestamps","metric","ts","elapsed","startCheckpoint","endCheckpoint","stopAfter","measureHookTime","stopTiming","orig","untimed","includeGroups","otherMetrics","other","addParent","renameFn","newSibling","wrapFn","after","parents","nullMetrics","nop","empty","nullTimer","nullNode","hookTimer","that","timedAuctionHook","timedBidResponseHook","pbSetTimeout","Promise","promiseFactory","invoker","delegate","rejectFn","simpleCompare","keyCompare","reverseCompare","compare","tiebreakCompare","compares","cmp","minimum","maximum","cpmCompare","timestampCompare","getLatestHighestCpmBid","slack","pendingPurge","markForPurge","expiry","nextPurge","task","reschedulePurge","mkEntry","thisCohort","currentCohort","update","delta","field","getter","currentCall","thisCall","Symbol","iterator","INSTREAM","ORTB_VIDEO_PARAMS","fillVideoDefaults","plcmt","placement","playbackmethod","validateOrtbVideoFields","onInvalidParam","videoParams","checkVideoBidSetup","ttlBufferInSeconds","vastLocalCache","wrapURI","uri","impTrackerURLs","impressions","trk","toStorageRequest","vastValue","getVastXml","ttlWithBuffer","payload","ttlseconds","bidid","aid","customCacheKey","shimStorageCallback","responseBody","vastImpUrl","store","getAjax","requestData","puts","getCacheUrl","bidVastUrl","createObjectURL","Blob","assignVastUrlAndCacheId","_internal","storeBatch","batch","cacheIds","cacheId","uuid","batchSize","batchTimeout","cleanupHandler","revokeObjectURL","batchingCache","batches","debouncing","noTimeout","batchFunc","_installDebugging"],"sourceRoot":""}